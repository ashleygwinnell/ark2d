<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ARK2D: src/ARK2D/vendor/android/freetype/jni/src/cff/cffgload.c Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ARK2D
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('cffgload_8c.html','');
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">src/ARK2D/vendor/android/freetype/jni/src/cff/cffgload.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="cffgload_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/***************************************************************************/</span>
<a name="l00002"></a>00002 <span class="comment">/*                                                                         */</span>
<a name="l00003"></a>00003 <span class="comment">/*  cffgload.c                                                             */</span>
<a name="l00004"></a>00004 <span class="comment">/*                                                                         */</span>
<a name="l00005"></a>00005 <span class="comment">/*    OpenType Glyph Loader (body).                                        */</span>
<a name="l00006"></a>00006 <span class="comment">/*                                                                         */</span>
<a name="l00007"></a>00007 <span class="comment">/*  Copyright 1996-2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009,   */</span>
<a name="l00008"></a>00008 <span class="comment">/*            2010 by                                                      */</span>
<a name="l00009"></a>00009 <span class="comment">/*  David Turner, Robert Wilhelm, and Werner Lemberg.                      */</span>
<a name="l00010"></a>00010 <span class="comment">/*                                                                         */</span>
<a name="l00011"></a>00011 <span class="comment">/*  This file is part of the FreeType project, and may only be used,       */</span>
<a name="l00012"></a>00012 <span class="comment">/*  modified, and distributed under the terms of the FreeType project      */</span>
<a name="l00013"></a>00013 <span class="comment">/*  license, LICENSE.TXT.  By continuing to use, modify, or distribute     */</span>
<a name="l00014"></a>00014 <span class="comment">/*  this file you indicate that you have read the license and              */</span>
<a name="l00015"></a>00015 <span class="comment">/*  understand and accept it fully.                                        */</span>
<a name="l00016"></a>00016 <span class="comment">/*                                                                         */</span>
<a name="l00017"></a>00017 <span class="comment">/***************************************************************************/</span>
<a name="l00018"></a>00018 
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;<a class="code" href="ft2build_8h.html">ft2build.h</a>&gt;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include FT_INTERNAL_DEBUG_H</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span><span class="preprocessor">#include FT_INTERNAL_STREAM_H</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span><span class="preprocessor">#include FT_INTERNAL_SFNT_H</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span><span class="preprocessor">#include FT_OUTLINE_H</span>
<a name="l00025"></a>00025 <span class="preprocessor"></span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;<a class="code" href="cffobjs_8h.html">cffobjs.h</a>&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;<a class="code" href="cffload_8h.html">cffload.h</a>&quot;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;<a class="code" href="cffgload_8h.html">cffgload.h</a>&quot;</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="cfferrs_8h.html">cfferrs.h</a>&quot;</span>
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 
<a name="l00033"></a>00033   <span class="comment">/*************************************************************************/</span>
<a name="l00034"></a>00034   <span class="comment">/*                                                                       */</span>
<a name="l00035"></a>00035   <span class="comment">/* The macro FT_COMPONENT is used in trace mode.  It is an implicit      */</span>
<a name="l00036"></a>00036   <span class="comment">/* parameter of the FT_TRACE() and FT_ERROR() macros, used to print/log  */</span>
<a name="l00037"></a>00037   <span class="comment">/* messages during execution.                                            */</span>
<a name="l00038"></a>00038   <span class="comment">/*                                                                       */</span>
<a name="l00039"></a>00039 <span class="preprocessor">#undef  FT_COMPONENT</span>
<a name="l00040"></a><a class="code" href="cffgload_8c.html#a9c208ea57bc9a5fcbfc81a6106d28f3a">00040</a> <span class="preprocessor"></span><span class="preprocessor">#define FT_COMPONENT  trace_cffgload</span>
<a name="l00041"></a>00041 <span class="preprocessor"></span>
<a name="l00042"></a>00042 
<a name="l00043"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8">00043</a>   <span class="keyword">typedef</span> <span class="keyword">enum</span>  <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8">CFF_Operator_</a>
<a name="l00044"></a>00044   {
<a name="l00045"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8af32c40b75ea268aaae1c240542eb738c">00045</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8af32c40b75ea268aaae1c240542eb738c">cff_op_unknown</a> = 0,
<a name="l00046"></a>00046 
<a name="l00047"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8af371af458c3decd4e1bf20dd6039ca2a">00047</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8af371af458c3decd4e1bf20dd6039ca2a">cff_op_rmoveto</a>,
<a name="l00048"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a01d4fc07f5d25d67b85546307aa4ff91">00048</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a01d4fc07f5d25d67b85546307aa4ff91">cff_op_hmoveto</a>,
<a name="l00049"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a713506a98409ebfdf759152baff23722">00049</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a713506a98409ebfdf759152baff23722">cff_op_vmoveto</a>,
<a name="l00050"></a>00050 
<a name="l00051"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ab1193e6aec53b22a0189defd98d99c37">00051</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ab1193e6aec53b22a0189defd98d99c37">cff_op_rlineto</a>,
<a name="l00052"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ac6ccfab49de5ae2b4d9c41d7c33d2bb0">00052</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ac6ccfab49de5ae2b4d9c41d7c33d2bb0">cff_op_hlineto</a>,
<a name="l00053"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a290b968a40248b5cb4070b89ccb85005">00053</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a290b968a40248b5cb4070b89ccb85005">cff_op_vlineto</a>,
<a name="l00054"></a>00054 
<a name="l00055"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8add4fe42409b24680e84c6f0b541448aa">00055</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8add4fe42409b24680e84c6f0b541448aa">cff_op_rrcurveto</a>,
<a name="l00056"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a2c6f4e1ef6fe5919bc6b5f72673ddef7">00056</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a2c6f4e1ef6fe5919bc6b5f72673ddef7">cff_op_hhcurveto</a>,
<a name="l00057"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ad84d1e27d388ead6edfcf1347f7f04f5">00057</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ad84d1e27d388ead6edfcf1347f7f04f5">cff_op_hvcurveto</a>,
<a name="l00058"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a8d08fbf34700b975d4f791d2ab0347af">00058</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a8d08fbf34700b975d4f791d2ab0347af">cff_op_rcurveline</a>,
<a name="l00059"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a24c60e306d86c0b7c62b76f2c7d6d1d2">00059</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a24c60e306d86c0b7c62b76f2c7d6d1d2">cff_op_rlinecurve</a>,
<a name="l00060"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ae42179f56a27deef7c102db53fef00d3">00060</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ae42179f56a27deef7c102db53fef00d3">cff_op_vhcurveto</a>,
<a name="l00061"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ae4c9ad7156108a8ec957167a3c9601b1">00061</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ae4c9ad7156108a8ec957167a3c9601b1">cff_op_vvcurveto</a>,
<a name="l00062"></a>00062 
<a name="l00063"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1de43caa6ef27d55061e0dffe752e9b6">00063</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1de43caa6ef27d55061e0dffe752e9b6">cff_op_flex</a>,
<a name="l00064"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a258fdb0f1769f994880a168ea516123f">00064</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a258fdb0f1769f994880a168ea516123f">cff_op_hflex</a>,
<a name="l00065"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ac98a098a167c1f8de65f0599aeb46813">00065</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ac98a098a167c1f8de65f0599aeb46813">cff_op_hflex1</a>,
<a name="l00066"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8aa23494894eec5922ad45ffcdb1eb4e52">00066</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8aa23494894eec5922ad45ffcdb1eb4e52">cff_op_flex1</a>,
<a name="l00067"></a>00067 
<a name="l00068"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a02654a503c7056ffe73f7e89f870e409">00068</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a02654a503c7056ffe73f7e89f870e409">cff_op_endchar</a>,
<a name="l00069"></a>00069 
<a name="l00070"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a28d40d72404136482286c1660a5ade06">00070</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a28d40d72404136482286c1660a5ade06">cff_op_hstem</a>,
<a name="l00071"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1f0969967e245931fec7d6f369cb0e6d">00071</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1f0969967e245931fec7d6f369cb0e6d">cff_op_vstem</a>,
<a name="l00072"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a0246b57f0ee935c12d6dfd5faacc1dec">00072</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a0246b57f0ee935c12d6dfd5faacc1dec">cff_op_hstemhm</a>,
<a name="l00073"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a58236915cbd4069c5d81971690487d10">00073</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a58236915cbd4069c5d81971690487d10">cff_op_vstemhm</a>,
<a name="l00074"></a>00074 
<a name="l00075"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8afeee820728e5a9e914db82085fc7f390">00075</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8afeee820728e5a9e914db82085fc7f390">cff_op_hintmask</a>,
<a name="l00076"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a4a91ebecfe9b7fa4b216af356c1a4fb3">00076</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a4a91ebecfe9b7fa4b216af356c1a4fb3">cff_op_cntrmask</a>,
<a name="l00077"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a8cfe096ad9274b8435468f9eb4a5f5e1">00077</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a8cfe096ad9274b8435468f9eb4a5f5e1">cff_op_dotsection</a>,  <span class="comment">/* deprecated, acts as no-op */</span>
<a name="l00078"></a>00078 
<a name="l00079"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a9ff7938b9c372953d0823bf22338871b">00079</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a9ff7938b9c372953d0823bf22338871b">cff_op_abs</a>,
<a name="l00080"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8aea908e6d598e2d84a5d346241f85ea4a">00080</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8aea908e6d598e2d84a5d346241f85ea4a">cff_op_add</a>,
<a name="l00081"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a0d3347ca88c65693e926c70458ba4f6a">00081</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a0d3347ca88c65693e926c70458ba4f6a">cff_op_sub</a>,
<a name="l00082"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8acfd26a81d025112fb953a199aaefbc9b">00082</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8acfd26a81d025112fb953a199aaefbc9b">cff_op_div</a>,
<a name="l00083"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a8b889aa9c9278033059c11c101d71790">00083</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a8b889aa9c9278033059c11c101d71790">cff_op_neg</a>,
<a name="l00084"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ab9fe134cd34c62675ad21aa27165871f">00084</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ab9fe134cd34c62675ad21aa27165871f">cff_op_random</a>,
<a name="l00085"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8afadcf7b43479a14dfdd417327d392fe2">00085</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8afadcf7b43479a14dfdd417327d392fe2">cff_op_mul</a>,
<a name="l00086"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ae59f88acc3553d5190e69a9576c47efd">00086</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ae59f88acc3553d5190e69a9576c47efd">cff_op_sqrt</a>,
<a name="l00087"></a>00087 
<a name="l00088"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a2592dd93e88c38cc0bf897b37ec02488">00088</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a2592dd93e88c38cc0bf897b37ec02488">cff_op_blend</a>,
<a name="l00089"></a>00089 
<a name="l00090"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a6f5422326afe716744562b30721c254f">00090</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a6f5422326afe716744562b30721c254f">cff_op_drop</a>,
<a name="l00091"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1cab1f5bf47858793709680d3cac44e7">00091</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1cab1f5bf47858793709680d3cac44e7">cff_op_exch</a>,
<a name="l00092"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a01ebd6f23e1cba4d32c1449731f797d8">00092</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a01ebd6f23e1cba4d32c1449731f797d8">cff_op_index</a>,
<a name="l00093"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8adfefa3ebc44df5105f18d96c026709f0">00093</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8adfefa3ebc44df5105f18d96c026709f0">cff_op_roll</a>,
<a name="l00094"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a434827ffa8cca1ace703ec938cdcf6d6">00094</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a434827ffa8cca1ace703ec938cdcf6d6">cff_op_dup</a>,
<a name="l00095"></a>00095 
<a name="l00096"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8aa7bced71bc9799b0bbabe7bc9d2f1159">00096</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8aa7bced71bc9799b0bbabe7bc9d2f1159">cff_op_put</a>,
<a name="l00097"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a19906f49eeaaed1c61733f87c0d87d5b">00097</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a19906f49eeaaed1c61733f87c0d87d5b">cff_op_get</a>,
<a name="l00098"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1e70d07a4d1fd319ed5241e05a0d1172">00098</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1e70d07a4d1fd319ed5241e05a0d1172">cff_op_store</a>,
<a name="l00099"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a7630954efe67155c39447c63dc776bc9">00099</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a7630954efe67155c39447c63dc776bc9">cff_op_load</a>,
<a name="l00100"></a>00100 
<a name="l00101"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a198c30b3f96e38397a4f96e35287dfca">00101</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a198c30b3f96e38397a4f96e35287dfca">cff_op_and</a>,
<a name="l00102"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ab5e02727b9ceab6a991509dde7a68c51">00102</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ab5e02727b9ceab6a991509dde7a68c51">cff_op_or</a>,
<a name="l00103"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8aa15f4155a179b07b63371a698fdfb71f">00103</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8aa15f4155a179b07b63371a698fdfb71f">cff_op_not</a>,
<a name="l00104"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1f4894f49b12e28c9ee89542194ce287">00104</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1f4894f49b12e28c9ee89542194ce287">cff_op_eq</a>,
<a name="l00105"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a3dd3b124503056cb7f2dbf6c34e5303a">00105</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a3dd3b124503056cb7f2dbf6c34e5303a">cff_op_ifelse</a>,
<a name="l00106"></a>00106 
<a name="l00107"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a96b69ad3ec477d065eb9aea0289ca594">00107</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a96b69ad3ec477d065eb9aea0289ca594">cff_op_callsubr</a>,
<a name="l00108"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a57546c33757242ac87da1e294caca2cd">00108</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a57546c33757242ac87da1e294caca2cd">cff_op_callgsubr</a>,
<a name="l00109"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8aef3f2f049d5593f2fd6db5c34a3d3937">00109</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8aef3f2f049d5593f2fd6db5c34a3d3937">cff_op_return</a>,
<a name="l00110"></a>00110 
<a name="l00111"></a>00111     <span class="comment">/* Type 1 opcodes: invalid but seen in real life */</span>
<a name="l00112"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8add265fbc35078d4e9b2fb4ff63561c0f">00112</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8add265fbc35078d4e9b2fb4ff63561c0f">cff_op_hsbw</a>,
<a name="l00113"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ae5d8351117021456094b6adec66e9730">00113</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ae5d8351117021456094b6adec66e9730">cff_op_closepath</a>,
<a name="l00114"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a60ddfb0898b726aae8da343b41ec0e74">00114</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a60ddfb0898b726aae8da343b41ec0e74">cff_op_callothersubr</a>,
<a name="l00115"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a5d0b67133e29eef802f38c844539f794">00115</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a5d0b67133e29eef802f38c844539f794">cff_op_pop</a>,
<a name="l00116"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a6c030c34f2bcbece80975d4ed128de0f">00116</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a6c030c34f2bcbece80975d4ed128de0f">cff_op_seac</a>,
<a name="l00117"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a8aab759e46bfd5eb4225e1a17c203224">00117</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a8aab759e46bfd5eb4225e1a17c203224">cff_op_sbw</a>,
<a name="l00118"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a50d3d2e8ee9a7906069b92fc3c6882b0">00118</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a50d3d2e8ee9a7906069b92fc3c6882b0">cff_op_setcurrentpoint</a>,
<a name="l00119"></a>00119 
<a name="l00120"></a>00120     <span class="comment">/* do not remove */</span>
<a name="l00121"></a><a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ad9b0dde728d4434b2d71802060bcae19">00121</a>     <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ad9b0dde728d4434b2d71802060bcae19">cff_op_max</a>
<a name="l00122"></a>00122 
<a name="l00123"></a>00123   } <a class="code" href="cffgload_8c.html#aec8587f065b7ee6610fd8fc7d2acf080">CFF_Operator</a>;
<a name="l00124"></a>00124 
<a name="l00125"></a>00125 
<a name="l00126"></a><a class="code" href="cffgload_8c.html#aaea2eb2399ab43c559d5f11586afb00b">00126</a> <span class="preprocessor">#define CFF_COUNT_CHECK_WIDTH  0x80</span>
<a name="l00127"></a><a class="code" href="cffgload_8c.html#a200aa687b5bec5e8f82212d6046a7de1">00127</a> <span class="preprocessor"></span><span class="preprocessor">#define CFF_COUNT_EXACT        0x40</span>
<a name="l00128"></a><a class="code" href="cffgload_8c.html#ae4b1860a6cc535b3aedf87be8414e8ad">00128</a> <span class="preprocessor"></span><span class="preprocessor">#define CFF_COUNT_CLEAR_STACK  0x20</span>
<a name="l00129"></a>00129 <span class="preprocessor"></span>
<a name="l00130"></a>00130   <span class="comment">/* count values which have the `CFF_COUNT_CHECK_WIDTH&#39; flag set are  */</span>
<a name="l00131"></a>00131   <span class="comment">/* used for checking the width and requested numbers of arguments    */</span>
<a name="l00132"></a>00132   <span class="comment">/* only; they are set to zero afterwards                             */</span>
<a name="l00133"></a>00133 
<a name="l00134"></a>00134   <span class="comment">/* the other two flags are informative only and unused currently     */</span>
<a name="l00135"></a>00135 
<a name="l00136"></a>00136   <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="fttypes_8h.html#a51f26183ca0c9f4af958939648caeccd">FT_Byte</a>  cff_argument_counts[] =
<a name="l00137"></a>00137   {
<a name="l00138"></a>00138     0,  <span class="comment">/* unknown */</span>
<a name="l00139"></a>00139 
<a name="l00140"></a>00140     2 | <a class="code" href="cffgload_8c.html#aaea2eb2399ab43c559d5f11586afb00b">CFF_COUNT_CHECK_WIDTH</a> | <a class="code" href="cffgload_8c.html#a200aa687b5bec5e8f82212d6046a7de1">CFF_COUNT_EXACT</a>, <span class="comment">/* rmoveto */</span>
<a name="l00141"></a>00141     1 | <a class="code" href="cffgload_8c.html#aaea2eb2399ab43c559d5f11586afb00b">CFF_COUNT_CHECK_WIDTH</a> | <a class="code" href="cffgload_8c.html#a200aa687b5bec5e8f82212d6046a7de1">CFF_COUNT_EXACT</a>,
<a name="l00142"></a>00142     1 | <a class="code" href="cffgload_8c.html#aaea2eb2399ab43c559d5f11586afb00b">CFF_COUNT_CHECK_WIDTH</a> | <a class="code" href="cffgload_8c.html#a200aa687b5bec5e8f82212d6046a7de1">CFF_COUNT_EXACT</a>,
<a name="l00143"></a>00143 
<a name="l00144"></a>00144     0 | <a class="code" href="cffgload_8c.html#ae4b1860a6cc535b3aedf87be8414e8ad">CFF_COUNT_CLEAR_STACK</a>, <span class="comment">/* rlineto */</span>
<a name="l00145"></a>00145     0 | <a class="code" href="cffgload_8c.html#ae4b1860a6cc535b3aedf87be8414e8ad">CFF_COUNT_CLEAR_STACK</a>,
<a name="l00146"></a>00146     0 | <a class="code" href="cffgload_8c.html#ae4b1860a6cc535b3aedf87be8414e8ad">CFF_COUNT_CLEAR_STACK</a>,
<a name="l00147"></a>00147 
<a name="l00148"></a>00148     0 | <a class="code" href="cffgload_8c.html#ae4b1860a6cc535b3aedf87be8414e8ad">CFF_COUNT_CLEAR_STACK</a>, <span class="comment">/* rrcurveto */</span>
<a name="l00149"></a>00149     0 | <a class="code" href="cffgload_8c.html#ae4b1860a6cc535b3aedf87be8414e8ad">CFF_COUNT_CLEAR_STACK</a>,
<a name="l00150"></a>00150     0 | <a class="code" href="cffgload_8c.html#ae4b1860a6cc535b3aedf87be8414e8ad">CFF_COUNT_CLEAR_STACK</a>,
<a name="l00151"></a>00151     0 | <a class="code" href="cffgload_8c.html#ae4b1860a6cc535b3aedf87be8414e8ad">CFF_COUNT_CLEAR_STACK</a>,
<a name="l00152"></a>00152     0 | <a class="code" href="cffgload_8c.html#ae4b1860a6cc535b3aedf87be8414e8ad">CFF_COUNT_CLEAR_STACK</a>,
<a name="l00153"></a>00153     0 | <a class="code" href="cffgload_8c.html#ae4b1860a6cc535b3aedf87be8414e8ad">CFF_COUNT_CLEAR_STACK</a>,
<a name="l00154"></a>00154     0 | <a class="code" href="cffgload_8c.html#ae4b1860a6cc535b3aedf87be8414e8ad">CFF_COUNT_CLEAR_STACK</a>,
<a name="l00155"></a>00155 
<a name="l00156"></a>00156     13, <span class="comment">/* flex */</span>
<a name="l00157"></a>00157     7,
<a name="l00158"></a>00158     9,
<a name="l00159"></a>00159     11,
<a name="l00160"></a>00160 
<a name="l00161"></a>00161     0 | <a class="code" href="cffgload_8c.html#aaea2eb2399ab43c559d5f11586afb00b">CFF_COUNT_CHECK_WIDTH</a>, <span class="comment">/* endchar */</span>
<a name="l00162"></a>00162 
<a name="l00163"></a>00163     2 | <a class="code" href="cffgload_8c.html#aaea2eb2399ab43c559d5f11586afb00b">CFF_COUNT_CHECK_WIDTH</a>, <span class="comment">/* hstem */</span>
<a name="l00164"></a>00164     2 | <a class="code" href="cffgload_8c.html#aaea2eb2399ab43c559d5f11586afb00b">CFF_COUNT_CHECK_WIDTH</a>,
<a name="l00165"></a>00165     2 | <a class="code" href="cffgload_8c.html#aaea2eb2399ab43c559d5f11586afb00b">CFF_COUNT_CHECK_WIDTH</a>,
<a name="l00166"></a>00166     2 | <a class="code" href="cffgload_8c.html#aaea2eb2399ab43c559d5f11586afb00b">CFF_COUNT_CHECK_WIDTH</a>,
<a name="l00167"></a>00167 
<a name="l00168"></a>00168     0 | <a class="code" href="cffgload_8c.html#aaea2eb2399ab43c559d5f11586afb00b">CFF_COUNT_CHECK_WIDTH</a>, <span class="comment">/* hintmask */</span>
<a name="l00169"></a>00169     0 | <a class="code" href="cffgload_8c.html#aaea2eb2399ab43c559d5f11586afb00b">CFF_COUNT_CHECK_WIDTH</a>, <span class="comment">/* cntrmask */</span>
<a name="l00170"></a>00170     0, <span class="comment">/* dotsection */</span>
<a name="l00171"></a>00171 
<a name="l00172"></a>00172     1, <span class="comment">/* abs */</span>
<a name="l00173"></a>00173     2,
<a name="l00174"></a>00174     2,
<a name="l00175"></a>00175     2,
<a name="l00176"></a>00176     1,
<a name="l00177"></a>00177     0,
<a name="l00178"></a>00178     2,
<a name="l00179"></a>00179     1,
<a name="l00180"></a>00180 
<a name="l00181"></a>00181     1, <span class="comment">/* blend */</span>
<a name="l00182"></a>00182 
<a name="l00183"></a>00183     1, <span class="comment">/* drop */</span>
<a name="l00184"></a>00184     2,
<a name="l00185"></a>00185     1,
<a name="l00186"></a>00186     2,
<a name="l00187"></a>00187     1,
<a name="l00188"></a>00188 
<a name="l00189"></a>00189     2, <span class="comment">/* put */</span>
<a name="l00190"></a>00190     1,
<a name="l00191"></a>00191     4,
<a name="l00192"></a>00192     3,
<a name="l00193"></a>00193 
<a name="l00194"></a>00194     2, <span class="comment">/* and */</span>
<a name="l00195"></a>00195     2,
<a name="l00196"></a>00196     1,
<a name="l00197"></a>00197     2,
<a name="l00198"></a>00198     4,
<a name="l00199"></a>00199 
<a name="l00200"></a>00200     1, <span class="comment">/* callsubr */</span>
<a name="l00201"></a>00201     1,
<a name="l00202"></a>00202     0,
<a name="l00203"></a>00203 
<a name="l00204"></a>00204     2, <span class="comment">/* hsbw */</span>
<a name="l00205"></a>00205     0,
<a name="l00206"></a>00206     0,
<a name="l00207"></a>00207     0,
<a name="l00208"></a>00208     5, <span class="comment">/* seac */</span>
<a name="l00209"></a>00209     4, <span class="comment">/* sbw */</span>
<a name="l00210"></a>00210     2  <span class="comment">/* setcurrentpoint */</span>
<a name="l00211"></a>00211   };
<a name="l00212"></a>00212 
<a name="l00213"></a>00213 
<a name="l00214"></a>00214   <span class="comment">/*************************************************************************/</span>
<a name="l00215"></a>00215   <span class="comment">/*************************************************************************/</span>
<a name="l00216"></a>00216   <span class="comment">/*************************************************************************/</span>
<a name="l00217"></a>00217   <span class="comment">/**********                                                      *********/</span>
<a name="l00218"></a>00218   <span class="comment">/**********                                                      *********/</span>
<a name="l00219"></a>00219   <span class="comment">/**********             GENERIC CHARSTRING PARSING               *********/</span>
<a name="l00220"></a>00220   <span class="comment">/**********                                                      *********/</span>
<a name="l00221"></a>00221   <span class="comment">/**********                                                      *********/</span>
<a name="l00222"></a>00222   <span class="comment">/*************************************************************************/</span>
<a name="l00223"></a>00223   <span class="comment">/*************************************************************************/</span>
<a name="l00224"></a>00224   <span class="comment">/*************************************************************************/</span>
<a name="l00225"></a>00225 
<a name="l00226"></a>00226 
<a name="l00227"></a>00227   <span class="comment">/*************************************************************************/</span>
<a name="l00228"></a>00228   <span class="comment">/*                                                                       */</span>
<a name="l00229"></a>00229   <span class="comment">/* &lt;Function&gt;                                                            */</span>
<a name="l00230"></a>00230   <span class="comment">/*    cff_builder_init                                                   */</span>
<a name="l00231"></a>00231   <span class="comment">/*                                                                       */</span>
<a name="l00232"></a>00232   <span class="comment">/* &lt;Description&gt;                                                         */</span>
<a name="l00233"></a>00233   <span class="comment">/*    Initializes a given glyph builder.                                 */</span>
<a name="l00234"></a>00234   <span class="comment">/*                                                                       */</span>
<a name="l00235"></a>00235   <span class="comment">/* &lt;InOut&gt;                                                               */</span>
<a name="l00236"></a>00236   <span class="comment">/*    builder :: A pointer to the glyph builder to initialize.           */</span>
<a name="l00237"></a>00237   <span class="comment">/*                                                                       */</span>
<a name="l00238"></a>00238   <span class="comment">/* &lt;Input&gt;                                                               */</span>
<a name="l00239"></a>00239   <span class="comment">/*    face    :: The current face object.                                */</span>
<a name="l00240"></a>00240   <span class="comment">/*                                                                       */</span>
<a name="l00241"></a>00241   <span class="comment">/*    size    :: The current size object.                                */</span>
<a name="l00242"></a>00242   <span class="comment">/*                                                                       */</span>
<a name="l00243"></a>00243   <span class="comment">/*    glyph   :: The current glyph object.                               */</span>
<a name="l00244"></a>00244   <span class="comment">/*                                                                       */</span>
<a name="l00245"></a>00245   <span class="comment">/*    hinting :: Whether hinting is active.                              */</span>
<a name="l00246"></a>00246   <span class="comment">/*                                                                       */</span>
<a name="l00247"></a>00247   <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00248"></a>00248   cff_builder_init( <a class="code" href="struct_c_f_f___builder__.html">CFF_Builder</a>*   builder,
<a name="l00249"></a>00249                     <a class="code" href="struct_t_t___face_rec__.html">TT_Face</a>        face,
<a name="l00250"></a>00250                     <a class="code" href="struct_c_f_f___size_rec__.html">CFF_Size</a>       <a class="code" href="jsonmain_8cpp.html#ae5efd41ba4949e198484a6a7f1fd543b">size</a>,
<a name="l00251"></a>00251                     <a class="code" href="struct_c_f_f___glyph_slot_rec__.html">CFF_GlyphSlot</a>  glyph,
<a name="l00252"></a>00252                     <a class="code" href="fttypes_8h.html#a1a832a256bb5a7e6e884afaa1a07f3ae">FT_Bool</a>        hinting )
<a name="l00253"></a>00253   {
<a name="l00254"></a>00254     builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#ac8770a979f76c1dc11575dfdf40f1f88">path_begun</a>  = 0;
<a name="l00255"></a>00255     builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#abcce85e0ee7ffe37e1cbd3d6cea110c2">load_points</a> = 1;
<a name="l00256"></a>00256 
<a name="l00257"></a>00257     builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a415e44897a8329823ff2cea2990d8935">face</a>   = face;
<a name="l00258"></a>00258     builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a527ba659637b4e50be221d8b00d337c8">glyph</a>  = glyph;
<a name="l00259"></a>00259     builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a41fce66940ca6e0a746f0839d076142f">memory</a> = face-&gt;<a class="code" href="struct_t_t___face_rec__.html#ab07a1f6ce2cffe73a5501fb33164ae74">root</a>.<a class="code" href="struct_f_t___face_rec__.html#af269b241bfc2f570d485ab03fc0261b2">memory</a>;
<a name="l00260"></a>00260 
<a name="l00261"></a>00261     <span class="keywordflow">if</span> ( glyph )
<a name="l00262"></a>00262     {
<a name="l00263"></a>00263       <a class="code" href="ftgloadr_8h.html#a2671bcb107327e81037ea42332454741">FT_GlyphLoader</a>  loader = glyph-&gt;<a class="code" href="struct_c_f_f___glyph_slot_rec__.html#ae7539468b1990834d75e551f62486cb6">root</a>.<a class="code" href="struct_f_t___glyph_slot_rec__.html#a91731fd527eeab1d1acf3e1aea4bea84">internal</a>-&gt;<a class="code" href="struct_f_t___slot___internal_rec__.html#ac57f8c939f667938ab9f986088c15d8f">loader</a>;
<a name="l00264"></a>00264 
<a name="l00265"></a>00265 
<a name="l00266"></a>00266       builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a358be6966e4199e54d5551f81f496a5b">loader</a>  = loader;
<a name="l00267"></a>00267       builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a7c351f6ae7233c249f85f2371d809bac">base</a>    = &amp;loader-&gt;base.outline;
<a name="l00268"></a>00268       builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#acd27e804cd32054865ef4236e7f9dc93">current</a> = &amp;loader-&gt;current.outline;
<a name="l00269"></a>00269       <a class="code" href="ftgloadr_8h.html#a4f4954b6e77f155ab5e46c3f2351f50e">FT_GlyphLoader_Rewind</a>( loader );
<a name="l00270"></a>00270 
<a name="l00271"></a>00271       builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a65eb4c3939cd9dc8a176d0f42db20137">hints_globals</a> = 0;
<a name="l00272"></a>00272       builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a7eb0d9144e82e76d6fe4fbd03b678c69">hints_funcs</a>   = 0;
<a name="l00273"></a>00273 
<a name="l00274"></a>00274       <span class="keywordflow">if</span> ( hinting &amp;&amp; size )
<a name="l00275"></a>00275       {
<a name="l00276"></a>00276         <a class="code" href="struct_c_f_f___internal_rec__.html">CFF_Internal</a>  <span class="keyword">internal</span> = (<a class="code" href="cffobjs_8h.html#ab40d41ef320a6e5c964a3b06f385c766">CFF_Internal</a>)size-&gt;<a class="code" href="struct_c_f_f___size_rec__.html#abb30943bad9b5c4c966b4bf23a6594a4">root</a>.<a class="code" href="struct_f_t___size_rec__.html#a236c47ea3138e485c29b0d7baa5cf3b6">internal</a>;
<a name="l00277"></a>00277 
<a name="l00278"></a>00278 
<a name="l00279"></a>00279         builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a65eb4c3939cd9dc8a176d0f42db20137">hints_globals</a> = (<span class="keywordtype">void</span> *)<span class="keyword">internal</span>-&gt;topfont;
<a name="l00280"></a>00280         builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a7eb0d9144e82e76d6fe4fbd03b678c69">hints_funcs</a>   = glyph-&gt;<a class="code" href="struct_c_f_f___glyph_slot_rec__.html#ae7539468b1990834d75e551f62486cb6">root</a>.<a class="code" href="struct_f_t___glyph_slot_rec__.html#a91731fd527eeab1d1acf3e1aea4bea84">internal</a>-&gt;<a class="code" href="struct_f_t___slot___internal_rec__.html#a16337853823cdccfb0c636673c4eb3ae">glyph_hints</a>;
<a name="l00281"></a>00281       }
<a name="l00282"></a>00282     }
<a name="l00283"></a>00283 
<a name="l00284"></a>00284     builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a045d91695d51a1fbfa307aab507fa46b">pos_x</a> = 0;
<a name="l00285"></a>00285     builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a50a8bec8b857853829f42195101db472">pos_y</a> = 0;
<a name="l00286"></a>00286 
<a name="l00287"></a>00287     builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a1bee78d88325239036b57761fdd0423c">left_bearing</a>.<a class="code" href="struct_f_t___vector__.html#a941e818e6dfca06409cddff4f325f74c">x</a> = 0;
<a name="l00288"></a>00288     builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a1bee78d88325239036b57761fdd0423c">left_bearing</a>.<a class="code" href="struct_f_t___vector__.html#ac3246ed214e880047ec74eeb15f8b973">y</a> = 0;
<a name="l00289"></a>00289     builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a943906425298bbbdc85e7a6d626224b5">advance</a>.<a class="code" href="struct_f_t___vector__.html#a941e818e6dfca06409cddff4f325f74c">x</a>      = 0;
<a name="l00290"></a>00290     builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a943906425298bbbdc85e7a6d626224b5">advance</a>.<a class="code" href="struct_f_t___vector__.html#ac3246ed214e880047ec74eeb15f8b973">y</a>      = 0;
<a name="l00291"></a>00291   }
<a name="l00292"></a>00292 
<a name="l00293"></a>00293 
<a name="l00294"></a>00294   <span class="comment">/*************************************************************************/</span>
<a name="l00295"></a>00295   <span class="comment">/*                                                                       */</span>
<a name="l00296"></a>00296   <span class="comment">/* &lt;Function&gt;                                                            */</span>
<a name="l00297"></a>00297   <span class="comment">/*    cff_builder_done                                                   */</span>
<a name="l00298"></a>00298   <span class="comment">/*                                                                       */</span>
<a name="l00299"></a>00299   <span class="comment">/* &lt;Description&gt;                                                         */</span>
<a name="l00300"></a>00300   <span class="comment">/*    Finalizes a given glyph builder.  Its contents can still be used   */</span>
<a name="l00301"></a>00301   <span class="comment">/*    after the call, but the function saves important information       */</span>
<a name="l00302"></a>00302   <span class="comment">/*    within the corresponding glyph slot.                               */</span>
<a name="l00303"></a>00303   <span class="comment">/*                                                                       */</span>
<a name="l00304"></a>00304   <span class="comment">/* &lt;Input&gt;                                                               */</span>
<a name="l00305"></a>00305   <span class="comment">/*    builder :: A pointer to the glyph builder to finalize.             */</span>
<a name="l00306"></a>00306   <span class="comment">/*                                                                       */</span>
<a name="l00307"></a>00307   <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00308"></a>00308   cff_builder_done( <a class="code" href="struct_c_f_f___builder__.html">CFF_Builder</a>*  builder )
<a name="l00309"></a>00309   {
<a name="l00310"></a>00310     <a class="code" href="struct_c_f_f___glyph_slot_rec__.html">CFF_GlyphSlot</a>  glyph = builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a527ba659637b4e50be221d8b00d337c8">glyph</a>;
<a name="l00311"></a>00311 
<a name="l00312"></a>00312 
<a name="l00313"></a>00313     <span class="keywordflow">if</span> ( glyph )
<a name="l00314"></a>00314       glyph-&gt;<a class="code" href="struct_c_f_f___glyph_slot_rec__.html#ae7539468b1990834d75e551f62486cb6">root</a>.<a class="code" href="struct_f_t___glyph_slot_rec__.html#a8e46dd5d808079bdcba68056d6476d8d">outline</a> = *builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a7c351f6ae7233c249f85f2371d809bac">base</a>;
<a name="l00315"></a>00315   }
<a name="l00316"></a>00316 
<a name="l00317"></a>00317 
<a name="l00318"></a>00318   <span class="comment">/*************************************************************************/</span>
<a name="l00319"></a>00319   <span class="comment">/*                                                                       */</span>
<a name="l00320"></a>00320   <span class="comment">/* &lt;Function&gt;                                                            */</span>
<a name="l00321"></a>00321   <span class="comment">/*    cff_compute_bias                                                   */</span>
<a name="l00322"></a>00322   <span class="comment">/*                                                                       */</span>
<a name="l00323"></a>00323   <span class="comment">/* &lt;Description&gt;                                                         */</span>
<a name="l00324"></a>00324   <span class="comment">/*    Computes the bias value in dependence of the number of glyph       */</span>
<a name="l00325"></a>00325   <span class="comment">/*    subroutines.                                                       */</span>
<a name="l00326"></a>00326   <span class="comment">/*                                                                       */</span>
<a name="l00327"></a>00327   <span class="comment">/* &lt;Input&gt;                                                               */</span>
<a name="l00328"></a>00328   <span class="comment">/*    in_charstring_type :: The `CharstringType&#39; value of the top DICT   */</span>
<a name="l00329"></a>00329   <span class="comment">/*                          dictionary.                                  */</span>
<a name="l00330"></a>00330   <span class="comment">/*                                                                       */</span>
<a name="l00331"></a>00331   <span class="comment">/*    num_subrs          :: The number of glyph subroutines.             */</span>
<a name="l00332"></a>00332   <span class="comment">/*                                                                       */</span>
<a name="l00333"></a>00333   <span class="comment">/* &lt;Return&gt;                                                              */</span>
<a name="l00334"></a>00334   <span class="comment">/*    The bias value.                                                    */</span>
<a name="l00335"></a>00335   <span class="keyword">static</span> <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>
<a name="l00336"></a>00336   cff_compute_bias( <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>   in_charstring_type,
<a name="l00337"></a>00337                     <a class="code" href="fttypes_8h.html#abcb8db4dbf35d2b55a9e8c7b0926dc52">FT_UInt</a>  num_subrs )
<a name="l00338"></a>00338   {
<a name="l00339"></a>00339     <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>  <a class="code" href="jsonmain_8cpp.html#ade6d6d18a46c8aa95eed5e179d003e45">result</a>;
<a name="l00340"></a>00340 
<a name="l00341"></a>00341 
<a name="l00342"></a>00342     <span class="keywordflow">if</span> ( in_charstring_type == 1 )
<a name="l00343"></a>00343       result = 0;
<a name="l00344"></a>00344     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( num_subrs &lt; 1240 )
<a name="l00345"></a>00345       result = 107;
<a name="l00346"></a>00346     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( num_subrs &lt; 33900U )
<a name="l00347"></a>00347       result = 1131;
<a name="l00348"></a>00348     <span class="keywordflow">else</span>
<a name="l00349"></a>00349       result = 32768U;
<a name="l00350"></a>00350 
<a name="l00351"></a>00351     <span class="keywordflow">return</span> <a class="code" href="jsonmain_8cpp.html#ade6d6d18a46c8aa95eed5e179d003e45">result</a>;
<a name="l00352"></a>00352   }
<a name="l00353"></a>00353 
<a name="l00354"></a>00354 
<a name="l00355"></a>00355   <span class="comment">/*************************************************************************/</span>
<a name="l00356"></a>00356   <span class="comment">/*                                                                       */</span>
<a name="l00357"></a>00357   <span class="comment">/* &lt;Function&gt;                                                            */</span>
<a name="l00358"></a>00358   <span class="comment">/*    cff_decoder_init                                                   */</span>
<a name="l00359"></a>00359   <span class="comment">/*                                                                       */</span>
<a name="l00360"></a>00360   <span class="comment">/* &lt;Description&gt;                                                         */</span>
<a name="l00361"></a>00361   <span class="comment">/*    Initializes a given glyph decoder.                                 */</span>
<a name="l00362"></a>00362   <span class="comment">/*                                                                       */</span>
<a name="l00363"></a>00363   <span class="comment">/* &lt;InOut&gt;                                                               */</span>
<a name="l00364"></a>00364   <span class="comment">/*    decoder :: A pointer to the glyph builder to initialize.           */</span>
<a name="l00365"></a>00365   <span class="comment">/*                                                                       */</span>
<a name="l00366"></a>00366   <span class="comment">/* &lt;Input&gt;                                                               */</span>
<a name="l00367"></a>00367   <span class="comment">/*    face      :: The current face object.                              */</span>
<a name="l00368"></a>00368   <span class="comment">/*                                                                       */</span>
<a name="l00369"></a>00369   <span class="comment">/*    size      :: The current size object.                              */</span>
<a name="l00370"></a>00370   <span class="comment">/*                                                                       */</span>
<a name="l00371"></a>00371   <span class="comment">/*    slot      :: The current glyph object.                             */</span>
<a name="l00372"></a>00372   <span class="comment">/*                                                                       */</span>
<a name="l00373"></a>00373   <span class="comment">/*    hinting   :: Whether hinting is active.                            */</span>
<a name="l00374"></a>00374   <span class="comment">/*                                                                       */</span>
<a name="l00375"></a>00375   <span class="comment">/*    hint_mode :: The hinting mode.                                     */</span>
<a name="l00376"></a>00376   <span class="comment">/*                                                                       */</span>
<a name="l00377"></a>00377   <a class="code" href="ftconfig_8h.html#a065cda933183dff5dc368794eefa7c93">FT_LOCAL_DEF</a>( <span class="keywordtype">void</span> )
<a name="l00378"></a><a class="code" href="cffgload_8h.html#a8bbc0e91ca59bd98aa5f749ac2dc1f9e">00378</a>   <a class="code" href="cffgload_8c.html#a8bbc0e91ca59bd98aa5f749ac2dc1f9e">cff_decoder_init</a>( <a class="code" href="struct_c_f_f___decoder__.html">CFF_Decoder</a>*    decoder,
<a name="l00379"></a>00379                     <a class="code" href="struct_t_t___face_rec__.html">TT_Face</a>         face,
<a name="l00380"></a>00380                     <a class="code" href="struct_c_f_f___size_rec__.html">CFF_Size</a>        size,
<a name="l00381"></a>00381                     <a class="code" href="struct_c_f_f___glyph_slot_rec__.html">CFF_GlyphSlot</a>   slot,
<a name="l00382"></a>00382                     <a class="code" href="fttypes_8h.html#a1a832a256bb5a7e6e884afaa1a07f3ae">FT_Bool</a>         hinting,
<a name="l00383"></a>00383                     <a class="code" href="freetype_8h.html#aaa0488bc4d2c5f0a6f4311ddee8edfb7">FT_Render_Mode</a>  hint_mode )
<a name="l00384"></a>00384   {
<a name="l00385"></a>00385     <a class="code" href="struct_c_f_f___font_rec__.html">CFF_Font</a>  cff = (<a class="code" href="cfftypes_8h.html#a5e0f673b92ece4958ef2cc9b54ca4f44">CFF_Font</a>)face-&gt;extra.data;
<a name="l00386"></a>00386 
<a name="l00387"></a>00387 
<a name="l00388"></a>00388     <span class="comment">/* clear everything */</span>
<a name="l00389"></a>00389     <a class="code" href="ftmemory_8h.html#ad04dbb2871d7219281966386fffaf909">FT_MEM_ZERO</a>( decoder, <span class="keyword">sizeof</span> ( *decoder ) );
<a name="l00390"></a>00390 
<a name="l00391"></a>00391     <span class="comment">/* initialize builder */</span>
<a name="l00392"></a>00392     cff_builder_init( &amp;decoder-&gt;builder, face, size, slot, hinting );
<a name="l00393"></a>00393 
<a name="l00394"></a>00394     <span class="comment">/* initialize Type2 decoder */</span>
<a name="l00395"></a>00395     decoder-&gt;cff          = cff;
<a name="l00396"></a>00396     decoder-&gt;num_globals  = cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#ae8a10a70519dfb5640f72d2bdfa2a9d4">global_subrs_index</a>.count;
<a name="l00397"></a>00397     decoder-&gt;globals      = cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a2f3d4784b9f30b0df597497ee86f7f6c">global_subrs</a>;
<a name="l00398"></a>00398     decoder-&gt;globals_bias = cff_compute_bias(
<a name="l00399"></a>00399                               cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a62120839c2d743718806b72799e3af67">top_font</a>.<a class="code" href="struct_c_f_f___sub_font_rec__.html#af23b698ce981c661db031c834475ddb2">font_dict</a>.<a class="code" href="struct_c_f_f___font_rec_dict_rec__.html#a55fc47f5b43292f1d4f5691cf96523e2">charstring_type</a>,
<a name="l00400"></a>00400                               decoder-&gt;num_globals );
<a name="l00401"></a>00401 
<a name="l00402"></a>00402     decoder-&gt;hint_mode    = hint_mode;
<a name="l00403"></a>00403   }
<a name="l00404"></a>00404 
<a name="l00405"></a>00405 
<a name="l00406"></a>00406   <span class="comment">/* this function is used to select the subfont */</span>
<a name="l00407"></a>00407   <span class="comment">/* and the locals subrs array                  */</span>
<a name="l00408"></a>00408   <a class="code" href="ftconfig_8h.html#a065cda933183dff5dc368794eefa7c93">FT_LOCAL_DEF</a>( <a class="code" href="fttypes_8h.html#a64c8060bdb3d6eec844a1bf670e06bdd">FT_Error</a> )
<a name="l00409"></a><a class="code" href="cffgload_8h.html#a560ec3f07b5b59462a7d3199cd1df656">00409</a>   <a class="code" href="cffgload_8c.html#a560ec3f07b5b59462a7d3199cd1df656">cff_decoder_prepare</a>( <a class="code" href="struct_c_f_f___decoder__.html">CFF_Decoder</a>*  decoder,
<a name="l00410"></a>00410                        <a class="code" href="struct_c_f_f___size_rec__.html">CFF_Size</a>      size,
<a name="l00411"></a>00411                        <a class="code" href="fttypes_8h.html#abcb8db4dbf35d2b55a9e8c7b0926dc52">FT_UInt</a>       glyph_index )
<a name="l00412"></a>00412   {
<a name="l00413"></a>00413     <a class="code" href="struct_c_f_f___builder__.html">CFF_Builder</a>  *builder = &amp;decoder-&gt;builder;
<a name="l00414"></a>00414     <a class="code" href="struct_c_f_f___font_rec__.html">CFF_Font</a>      cff     = (<a class="code" href="cfftypes_8h.html#a5e0f673b92ece4958ef2cc9b54ca4f44">CFF_Font</a>)builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a415e44897a8329823ff2cea2990d8935">face</a>-&gt;<a class="code" href="struct_t_t___face_rec__.html#ab1ffe97c9ad4f20c71069b6b9bf005ee">extra</a>.<a class="code" href="struct_f_t___generic__.html#af0bf8b983254b662f293e9a20505e27e">data</a>;
<a name="l00415"></a>00415     <a class="code" href="struct_c_f_f___sub_font_rec__.html">CFF_SubFont</a>   sub     = &amp;cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a62120839c2d743718806b72799e3af67">top_font</a>;
<a name="l00416"></a>00416     <a class="code" href="fttypes_8h.html#a64c8060bdb3d6eec844a1bf670e06bdd">FT_Error</a>      error   = CFF_Err_Ok;
<a name="l00417"></a>00417 
<a name="l00418"></a>00418 
<a name="l00419"></a>00419     <span class="comment">/* manage CID fonts */</span>
<a name="l00420"></a>00420     if ( cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a325d7331c2f2608ffc47860c2414424a">num_subfonts</a> )
<a name="l00421"></a>00421     {
<a name="l00422"></a>00422       <a class="code" href="fttypes_8h.html#a51f26183ca0c9f4af958939648caeccd">FT_Byte</a>  fd_index = <a class="code" href="cffload_8c.html#a72d672c11e4ec62796e13b931c6dc061">cff_fd_select_get</a>( &amp;cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a91a0f13516ff978c498355205c639342">fd_select</a>, glyph_index );
<a name="l00423"></a>00423 
<a name="l00424"></a>00424 
<a name="l00425"></a>00425       <span class="keywordflow">if</span> ( fd_index &gt;= cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a325d7331c2f2608ffc47860c2414424a">num_subfonts</a> )
<a name="l00426"></a>00426       {
<a name="l00427"></a>00427         <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot;cff_decoder_prepare: invalid CID subfont index\n&quot;</span> ));
<a name="l00428"></a>00428         error = CFF_Err_Invalid_File_Format;
<a name="l00429"></a>00429         <span class="keywordflow">goto</span> Exit;
<a name="l00430"></a>00430       }
<a name="l00431"></a>00431 
<a name="l00432"></a>00432       <a class="code" href="ftdebug_8h.html#a9ff2b46b2097d26afa62871cddccdaad">FT_TRACE3</a>(( <span class="stringliteral">&quot;glyph index %d (subfont %d):\n&quot;</span>, glyph_index, fd_index ));
<a name="l00433"></a>00433 
<a name="l00434"></a>00434       sub = cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a3e915487d0ab4eeeed395e8f1da25935">subfonts</a>[fd_index];
<a name="l00435"></a>00435 
<a name="l00436"></a>00436       <span class="keywordflow">if</span> ( builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a7eb0d9144e82e76d6fe4fbd03b678c69">hints_funcs</a> &amp;&amp; size )
<a name="l00437"></a>00437       {
<a name="l00438"></a>00438         <a class="code" href="struct_c_f_f___internal_rec__.html">CFF_Internal</a>  <span class="keyword">internal</span> = (<a class="code" href="cffobjs_8h.html#ab40d41ef320a6e5c964a3b06f385c766">CFF_Internal</a>)size-&gt;root.internal;
<a name="l00439"></a>00439 
<a name="l00440"></a>00440 
<a name="l00441"></a>00441         <span class="comment">/* for CFFs without subfonts, this value has already been set */</span>
<a name="l00442"></a>00442         builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a65eb4c3939cd9dc8a176d0f42db20137">hints_globals</a> = (<span class="keywordtype">void</span> *)<span class="keyword">internal</span>-&gt;subfonts[fd_index];
<a name="l00443"></a>00443       }
<a name="l00444"></a>00444     }
<a name="l00445"></a>00445 <span class="preprocessor">#ifdef FT_DEBUG_LEVEL_TRACE</span>
<a name="l00446"></a>00446 <span class="preprocessor"></span>    <span class="keywordflow">else</span>
<a name="l00447"></a>00447       <a class="code" href="ftdebug_8h.html#a9ff2b46b2097d26afa62871cddccdaad">FT_TRACE3</a>(( <span class="stringliteral">&quot;glyph index %d:\n&quot;</span>, glyph_index ));
<a name="l00448"></a>00448 <span class="preprocessor">#endif</span>
<a name="l00449"></a>00449 <span class="preprocessor"></span>
<a name="l00450"></a>00450     decoder-&gt;num_locals    = sub-&gt;local_subrs_index.count;
<a name="l00451"></a>00451     decoder-&gt;locals        = sub-&gt;local_subrs;
<a name="l00452"></a>00452     decoder-&gt;locals_bias   = cff_compute_bias(
<a name="l00453"></a>00453                                decoder-&gt;cff-&gt;top_font.font_dict.charstring_type,
<a name="l00454"></a>00454                                decoder-&gt;num_locals );
<a name="l00455"></a>00455 
<a name="l00456"></a>00456     decoder-&gt;glyph_width   = sub-&gt;private_dict.default_width;
<a name="l00457"></a>00457     decoder-&gt;nominal_width = sub-&gt;private_dict.nominal_width;
<a name="l00458"></a>00458 
<a name="l00459"></a>00459   Exit:
<a name="l00460"></a>00460     <span class="keywordflow">return</span> error;
<a name="l00461"></a>00461   }
<a name="l00462"></a>00462 
<a name="l00463"></a>00463 
<a name="l00464"></a>00464   <span class="comment">/* check that there is enough space for `count&#39; more points */</span>
<a name="l00465"></a>00465   <span class="keyword">static</span> <a class="code" href="fttypes_8h.html#a64c8060bdb3d6eec844a1bf670e06bdd">FT_Error</a>
<a name="l00466"></a>00466   <a class="code" href="t1decode_8c.html#abb2307d7c9ff1cfc3bf71de0f68f3174">check_points</a>( <a class="code" href="struct_c_f_f___builder__.html">CFF_Builder</a>*  builder,
<a name="l00467"></a>00467                 <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>        count )
<a name="l00468"></a>00468   {
<a name="l00469"></a>00469     <span class="keywordflow">return</span> <a class="code" href="ftgloadr_8h.html#a5aab8fc2b9b4b72e84710c8dbccb044e">FT_GLYPHLOADER_CHECK_POINTS</a>( builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a358be6966e4199e54d5551f81f496a5b">loader</a>, count, 0 );
<a name="l00470"></a>00470   }
<a name="l00471"></a>00471 
<a name="l00472"></a>00472 
<a name="l00473"></a>00473   <span class="comment">/* add a new point, do not check space */</span>
<a name="l00474"></a>00474   <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00475"></a>00475   cff_builder_add_point( <a class="code" href="struct_c_f_f___builder__.html">CFF_Builder</a>*  builder,
<a name="l00476"></a>00476                          <a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>        x,
<a name="l00477"></a>00477                          <a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>        y,
<a name="l00478"></a>00478                          <a class="code" href="fttypes_8h.html#a51f26183ca0c9f4af958939648caeccd">FT_Byte</a>       flag )
<a name="l00479"></a>00479   {
<a name="l00480"></a>00480     <a class="code" href="struct_f_t___outline__.html">FT_Outline</a>*  outline = builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#acd27e804cd32054865ef4236e7f9dc93">current</a>;
<a name="l00481"></a>00481 
<a name="l00482"></a>00482 
<a name="l00483"></a>00483     <span class="keywordflow">if</span> ( builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#abcce85e0ee7ffe37e1cbd3d6cea110c2">load_points</a> )
<a name="l00484"></a>00484     {
<a name="l00485"></a>00485       <a class="code" href="struct_f_t___vector__.html">FT_Vector</a>*  point   = outline-&gt;<a class="code" href="struct_f_t___outline__.html#a4871896a2f38bdab947e30a7cf6bca04">points</a> + outline-&gt;<a class="code" href="struct_f_t___outline__.html#a7ebcf3c33231af88655534d1ac02b66e">n_points</a>;
<a name="l00486"></a>00486       <a class="code" href="fttypes_8h.html#a51f26183ca0c9f4af958939648caeccd">FT_Byte</a>*    control = (<a class="code" href="fttypes_8h.html#a51f26183ca0c9f4af958939648caeccd">FT_Byte</a>*)outline-&gt;<a class="code" href="struct_f_t___outline__.html#ac84ca66907361e1f49ec11c14720087a">tags</a> + outline-&gt;<a class="code" href="struct_f_t___outline__.html#a7ebcf3c33231af88655534d1ac02b66e">n_points</a>;
<a name="l00487"></a>00487 
<a name="l00488"></a>00488 
<a name="l00489"></a>00489       point-&gt;<a class="code" href="struct_f_t___vector__.html#a941e818e6dfca06409cddff4f325f74c">x</a> = x &gt;&gt; 16;
<a name="l00490"></a>00490       point-&gt;<a class="code" href="struct_f_t___vector__.html#ac3246ed214e880047ec74eeb15f8b973">y</a> = y &gt;&gt; 16;
<a name="l00491"></a>00491       *control = (<a class="code" href="fttypes_8h.html#a51f26183ca0c9f4af958939648caeccd">FT_Byte</a>)( flag ? <a class="code" href="ftimage_8h.html#a967f934e5e5e1ee1fe4291d23959aa9c">FT_CURVE_TAG_ON</a> : <a class="code" href="ftimage_8h.html#a031f7941800d809c561e39bc10935b18">FT_CURVE_TAG_CUBIC</a> );
<a name="l00492"></a>00492     }
<a name="l00493"></a>00493 
<a name="l00494"></a>00494     outline-&gt;<a class="code" href="struct_f_t___outline__.html#a7ebcf3c33231af88655534d1ac02b66e">n_points</a>++;
<a name="l00495"></a>00495   }
<a name="l00496"></a>00496 
<a name="l00497"></a>00497 
<a name="l00498"></a>00498   <span class="comment">/* check space for a new on-curve point, then add it */</span>
<a name="l00499"></a>00499   <span class="keyword">static</span> <a class="code" href="fttypes_8h.html#a64c8060bdb3d6eec844a1bf670e06bdd">FT_Error</a>
<a name="l00500"></a>00500   cff_builder_add_point1( <a class="code" href="struct_c_f_f___builder__.html">CFF_Builder</a>*  builder,
<a name="l00501"></a>00501                           <a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>        x,
<a name="l00502"></a>00502                           <a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>        y )
<a name="l00503"></a>00503   {
<a name="l00504"></a>00504     <a class="code" href="fttypes_8h.html#a64c8060bdb3d6eec844a1bf670e06bdd">FT_Error</a>  error;
<a name="l00505"></a>00505 
<a name="l00506"></a>00506 
<a name="l00507"></a>00507     error = <a class="code" href="t1decode_8c.html#abb2307d7c9ff1cfc3bf71de0f68f3174">check_points</a>( builder, 1 );
<a name="l00508"></a>00508     <span class="keywordflow">if</span> ( !error )
<a name="l00509"></a>00509       cff_builder_add_point( builder, x, y, 1 );
<a name="l00510"></a>00510 
<a name="l00511"></a>00511     <span class="keywordflow">return</span> error;
<a name="l00512"></a>00512   }
<a name="l00513"></a>00513 
<a name="l00514"></a>00514 
<a name="l00515"></a>00515   <span class="comment">/* check space for a new contour, then add it */</span>
<a name="l00516"></a>00516   <span class="keyword">static</span> <a class="code" href="fttypes_8h.html#a64c8060bdb3d6eec844a1bf670e06bdd">FT_Error</a>
<a name="l00517"></a>00517   cff_builder_add_contour( <a class="code" href="struct_c_f_f___builder__.html">CFF_Builder</a>*  builder )
<a name="l00518"></a>00518   {
<a name="l00519"></a>00519     <a class="code" href="struct_f_t___outline__.html">FT_Outline</a>*  outline = builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#acd27e804cd32054865ef4236e7f9dc93">current</a>;
<a name="l00520"></a>00520     <a class="code" href="fttypes_8h.html#a64c8060bdb3d6eec844a1bf670e06bdd">FT_Error</a>     error;
<a name="l00521"></a>00521 
<a name="l00522"></a>00522 
<a name="l00523"></a>00523     <span class="keywordflow">if</span> ( !builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#abcce85e0ee7ffe37e1cbd3d6cea110c2">load_points</a> )
<a name="l00524"></a>00524     {
<a name="l00525"></a>00525       outline-&gt;<a class="code" href="struct_f_t___outline__.html#a0313ba9c2c51f10e6b7d7ef97bd946e2">n_contours</a>++;
<a name="l00526"></a>00526       <span class="keywordflow">return</span> CFF_Err_Ok;
<a name="l00527"></a>00527     }
<a name="l00528"></a>00528 
<a name="l00529"></a>00529     error = <a class="code" href="ftgloadr_8h.html#a5aab8fc2b9b4b72e84710c8dbccb044e">FT_GLYPHLOADER_CHECK_POINTS</a>( builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a358be6966e4199e54d5551f81f496a5b">loader</a>, 0, 1 );
<a name="l00530"></a>00530     <span class="keywordflow">if</span> ( !error )
<a name="l00531"></a>00531     {
<a name="l00532"></a>00532       <span class="keywordflow">if</span> ( outline-&gt;<a class="code" href="struct_f_t___outline__.html#a0313ba9c2c51f10e6b7d7ef97bd946e2">n_contours</a> &gt; 0 )
<a name="l00533"></a>00533         outline-&gt;<a class="code" href="struct_f_t___outline__.html#a218fdea14003061142ac1045ac50affa">contours</a>[outline-&gt;<a class="code" href="struct_f_t___outline__.html#a0313ba9c2c51f10e6b7d7ef97bd946e2">n_contours</a> - 1] =
<a name="l00534"></a>00534           (short)( outline-&gt;<a class="code" href="struct_f_t___outline__.html#a7ebcf3c33231af88655534d1ac02b66e">n_points</a> - 1 );
<a name="l00535"></a>00535 
<a name="l00536"></a>00536       outline-&gt;<a class="code" href="struct_f_t___outline__.html#a0313ba9c2c51f10e6b7d7ef97bd946e2">n_contours</a>++;
<a name="l00537"></a>00537     }
<a name="l00538"></a>00538 
<a name="l00539"></a>00539     <span class="keywordflow">return</span> error;
<a name="l00540"></a>00540   }
<a name="l00541"></a>00541 
<a name="l00542"></a>00542 
<a name="l00543"></a>00543   <span class="comment">/* if a path was begun, add its first on-curve point */</span>
<a name="l00544"></a>00544   <span class="keyword">static</span> <a class="code" href="fttypes_8h.html#a64c8060bdb3d6eec844a1bf670e06bdd">FT_Error</a>
<a name="l00545"></a>00545   cff_builder_start_point( <a class="code" href="struct_c_f_f___builder__.html">CFF_Builder</a>*  builder,
<a name="l00546"></a>00546                            <a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>        x,
<a name="l00547"></a>00547                            <a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>        y )
<a name="l00548"></a>00548   {
<a name="l00549"></a>00549     <a class="code" href="fttypes_8h.html#a64c8060bdb3d6eec844a1bf670e06bdd">FT_Error</a>  error = CFF_Err_Ok;
<a name="l00550"></a>00550 
<a name="l00551"></a>00551 
<a name="l00552"></a>00552     <span class="comment">/* test whether we are building a new contour */</span>
<a name="l00553"></a>00553     <span class="keywordflow">if</span> ( !builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#ac8770a979f76c1dc11575dfdf40f1f88">path_begun</a> )
<a name="l00554"></a>00554     {
<a name="l00555"></a>00555       builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#ac8770a979f76c1dc11575dfdf40f1f88">path_begun</a> = 1;
<a name="l00556"></a>00556       error = cff_builder_add_contour( builder );
<a name="l00557"></a>00557       <span class="keywordflow">if</span> ( !error )
<a name="l00558"></a>00558         error = cff_builder_add_point1( builder, x, y );
<a name="l00559"></a>00559     }
<a name="l00560"></a>00560 
<a name="l00561"></a>00561     <span class="keywordflow">return</span> error;
<a name="l00562"></a>00562   }
<a name="l00563"></a>00563 
<a name="l00564"></a>00564 
<a name="l00565"></a>00565   <span class="comment">/* close the current contour */</span>
<a name="l00566"></a>00566   <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00567"></a>00567   cff_builder_close_contour( <a class="code" href="struct_c_f_f___builder__.html">CFF_Builder</a>*  builder )
<a name="l00568"></a>00568   {
<a name="l00569"></a>00569     <a class="code" href="struct_f_t___outline__.html">FT_Outline</a>*  outline = builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#acd27e804cd32054865ef4236e7f9dc93">current</a>;
<a name="l00570"></a>00570     <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>       first;
<a name="l00571"></a>00571 
<a name="l00572"></a>00572 
<a name="l00573"></a>00573     <span class="keywordflow">if</span> ( !outline )
<a name="l00574"></a>00574       <span class="keywordflow">return</span>;
<a name="l00575"></a>00575 
<a name="l00576"></a>00576     first = outline-&gt;<a class="code" href="struct_f_t___outline__.html#a0313ba9c2c51f10e6b7d7ef97bd946e2">n_contours</a> &lt;= 1
<a name="l00577"></a>00577             ? 0 : outline-&gt;<a class="code" href="struct_f_t___outline__.html#a218fdea14003061142ac1045ac50affa">contours</a>[outline-&gt;<a class="code" href="struct_f_t___outline__.html#a0313ba9c2c51f10e6b7d7ef97bd946e2">n_contours</a> - 2] + 1;
<a name="l00578"></a>00578 
<a name="l00579"></a>00579     <span class="comment">/* We must not include the last point in the path if it */</span>
<a name="l00580"></a>00580     <span class="comment">/* is located on the first point.                       */</span>
<a name="l00581"></a>00581     <span class="keywordflow">if</span> ( outline-&gt;<a class="code" href="struct_f_t___outline__.html#a7ebcf3c33231af88655534d1ac02b66e">n_points</a> &gt; 1 )
<a name="l00582"></a>00582     {
<a name="l00583"></a>00583       <a class="code" href="struct_f_t___vector__.html">FT_Vector</a>*  p1      = outline-&gt;<a class="code" href="struct_f_t___outline__.html#a4871896a2f38bdab947e30a7cf6bca04">points</a> + first;
<a name="l00584"></a>00584       <a class="code" href="struct_f_t___vector__.html">FT_Vector</a>*  p2      = outline-&gt;<a class="code" href="struct_f_t___outline__.html#a4871896a2f38bdab947e30a7cf6bca04">points</a> + outline-&gt;<a class="code" href="struct_f_t___outline__.html#a7ebcf3c33231af88655534d1ac02b66e">n_points</a> - 1;
<a name="l00585"></a>00585       <a class="code" href="fttypes_8h.html#a51f26183ca0c9f4af958939648caeccd">FT_Byte</a>*    control = (<a class="code" href="fttypes_8h.html#a51f26183ca0c9f4af958939648caeccd">FT_Byte</a>*)outline-&gt;<a class="code" href="struct_f_t___outline__.html#ac84ca66907361e1f49ec11c14720087a">tags</a> + outline-&gt;<a class="code" href="struct_f_t___outline__.html#a7ebcf3c33231af88655534d1ac02b66e">n_points</a> - 1;
<a name="l00586"></a>00586 
<a name="l00587"></a>00587 
<a name="l00588"></a>00588       <span class="comment">/* `delete&#39; last point only if it coincides with the first    */</span>
<a name="l00589"></a>00589       <span class="comment">/* point and if it is not a control point (which can happen). */</span>
<a name="l00590"></a>00590       if ( p1-&gt;<a class="code" href="struct_f_t___vector__.html#a941e818e6dfca06409cddff4f325f74c">x</a> == p2-&gt;<a class="code" href="struct_f_t___vector__.html#a941e818e6dfca06409cddff4f325f74c">x</a> &amp;&amp; p1-&gt;<a class="code" href="struct_f_t___vector__.html#ac3246ed214e880047ec74eeb15f8b973">y</a> == p2-&gt;<a class="code" href="struct_f_t___vector__.html#ac3246ed214e880047ec74eeb15f8b973">y</a> )
<a name="l00591"></a>00591         <span class="keywordflow">if</span> ( *control == <a class="code" href="ftimage_8h.html#a967f934e5e5e1ee1fe4291d23959aa9c">FT_CURVE_TAG_ON</a> )
<a name="l00592"></a>00592           outline-&gt;<a class="code" href="struct_f_t___outline__.html#a7ebcf3c33231af88655534d1ac02b66e">n_points</a>--;
<a name="l00593"></a>00593     }
<a name="l00594"></a>00594 
<a name="l00595"></a>00595     <span class="keywordflow">if</span> ( outline-&gt;<a class="code" href="struct_f_t___outline__.html#a0313ba9c2c51f10e6b7d7ef97bd946e2">n_contours</a> &gt; 0 )
<a name="l00596"></a>00596     {
<a name="l00597"></a>00597       <span class="comment">/* Don&#39;t add contours only consisting of one point, i.e., */</span>
<a name="l00598"></a>00598       <span class="comment">/* check whether begin point and last point are the same. */</span>
<a name="l00599"></a>00599       <span class="keywordflow">if</span> ( first == outline-&gt;<a class="code" href="struct_f_t___outline__.html#a7ebcf3c33231af88655534d1ac02b66e">n_points</a> - 1 )
<a name="l00600"></a>00600       {
<a name="l00601"></a>00601         outline-&gt;<a class="code" href="struct_f_t___outline__.html#a0313ba9c2c51f10e6b7d7ef97bd946e2">n_contours</a>--;
<a name="l00602"></a>00602         outline-&gt;<a class="code" href="struct_f_t___outline__.html#a7ebcf3c33231af88655534d1ac02b66e">n_points</a>--;
<a name="l00603"></a>00603       }
<a name="l00604"></a>00604       <span class="keywordflow">else</span>
<a name="l00605"></a>00605         outline-&gt;<a class="code" href="struct_f_t___outline__.html#a218fdea14003061142ac1045ac50affa">contours</a>[outline-&gt;<a class="code" href="struct_f_t___outline__.html#a0313ba9c2c51f10e6b7d7ef97bd946e2">n_contours</a> - 1] =
<a name="l00606"></a>00606           (short)( outline-&gt;<a class="code" href="struct_f_t___outline__.html#a7ebcf3c33231af88655534d1ac02b66e">n_points</a> - 1 );
<a name="l00607"></a>00607     }
<a name="l00608"></a>00608   }
<a name="l00609"></a>00609 
<a name="l00610"></a>00610 
<a name="l00611"></a>00611   <span class="keyword">static</span> <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>
<a name="l00612"></a>00612   cff_lookup_glyph_by_stdcharcode( <a class="code" href="struct_c_f_f___font_rec__.html">CFF_Font</a>  cff,
<a name="l00613"></a>00613                                    <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>    charcode )
<a name="l00614"></a>00614   {
<a name="l00615"></a>00615     <a class="code" href="fttypes_8h.html#abcb8db4dbf35d2b55a9e8c7b0926dc52">FT_UInt</a>    <a class="code" href="jsonmain_8cpp.html#a4eacae1d9e7c39f8236bb36d4ececa77">n</a>;
<a name="l00616"></a>00616     <a class="code" href="fttypes_8h.html#a937f6c17cf5ffd09086d8610c37b9f58">FT_UShort</a>  glyph_sid;
<a name="l00617"></a>00617 
<a name="l00618"></a>00618 
<a name="l00619"></a>00619     <span class="comment">/* CID-keyed fonts don&#39;t have glyph names */</span>
<a name="l00620"></a>00620     <span class="keywordflow">if</span> ( !cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a47a0be8fcc4abce3751656a4f08c3f77">charset</a>.<a class="code" href="struct_c_f_f___charset_rec__.html#a1a8b95d80a18ebb7b02b2ab3aaa672e7">sids</a> )
<a name="l00621"></a>00621       <span class="keywordflow">return</span> -1;
<a name="l00622"></a>00622 
<a name="l00623"></a>00623     <span class="comment">/* check range of standard char code */</span>
<a name="l00624"></a>00624     <span class="keywordflow">if</span> ( charcode &lt; 0 || charcode &gt; 255 )
<a name="l00625"></a>00625       <span class="keywordflow">return</span> -1;
<a name="l00626"></a>00626 
<a name="l00627"></a>00627     <span class="comment">/* Get code to SID mapping from `cff_standard_encoding&#39;. */</span>
<a name="l00628"></a>00628     glyph_sid = <a class="code" href="cffload_8c.html#a19ae3ab229e409fe8bb777815e2737f4">cff_get_standard_encoding</a>( (<a class="code" href="fttypes_8h.html#abcb8db4dbf35d2b55a9e8c7b0926dc52">FT_UInt</a>)charcode );
<a name="l00629"></a>00629 
<a name="l00630"></a>00630     <span class="keywordflow">for</span> ( n = 0; n &lt; cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#af938965b67a100d7e1a487059321c3d6">num_glyphs</a>; n++ )
<a name="l00631"></a>00631     {
<a name="l00632"></a>00632       <span class="keywordflow">if</span> ( cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a47a0be8fcc4abce3751656a4f08c3f77">charset</a>.<a class="code" href="struct_c_f_f___charset_rec__.html#a1a8b95d80a18ebb7b02b2ab3aaa672e7">sids</a>[n] == glyph_sid )
<a name="l00633"></a>00633         <span class="keywordflow">return</span> <a class="code" href="jsonmain_8cpp.html#a4eacae1d9e7c39f8236bb36d4ececa77">n</a>;
<a name="l00634"></a>00634     }
<a name="l00635"></a>00635 
<a name="l00636"></a>00636     <span class="keywordflow">return</span> -1;
<a name="l00637"></a>00637   }
<a name="l00638"></a>00638 
<a name="l00639"></a>00639 
<a name="l00640"></a>00640   <span class="keyword">static</span> <a class="code" href="fttypes_8h.html#a64c8060bdb3d6eec844a1bf670e06bdd">FT_Error</a>
<a name="l00641"></a>00641   cff_get_glyph_data( <a class="code" href="struct_t_t___face_rec__.html">TT_Face</a>    face,
<a name="l00642"></a>00642                       <a class="code" href="fttypes_8h.html#abcb8db4dbf35d2b55a9e8c7b0926dc52">FT_UInt</a>    glyph_index,
<a name="l00643"></a>00643                       <a class="code" href="fttypes_8h.html#a51f26183ca0c9f4af958939648caeccd">FT_Byte</a>**  pointer,
<a name="l00644"></a>00644                       <a class="code" href="fttypes_8h.html#a4fac88bdba78eb76b505efa6e4fbf3f5">FT_ULong</a>*  length )
<a name="l00645"></a>00645   {
<a name="l00646"></a>00646 <span class="preprocessor">#ifdef FT_CONFIG_OPTION_INCREMENTAL</span>
<a name="l00647"></a>00647 <span class="preprocessor"></span>    <span class="comment">/* For incremental fonts get the character data using the */</span>
<a name="l00648"></a>00648     <span class="comment">/* callback function.                                     */</span>
<a name="l00649"></a>00649     <span class="keywordflow">if</span> ( face-&gt;<a class="code" href="struct_t_t___face_rec__.html#ab07a1f6ce2cffe73a5501fb33164ae74">root</a>.<a class="code" href="struct_f_t___face_rec__.html#aed9a1267cddcbe790f0591471c886537">internal</a>-&gt;incremental_interface )
<a name="l00650"></a>00650     {
<a name="l00651"></a>00651       <a class="code" href="struct_f_t___data__.html">FT_Data</a>   data;
<a name="l00652"></a>00652       <a class="code" href="fttypes_8h.html#a64c8060bdb3d6eec844a1bf670e06bdd">FT_Error</a>  error =
<a name="l00653"></a>00653                   face-&gt;<a class="code" href="struct_t_t___face_rec__.html#ab07a1f6ce2cffe73a5501fb33164ae74">root</a>.<a class="code" href="struct_f_t___face_rec__.html#aed9a1267cddcbe790f0591471c886537">internal</a>-&gt;incremental_interface-&gt;funcs-&gt;get_glyph_data(
<a name="l00654"></a>00654                     face-&gt;<a class="code" href="struct_t_t___face_rec__.html#ab07a1f6ce2cffe73a5501fb33164ae74">root</a>.<a class="code" href="struct_f_t___face_rec__.html#aed9a1267cddcbe790f0591471c886537">internal</a>-&gt;incremental_interface-&gt;object,
<a name="l00655"></a>00655                     glyph_index, &amp;data );
<a name="l00656"></a>00656 
<a name="l00657"></a>00657 
<a name="l00658"></a>00658       *pointer = (<a class="code" href="fttypes_8h.html#a51f26183ca0c9f4af958939648caeccd">FT_Byte</a>*)data.<a class="code" href="struct_f_t___data__.html#a4dea731b8a256b973757e1b8f612b050">pointer</a>;
<a name="l00659"></a>00659       *length = data.<a class="code" href="struct_f_t___data__.html#af60c89dccd1852aceb0dc08675aca2fd">length</a>;
<a name="l00660"></a>00660 
<a name="l00661"></a>00661       <span class="keywordflow">return</span> error;
<a name="l00662"></a>00662     }
<a name="l00663"></a>00663     <span class="keywordflow">else</span>
<a name="l00664"></a>00664 <span class="preprocessor">#endif </span><span class="comment">/* FT_CONFIG_OPTION_INCREMENTAL */</span>
<a name="l00665"></a>00665 
<a name="l00666"></a>00666     {
<a name="l00667"></a>00667       <a class="code" href="struct_c_f_f___font_rec__.html">CFF_Font</a>  cff  = (<a class="code" href="cfftypes_8h.html#a5e0f673b92ece4958ef2cc9b54ca4f44">CFF_Font</a>)(face-&gt;<a class="code" href="struct_t_t___face_rec__.html#ab1ffe97c9ad4f20c71069b6b9bf005ee">extra</a>.<a class="code" href="struct_f_t___generic__.html#af0bf8b983254b662f293e9a20505e27e">data</a>);
<a name="l00668"></a>00668 
<a name="l00669"></a>00669 
<a name="l00670"></a>00670       <span class="keywordflow">return</span> <a class="code" href="cffload_8c.html#aa72761974f6a023febf23adc0d67fd2b">cff_index_access_element</a>( &amp;cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a63da0015d70ca3a797ec7b551fd5476f">charstrings_index</a>, glyph_index,
<a name="l00671"></a>00671                                        pointer, length );
<a name="l00672"></a>00672     }
<a name="l00673"></a>00673   }
<a name="l00674"></a>00674 
<a name="l00675"></a>00675 
<a name="l00676"></a>00676   <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00677"></a>00677   cff_free_glyph_data( <a class="code" href="struct_t_t___face_rec__.html">TT_Face</a>    face,
<a name="l00678"></a>00678                        <a class="code" href="fttypes_8h.html#a51f26183ca0c9f4af958939648caeccd">FT_Byte</a>**  pointer,
<a name="l00679"></a>00679                        <a class="code" href="fttypes_8h.html#a4fac88bdba78eb76b505efa6e4fbf3f5">FT_ULong</a>   length )
<a name="l00680"></a>00680   {
<a name="l00681"></a>00681 <span class="preprocessor">#ifndef FT_CONFIG_OPTION_INCREMENTAL</span>
<a name="l00682"></a>00682 <span class="preprocessor"></span>    <a class="code" href="ftconfig_8h.html#a4db62b7638f149986cdc24d0c03e062f">FT_UNUSED</a>( length );
<a name="l00683"></a>00683 <span class="preprocessor">#endif</span>
<a name="l00684"></a>00684 <span class="preprocessor"></span>
<a name="l00685"></a>00685 <span class="preprocessor">#ifdef FT_CONFIG_OPTION_INCREMENTAL</span>
<a name="l00686"></a>00686 <span class="preprocessor"></span>    <span class="comment">/* For incremental fonts get the character data using the */</span>
<a name="l00687"></a>00687     <span class="comment">/* callback function.                                     */</span>
<a name="l00688"></a>00688     <span class="keywordflow">if</span> ( face-&gt;<a class="code" href="struct_t_t___face_rec__.html#ab07a1f6ce2cffe73a5501fb33164ae74">root</a>.<a class="code" href="struct_f_t___face_rec__.html#aed9a1267cddcbe790f0591471c886537">internal</a>-&gt;incremental_interface )
<a name="l00689"></a>00689     {
<a name="l00690"></a>00690       <a class="code" href="struct_f_t___data__.html">FT_Data</a> data;
<a name="l00691"></a>00691 
<a name="l00692"></a>00692 
<a name="l00693"></a>00693       data.<a class="code" href="struct_f_t___data__.html#a4dea731b8a256b973757e1b8f612b050">pointer</a> = *pointer;
<a name="l00694"></a>00694       data.<a class="code" href="struct_f_t___data__.html#af60c89dccd1852aceb0dc08675aca2fd">length</a>  = length;
<a name="l00695"></a>00695 
<a name="l00696"></a>00696       face-&gt;<a class="code" href="struct_t_t___face_rec__.html#ab07a1f6ce2cffe73a5501fb33164ae74">root</a>.<a class="code" href="struct_f_t___face_rec__.html#aed9a1267cddcbe790f0591471c886537">internal</a>-&gt;incremental_interface-&gt;funcs-&gt;free_glyph_data(
<a name="l00697"></a>00697         face-&gt;<a class="code" href="struct_t_t___face_rec__.html#ab07a1f6ce2cffe73a5501fb33164ae74">root</a>.<a class="code" href="struct_f_t___face_rec__.html#aed9a1267cddcbe790f0591471c886537">internal</a>-&gt;incremental_interface-&gt;object, &amp;data );
<a name="l00698"></a>00698     }
<a name="l00699"></a>00699     <span class="keywordflow">else</span>
<a name="l00700"></a>00700 <span class="preprocessor">#endif </span><span class="comment">/* FT_CONFIG_OPTION_INCREMENTAL */</span>
<a name="l00701"></a>00701 
<a name="l00702"></a>00702     {
<a name="l00703"></a>00703       <a class="code" href="struct_c_f_f___font_rec__.html">CFF_Font</a>  cff = (<a class="code" href="cfftypes_8h.html#a5e0f673b92ece4958ef2cc9b54ca4f44">CFF_Font</a>)(face-&gt;<a class="code" href="struct_t_t___face_rec__.html#ab1ffe97c9ad4f20c71069b6b9bf005ee">extra</a>.<a class="code" href="struct_f_t___generic__.html#af0bf8b983254b662f293e9a20505e27e">data</a>);
<a name="l00704"></a>00704 
<a name="l00705"></a>00705 
<a name="l00706"></a>00706       <a class="code" href="cffload_8c.html#a39f06ef674341191baa5140af7ca0d68">cff_index_forget_element</a>( &amp;cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a63da0015d70ca3a797ec7b551fd5476f">charstrings_index</a>, pointer );
<a name="l00707"></a>00707     }
<a name="l00708"></a>00708   }
<a name="l00709"></a>00709 
<a name="l00710"></a>00710 
<a name="l00711"></a>00711   <span class="keyword">static</span> <a class="code" href="fttypes_8h.html#a64c8060bdb3d6eec844a1bf670e06bdd">FT_Error</a>
<a name="l00712"></a>00712   cff_operator_seac( <a class="code" href="struct_c_f_f___decoder__.html">CFF_Decoder</a>*  decoder,
<a name="l00713"></a>00713                      <a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>        asb,
<a name="l00714"></a>00714                      <a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>        adx,
<a name="l00715"></a>00715                      <a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>        ady,
<a name="l00716"></a>00716                      <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>        bchar,
<a name="l00717"></a>00717                      <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>        achar )
<a name="l00718"></a>00718   {
<a name="l00719"></a>00719     <a class="code" href="fttypes_8h.html#a64c8060bdb3d6eec844a1bf670e06bdd">FT_Error</a>      error;
<a name="l00720"></a>00720     <a class="code" href="struct_c_f_f___builder__.html">CFF_Builder</a>*  builder = &amp;decoder-&gt;<a class="code" href="struct_c_f_f___decoder__.html#a1974266e7e164100b88c75fc05a15303">builder</a>;
<a name="l00721"></a>00721     <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>        bchar_index, achar_index;
<a name="l00722"></a>00722     <a class="code" href="struct_t_t___face_rec__.html">TT_Face</a>       face = decoder-&gt;<a class="code" href="struct_c_f_f___decoder__.html#a1974266e7e164100b88c75fc05a15303">builder</a>.<a class="code" href="struct_c_f_f___builder__.html#a415e44897a8329823ff2cea2990d8935">face</a>;
<a name="l00723"></a>00723     <a class="code" href="struct_f_t___vector__.html">FT_Vector</a>     left_bearing, advance;
<a name="l00724"></a>00724     <a class="code" href="fttypes_8h.html#a51f26183ca0c9f4af958939648caeccd">FT_Byte</a>*      charstring;
<a name="l00725"></a>00725     <a class="code" href="fttypes_8h.html#a4fac88bdba78eb76b505efa6e4fbf3f5">FT_ULong</a>      charstring_len;
<a name="l00726"></a>00726     <a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>        glyph_width;
<a name="l00727"></a>00727 
<a name="l00728"></a>00728 
<a name="l00729"></a>00729     <span class="keywordflow">if</span> ( decoder-&gt;<a class="code" href="struct_c_f_f___decoder__.html#a51dad91cd321e76a470fe3fe6566b67f">seac</a> )
<a name="l00730"></a>00730     {
<a name="l00731"></a>00731       <a class="code" href="ftdebug_8h.html#a311092b5a8fece0a17cfb5b2d874e25d">FT_ERROR</a>(( <span class="stringliteral">&quot;cff_operator_seac: invalid nested seac\n&quot;</span> ));
<a name="l00732"></a>00732       <span class="keywordflow">return</span> CFF_Err_Syntax_Error;
<a name="l00733"></a>00733     }
<a name="l00734"></a>00734 
<a name="l00735"></a>00735     adx += decoder-&gt;<a class="code" href="struct_c_f_f___decoder__.html#a1974266e7e164100b88c75fc05a15303">builder</a>.<a class="code" href="struct_c_f_f___builder__.html#a1bee78d88325239036b57761fdd0423c">left_bearing</a>.<a class="code" href="struct_f_t___vector__.html#a941e818e6dfca06409cddff4f325f74c">x</a>;
<a name="l00736"></a>00736     ady += decoder-&gt;<a class="code" href="struct_c_f_f___decoder__.html#a1974266e7e164100b88c75fc05a15303">builder</a>.<a class="code" href="struct_c_f_f___builder__.html#a1bee78d88325239036b57761fdd0423c">left_bearing</a>.<a class="code" href="struct_f_t___vector__.html#ac3246ed214e880047ec74eeb15f8b973">y</a>;
<a name="l00737"></a>00737 
<a name="l00738"></a>00738 <span class="preprocessor">#ifdef FT_CONFIG_OPTION_INCREMENTAL</span>
<a name="l00739"></a>00739 <span class="preprocessor"></span>    <span class="comment">/* Incremental fonts don&#39;t necessarily have valid charsets.        */</span>
<a name="l00740"></a>00740     <span class="comment">/* They use the character code, not the glyph index, in this case. */</span>
<a name="l00741"></a>00741     <span class="keywordflow">if</span> ( face-&gt;<a class="code" href="struct_t_t___face_rec__.html#ab07a1f6ce2cffe73a5501fb33164ae74">root</a>.<a class="code" href="struct_f_t___face_rec__.html#aed9a1267cddcbe790f0591471c886537">internal</a>-&gt;incremental_interface )
<a name="l00742"></a>00742     {
<a name="l00743"></a>00743       bchar_index = bchar;
<a name="l00744"></a>00744       achar_index = achar;
<a name="l00745"></a>00745     }
<a name="l00746"></a>00746     <span class="keywordflow">else</span>
<a name="l00747"></a>00747 <span class="preprocessor">#endif </span><span class="comment">/* FT_CONFIG_OPTION_INCREMENTAL */</span>
<a name="l00748"></a>00748     {
<a name="l00749"></a>00749       <a class="code" href="struct_c_f_f___font_rec__.html">CFF_Font</a> cff = (<a class="code" href="cfftypes_8h.html#a5e0f673b92ece4958ef2cc9b54ca4f44">CFF_Font</a>)(face-&gt;<a class="code" href="struct_t_t___face_rec__.html#ab1ffe97c9ad4f20c71069b6b9bf005ee">extra</a>.<a class="code" href="struct_f_t___generic__.html#af0bf8b983254b662f293e9a20505e27e">data</a>);
<a name="l00750"></a>00750 
<a name="l00751"></a>00751 
<a name="l00752"></a>00752       bchar_index = cff_lookup_glyph_by_stdcharcode( cff, bchar );
<a name="l00753"></a>00753       achar_index = cff_lookup_glyph_by_stdcharcode( cff, achar );
<a name="l00754"></a>00754     }
<a name="l00755"></a>00755 
<a name="l00756"></a>00756     <span class="keywordflow">if</span> ( bchar_index &lt; 0 || achar_index &lt; 0 )
<a name="l00757"></a>00757     {
<a name="l00758"></a>00758       <a class="code" href="ftdebug_8h.html#a311092b5a8fece0a17cfb5b2d874e25d">FT_ERROR</a>(( <span class="stringliteral">&quot;cff_operator_seac:&quot;</span>
<a name="l00759"></a>00759                  <span class="stringliteral">&quot; invalid seac character code arguments\n&quot;</span> ));
<a name="l00760"></a>00760       <span class="keywordflow">return</span> CFF_Err_Syntax_Error;
<a name="l00761"></a>00761     }
<a name="l00762"></a>00762 
<a name="l00763"></a>00763     <span class="comment">/* If we are trying to load a composite glyph, do not load the */</span>
<a name="l00764"></a>00764     <span class="comment">/* accent character and return the array of subglyphs.         */</span>
<a name="l00765"></a>00765     <span class="keywordflow">if</span> ( builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#af2637a092e49c57e69a414a79f777743">no_recurse</a> )
<a name="l00766"></a>00766     {
<a name="l00767"></a>00767       <a class="code" href="struct_f_t___glyph_slot_rec__.html">FT_GlyphSlot</a>    glyph  = (<a class="code" href="freetype_8h.html#a768daa0d9c3fa499e6c37034ee9f2ca3">FT_GlyphSlot</a>)builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a527ba659637b4e50be221d8b00d337c8">glyph</a>;
<a name="l00768"></a>00768       <a class="code" href="ftgloadr_8h.html#a2671bcb107327e81037ea42332454741">FT_GlyphLoader</a>  loader = glyph-&gt;<a class="code" href="struct_f_t___glyph_slot_rec__.html#a91731fd527eeab1d1acf3e1aea4bea84">internal</a>-&gt;<a class="code" href="struct_f_t___slot___internal_rec__.html#ac57f8c939f667938ab9f986088c15d8f">loader</a>;
<a name="l00769"></a>00769       <a class="code" href="struct_f_t___sub_glyph_rec__.html">FT_SubGlyph</a>     subg;
<a name="l00770"></a>00770 
<a name="l00771"></a>00771 
<a name="l00772"></a>00772       <span class="comment">/* reallocate subglyph array if necessary */</span>
<a name="l00773"></a>00773       error = <a class="code" href="ftgloadr_8h.html#af54f34fd85b3c880b33635dc4d8e8963">FT_GlyphLoader_CheckSubGlyphs</a>( loader, 2 );
<a name="l00774"></a>00774       <span class="keywordflow">if</span> ( error )
<a name="l00775"></a>00775         <span class="keywordflow">goto</span> Exit;
<a name="l00776"></a>00776 
<a name="l00777"></a>00777       subg = loader-&gt;current.subglyphs;
<a name="l00778"></a>00778 
<a name="l00779"></a>00779       <span class="comment">/* subglyph 0 = base character */</span>
<a name="l00780"></a>00780       subg-&gt;index = bchar_index;
<a name="l00781"></a>00781       subg-&gt;flags = <a class="code" href="freetype_8h.html#ab609fa06b6f57fff7bde18f6ad9a227e">FT_SUBGLYPH_FLAG_ARGS_ARE_XY_VALUES</a> |
<a name="l00782"></a>00782                     <a class="code" href="freetype_8h.html#a6b205cfbdb60c347f9ed7ac54b530cb6">FT_SUBGLYPH_FLAG_USE_MY_METRICS</a>;
<a name="l00783"></a>00783       subg-&gt;arg1  = 0;
<a name="l00784"></a>00784       subg-&gt;arg2  = 0;
<a name="l00785"></a>00785       subg++;
<a name="l00786"></a>00786 
<a name="l00787"></a>00787       <span class="comment">/* subglyph 1 = accent character */</span>
<a name="l00788"></a>00788       subg-&gt;index = achar_index;
<a name="l00789"></a>00789       subg-&gt;flags = <a class="code" href="freetype_8h.html#ab609fa06b6f57fff7bde18f6ad9a227e">FT_SUBGLYPH_FLAG_ARGS_ARE_XY_VALUES</a>;
<a name="l00790"></a>00790       subg-&gt;arg1  = (<a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>)( adx &gt;&gt; 16 );
<a name="l00791"></a>00791       subg-&gt;arg2  = (<a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>)( ady &gt;&gt; 16 );
<a name="l00792"></a>00792 
<a name="l00793"></a>00793       <span class="comment">/* set up remaining glyph fields */</span>
<a name="l00794"></a>00794       glyph-&gt;<a class="code" href="struct_f_t___glyph_slot_rec__.html#a5753b48d7165b08f106de3ad7c12bdd7">num_subglyphs</a> = 2;
<a name="l00795"></a>00795       glyph-&gt;<a class="code" href="struct_f_t___glyph_slot_rec__.html#a295f5a3108399c4c0703e6ee2f88cc67">subglyphs</a>     = loader-&gt;base.subglyphs;
<a name="l00796"></a>00796       glyph-&gt;<a class="code" href="struct_f_t___glyph_slot_rec__.html#afcd35188ff4c3d5cbb518602d05b2807">format</a>        = FT_GLYPH_FORMAT_COMPOSITE;
<a name="l00797"></a>00797 
<a name="l00798"></a>00798       loader-&gt;current.num_subglyphs = 2;
<a name="l00799"></a>00799     }
<a name="l00800"></a>00800 
<a name="l00801"></a>00801     <a class="code" href="ftgloadr_8h.html#a8b24efd8846b09cfecb3534926d95931">FT_GlyphLoader_Prepare</a>( builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a358be6966e4199e54d5551f81f496a5b">loader</a> );
<a name="l00802"></a>00802 
<a name="l00803"></a>00803     <span class="comment">/* First load `bchar&#39; in builder */</span>
<a name="l00804"></a>00804     error = cff_get_glyph_data( face, bchar_index,
<a name="l00805"></a>00805                                 &amp;charstring, &amp;charstring_len );
<a name="l00806"></a>00806     <span class="keywordflow">if</span> ( !error )
<a name="l00807"></a>00807     {
<a name="l00808"></a>00808       <span class="comment">/* the seac operator must not be nested */</span>
<a name="l00809"></a>00809       decoder-&gt;<a class="code" href="struct_c_f_f___decoder__.html#a51dad91cd321e76a470fe3fe6566b67f">seac</a> = <a class="code" href="ftobjs_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00810"></a>00810       error = <a class="code" href="cffgload_8c.html#a04ab294b7e8ed9309f8ac19a1485148b">cff_decoder_parse_charstrings</a>( decoder, charstring,
<a name="l00811"></a>00811                                              charstring_len );
<a name="l00812"></a>00812       decoder-&gt;<a class="code" href="struct_c_f_f___decoder__.html#a51dad91cd321e76a470fe3fe6566b67f">seac</a> = <a class="code" href="ftobjs_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00813"></a>00813 
<a name="l00814"></a>00814       cff_free_glyph_data( face, &amp;charstring, charstring_len );
<a name="l00815"></a>00815 
<a name="l00816"></a>00816       <span class="keywordflow">if</span> ( error )
<a name="l00817"></a>00817         <span class="keywordflow">goto</span> Exit;
<a name="l00818"></a>00818     }
<a name="l00819"></a>00819 
<a name="l00820"></a>00820     <span class="comment">/* Save the left bearing, advance and glyph width of the base */</span>
<a name="l00821"></a>00821     <span class="comment">/* character as they will be erased by the next load.         */</span>
<a name="l00822"></a>00822 
<a name="l00823"></a>00823     left_bearing = builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a1bee78d88325239036b57761fdd0423c">left_bearing</a>;
<a name="l00824"></a>00824     advance      = builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a943906425298bbbdc85e7a6d626224b5">advance</a>;
<a name="l00825"></a>00825     glyph_width  = decoder-&gt;<a class="code" href="struct_c_f_f___decoder__.html#a0d3d6ccc7097a1e256543f511d47c7e9">glyph_width</a>;
<a name="l00826"></a>00826 
<a name="l00827"></a>00827     builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a1bee78d88325239036b57761fdd0423c">left_bearing</a>.<a class="code" href="struct_f_t___vector__.html#a941e818e6dfca06409cddff4f325f74c">x</a> = 0;
<a name="l00828"></a>00828     builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a1bee78d88325239036b57761fdd0423c">left_bearing</a>.<a class="code" href="struct_f_t___vector__.html#ac3246ed214e880047ec74eeb15f8b973">y</a> = 0;
<a name="l00829"></a>00829 
<a name="l00830"></a>00830     builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a045d91695d51a1fbfa307aab507fa46b">pos_x</a> = adx - asb;
<a name="l00831"></a>00831     builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a50a8bec8b857853829f42195101db472">pos_y</a> = ady;
<a name="l00832"></a>00832 
<a name="l00833"></a>00833     <span class="comment">/* Now load `achar&#39; on top of the base outline. */</span>
<a name="l00834"></a>00834     error = cff_get_glyph_data( face, achar_index,
<a name="l00835"></a>00835                                 &amp;charstring, &amp;charstring_len );
<a name="l00836"></a>00836     <span class="keywordflow">if</span> ( !error )
<a name="l00837"></a>00837     {
<a name="l00838"></a>00838       <span class="comment">/* the seac operator must not be nested */</span>
<a name="l00839"></a>00839       decoder-&gt;<a class="code" href="struct_c_f_f___decoder__.html#a51dad91cd321e76a470fe3fe6566b67f">seac</a> = <a class="code" href="ftobjs_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00840"></a>00840       error = <a class="code" href="cffgload_8c.html#a04ab294b7e8ed9309f8ac19a1485148b">cff_decoder_parse_charstrings</a>( decoder, charstring,
<a name="l00841"></a>00841                                              charstring_len );
<a name="l00842"></a>00842       decoder-&gt;<a class="code" href="struct_c_f_f___decoder__.html#a51dad91cd321e76a470fe3fe6566b67f">seac</a> = <a class="code" href="ftobjs_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00843"></a>00843 
<a name="l00844"></a>00844       cff_free_glyph_data( face, &amp;charstring, charstring_len );
<a name="l00845"></a>00845 
<a name="l00846"></a>00846       <span class="keywordflow">if</span> ( error )
<a name="l00847"></a>00847         <span class="keywordflow">goto</span> Exit;
<a name="l00848"></a>00848     }
<a name="l00849"></a>00849 
<a name="l00850"></a>00850     <span class="comment">/* Restore the left side bearing, advance and glyph width */</span>
<a name="l00851"></a>00851     <span class="comment">/* of the base character.                                 */</span>
<a name="l00852"></a>00852     builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a1bee78d88325239036b57761fdd0423c">left_bearing</a> = left_bearing;
<a name="l00853"></a>00853     builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a943906425298bbbdc85e7a6d626224b5">advance</a>      = advance;
<a name="l00854"></a>00854     decoder-&gt;<a class="code" href="struct_c_f_f___decoder__.html#a0d3d6ccc7097a1e256543f511d47c7e9">glyph_width</a>  = glyph_width;
<a name="l00855"></a>00855 
<a name="l00856"></a>00856     builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a045d91695d51a1fbfa307aab507fa46b">pos_x</a> = 0;
<a name="l00857"></a>00857     builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a50a8bec8b857853829f42195101db472">pos_y</a> = 0;
<a name="l00858"></a>00858 
<a name="l00859"></a>00859   Exit:
<a name="l00860"></a>00860     <span class="keywordflow">return</span> error;
<a name="l00861"></a>00861   }
<a name="l00862"></a>00862 
<a name="l00863"></a>00863 
<a name="l00864"></a>00864   <span class="comment">/*************************************************************************/</span>
<a name="l00865"></a>00865   <span class="comment">/*                                                                       */</span>
<a name="l00866"></a>00866   <span class="comment">/* &lt;Function&gt;                                                            */</span>
<a name="l00867"></a>00867   <span class="comment">/*    cff_decoder_parse_charstrings                                      */</span>
<a name="l00868"></a>00868   <span class="comment">/*                                                                       */</span>
<a name="l00869"></a>00869   <span class="comment">/* &lt;Description&gt;                                                         */</span>
<a name="l00870"></a>00870   <span class="comment">/*    Parses a given Type 2 charstrings program.                         */</span>
<a name="l00871"></a>00871   <span class="comment">/*                                                                       */</span>
<a name="l00872"></a>00872   <span class="comment">/* &lt;InOut&gt;                                                               */</span>
<a name="l00873"></a>00873   <span class="comment">/*    decoder         :: The current Type 1 decoder.                     */</span>
<a name="l00874"></a>00874   <span class="comment">/*                                                                       */</span>
<a name="l00875"></a>00875   <span class="comment">/* &lt;Input&gt;                                                               */</span>
<a name="l00876"></a>00876   <span class="comment">/*    charstring_base :: The base of the charstring stream.              */</span>
<a name="l00877"></a>00877   <span class="comment">/*                                                                       */</span>
<a name="l00878"></a>00878   <span class="comment">/*    charstring_len  :: The length in bytes of the charstring stream.   */</span>
<a name="l00879"></a>00879   <span class="comment">/*                                                                       */</span>
<a name="l00880"></a>00880   <span class="comment">/* &lt;Return&gt;                                                              */</span>
<a name="l00881"></a>00881   <span class="comment">/*    FreeType error code.  0 means success.                             */</span>
<a name="l00882"></a>00882   <span class="comment">/*                                                                       */</span>
<a name="l00883"></a>00883   <a class="code" href="ftconfig_8h.html#a065cda933183dff5dc368794eefa7c93">FT_LOCAL_DEF</a>( <a class="code" href="fttypes_8h.html#a64c8060bdb3d6eec844a1bf670e06bdd">FT_Error</a> )
<a name="l00884"></a><a class="code" href="cffgload_8h.html#a04ab294b7e8ed9309f8ac19a1485148b">00884</a>   <a class="code" href="cffgload_8c.html#a04ab294b7e8ed9309f8ac19a1485148b">cff_decoder_parse_charstrings</a>( <a class="code" href="struct_c_f_f___decoder__.html">CFF_Decoder</a>*  decoder,
<a name="l00885"></a>00885                                  <a class="code" href="fttypes_8h.html#a51f26183ca0c9f4af958939648caeccd">FT_Byte</a>*      charstring_base,
<a name="l00886"></a>00886                                  <a class="code" href="fttypes_8h.html#a4fac88bdba78eb76b505efa6e4fbf3f5">FT_ULong</a>      charstring_len )
<a name="l00887"></a>00887   {
<a name="l00888"></a>00888     <a class="code" href="fttypes_8h.html#a64c8060bdb3d6eec844a1bf670e06bdd">FT_Error</a>           error;
<a name="l00889"></a>00889     <a class="code" href="struct_c_f_f___decoder___zone__.html">CFF_Decoder_Zone</a>*  zone;
<a name="l00890"></a>00890     <a class="code" href="fttypes_8h.html#a51f26183ca0c9f4af958939648caeccd">FT_Byte</a>*           ip;
<a name="l00891"></a>00891     <a class="code" href="fttypes_8h.html#a51f26183ca0c9f4af958939648caeccd">FT_Byte</a>*           limit;
<a name="l00892"></a>00892     <a class="code" href="struct_c_f_f___builder__.html">CFF_Builder</a>*       builder = &amp;decoder-&gt;builder;
<a name="l00893"></a>00893     <a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>             x, y;
<a name="l00894"></a>00894     <a class="code" href="fttypes_8h.html#a5f5a679cc09f758efdd0d1c5feed3c3d">FT_Fixed</a>           seed;
<a name="l00895"></a>00895     <a class="code" href="fttypes_8h.html#a5f5a679cc09f758efdd0d1c5feed3c3d">FT_Fixed</a>*          stack;
<a name="l00896"></a>00896     <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>             charstring_type =
<a name="l00897"></a>00897                          decoder-&gt;cff-&gt;top_font.font_dict.charstring_type;
<a name="l00898"></a>00898 
<a name="l00899"></a>00899     <a class="code" href="struct_t2___hints___funcs_rec__.html">T2_Hints_Funcs</a>     hinter;
<a name="l00900"></a>00900 
<a name="l00901"></a>00901 
<a name="l00902"></a>00902     <span class="comment">/* set default width */</span>
<a name="l00903"></a>00903     decoder-&gt;num_hints  = 0;
<a name="l00904"></a>00904     decoder-&gt;read_width = 1;
<a name="l00905"></a>00905 
<a name="l00906"></a>00906     <span class="comment">/* compute random seed from stack address of parameter */</span>
<a name="l00907"></a>00907     seed = (<a class="code" href="fttypes_8h.html#a5f5a679cc09f758efdd0d1c5feed3c3d">FT_Fixed</a>)( ( (<a class="code" href="fttypes_8h.html#a2469cb02129d36e468be22f7a8bf5b33">FT_PtrDist</a>)(<span class="keywordtype">char</span>*)&amp;seed              ^
<a name="l00908"></a>00908                          (<a class="code" href="fttypes_8h.html#a2469cb02129d36e468be22f7a8bf5b33">FT_PtrDist</a>)(<span class="keywordtype">char</span>*)&amp;decoder           ^
<a name="l00909"></a>00909                          (<a class="code" href="fttypes_8h.html#a2469cb02129d36e468be22f7a8bf5b33">FT_PtrDist</a>)(<span class="keywordtype">char</span>*)&amp;charstring_base ) &amp;
<a name="l00910"></a>00910                          <a class="code" href="ftstdlib_8h.html#ad00221e79d65c837db57262e97458eee">FT_ULONG_MAX</a> ) ;
<a name="l00911"></a>00911     seed = ( seed ^ ( seed &gt;&gt; 10 ) ^ ( seed &gt;&gt; 20 ) ) &amp; 0xFFFFL;
<a name="l00912"></a>00912     <span class="keywordflow">if</span> ( seed == 0 )
<a name="l00913"></a>00913       seed = 0x7384;
<a name="l00914"></a>00914 
<a name="l00915"></a>00915     <span class="comment">/* initialize the decoder */</span>
<a name="l00916"></a>00916     decoder-&gt;top  = decoder-&gt;stack;
<a name="l00917"></a>00917     decoder-&gt;zone = decoder-&gt;zones;
<a name="l00918"></a>00918     zone          = decoder-&gt;zones;
<a name="l00919"></a>00919     stack         = decoder-&gt;top;
<a name="l00920"></a>00920 
<a name="l00921"></a>00921     hinter = (<a class="code" href="pshints_8h.html#a47583fd4c43e3b13516dd71b4e51f15b">T2_Hints_Funcs</a>)builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a7eb0d9144e82e76d6fe4fbd03b678c69">hints_funcs</a>;
<a name="l00922"></a>00922 
<a name="l00923"></a>00923     builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#ac8770a979f76c1dc11575dfdf40f1f88">path_begun</a> = 0;
<a name="l00924"></a>00924 
<a name="l00925"></a>00925     zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#adffd8270fea17f125a1615d7a6cc09c2">base</a>           = charstring_base;
<a name="l00926"></a>00926     limit = zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#ad3e3efa2e2b7dd69292757fbf7e63e53">limit</a>  = charstring_base + charstring_len;
<a name="l00927"></a>00927     ip    = zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#a5ac12c9c151964cee76b5b11e5c22453">cursor</a> = zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#adffd8270fea17f125a1615d7a6cc09c2">base</a>;
<a name="l00928"></a>00928 
<a name="l00929"></a>00929     error = CFF_Err_Ok;
<a name="l00930"></a>00930 
<a name="l00931"></a>00931     x = builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a045d91695d51a1fbfa307aab507fa46b">pos_x</a>;
<a name="l00932"></a>00932     y = builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a50a8bec8b857853829f42195101db472">pos_y</a>;
<a name="l00933"></a>00933 
<a name="l00934"></a>00934     <span class="comment">/* begin hints recording session, if any */</span>
<a name="l00935"></a>00935     if ( hinter )
<a name="l00936"></a>00936       hinter-&gt;<a class="code" href="struct_t2___hints___funcs_rec__.html#a1a5e0b296ee2e2ae6711b3ee35e5fcd9">open</a>( hinter-&gt;<a class="code" href="struct_t2___hints___funcs_rec__.html#af8daab694889bede5a513fbae5f86e25">hints</a> );
<a name="l00937"></a>00937 
<a name="l00938"></a>00938     <span class="comment">/* now execute loop */</span>
<a name="l00939"></a>00939     <span class="keywordflow">while</span> ( ip &lt; limit )
<a name="l00940"></a>00940     {
<a name="l00941"></a>00941       <a class="code" href="cffgload_8c.html#aec8587f065b7ee6610fd8fc7d2acf080">CFF_Operator</a>  op;
<a name="l00942"></a>00942       <a class="code" href="fttypes_8h.html#a51f26183ca0c9f4af958939648caeccd">FT_Byte</a>       v;
<a name="l00943"></a>00943 
<a name="l00944"></a>00944 
<a name="l00945"></a>00945       <span class="comment">/********************************************************************/</span>
<a name="l00946"></a>00946       <span class="comment">/*                                                                  */</span>
<a name="l00947"></a>00947       <span class="comment">/* Decode operator or operand                                       */</span>
<a name="l00948"></a>00948       <span class="comment">/*                                                                  */</span>
<a name="l00949"></a>00949       v = *ip++;
<a name="l00950"></a>00950       <span class="keywordflow">if</span> ( v &gt;= 32 || v == 28 )
<a name="l00951"></a>00951       {
<a name="l00952"></a>00952         <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>    shift = 16;
<a name="l00953"></a>00953         FT_Int32  val;
<a name="l00954"></a>00954 
<a name="l00955"></a>00955 
<a name="l00956"></a>00956         <span class="comment">/* this is an operand, push it on the stack */</span>
<a name="l00957"></a>00957         <span class="keywordflow">if</span> ( v == 28 )
<a name="l00958"></a>00958         {
<a name="l00959"></a>00959           <span class="keywordflow">if</span> ( ip + 1 &gt;= limit )
<a name="l00960"></a>00960             <span class="keywordflow">goto</span> Syntax_Error;
<a name="l00961"></a>00961           val = (<a class="code" href="fttypes_8h.html#aa7279be89046a2563cd3d4d6651fbdcf">FT_Short</a>)( ( (<a class="code" href="fttypes_8h.html#aa7279be89046a2563cd3d4d6651fbdcf">FT_Short</a>)ip[0] &lt;&lt; 8 ) | ip[1] );
<a name="l00962"></a>00962           ip += 2;
<a name="l00963"></a>00963         }
<a name="l00964"></a>00964         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( v &lt; 247 )
<a name="l00965"></a>00965           val = (FT_Int32)v - 139;
<a name="l00966"></a>00966         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( v &lt; 251 )
<a name="l00967"></a>00967         {
<a name="l00968"></a>00968           <span class="keywordflow">if</span> ( ip &gt;= limit )
<a name="l00969"></a>00969             <span class="keywordflow">goto</span> Syntax_Error;
<a name="l00970"></a>00970           val = ( (FT_Int32)v - 247 ) * 256 + *ip++ + 108;
<a name="l00971"></a>00971         }
<a name="l00972"></a>00972         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( v &lt; 255 )
<a name="l00973"></a>00973         {
<a name="l00974"></a>00974           <span class="keywordflow">if</span> ( ip &gt;= limit )
<a name="l00975"></a>00975             <span class="keywordflow">goto</span> Syntax_Error;
<a name="l00976"></a>00976           val = -( (FT_Int32)v - 251 ) * 256 - *ip++ - 108;
<a name="l00977"></a>00977         }
<a name="l00978"></a>00978         <span class="keywordflow">else</span>
<a name="l00979"></a>00979         {
<a name="l00980"></a>00980           <span class="keywordflow">if</span> ( ip + 3 &gt;= limit )
<a name="l00981"></a>00981             <span class="keywordflow">goto</span> Syntax_Error;
<a name="l00982"></a>00982           val = ( (FT_Int32)ip[0] &lt;&lt; 24 ) |
<a name="l00983"></a>00983                 ( (FT_Int32)ip[1] &lt;&lt; 16 ) |
<a name="l00984"></a>00984                 ( (FT_Int32)ip[2] &lt;&lt;  8 ) |
<a name="l00985"></a>00985                             ip[3];
<a name="l00986"></a>00986           ip    += 4;
<a name="l00987"></a>00987           <span class="keywordflow">if</span> ( charstring_type == 2 )
<a name="l00988"></a>00988             shift = 0;
<a name="l00989"></a>00989         }
<a name="l00990"></a>00990         <span class="keywordflow">if</span> ( decoder-&gt;top - stack &gt;= <a class="code" href="cffgload_8h.html#a367507992a6ffd2188b3e6b257884855">CFF_MAX_OPERANDS</a> )
<a name="l00991"></a>00991           <span class="keywordflow">goto</span> Stack_Overflow;
<a name="l00992"></a>00992 
<a name="l00993"></a>00993         val           &lt;&lt;= shift;
<a name="l00994"></a>00994         *decoder-&gt;top++ = val;
<a name="l00995"></a>00995 
<a name="l00996"></a>00996 <span class="preprocessor">#ifdef FT_DEBUG_LEVEL_TRACE</span>
<a name="l00997"></a>00997 <span class="preprocessor"></span>        <span class="keywordflow">if</span> ( !( val &amp; 0xFFFFL ) )
<a name="l00998"></a>00998           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; %ld&quot;</span>, (FT_Int32)( val &gt;&gt; 16 ) ));
<a name="l00999"></a>00999         <span class="keywordflow">else</span>
<a name="l01000"></a>01000           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; %.2f&quot;</span>, val / 65536.0 ));
<a name="l01001"></a>01001 <span class="preprocessor">#endif</span>
<a name="l01002"></a>01002 <span class="preprocessor"></span>
<a name="l01003"></a>01003       }
<a name="l01004"></a>01004       <span class="keywordflow">else</span>
<a name="l01005"></a>01005       {
<a name="l01006"></a>01006         <span class="comment">/* The specification says that normally arguments are to be taken */</span>
<a name="l01007"></a>01007         <span class="comment">/* from the bottom of the stack.  However, this seems not to be   */</span>
<a name="l01008"></a>01008         <span class="comment">/* correct, at least for Acroread 7.0.8 on GNU/Linux: It pops the */</span>
<a name="l01009"></a>01009         <span class="comment">/* arguments similar to a PS interpreter.                         */</span>
<a name="l01010"></a>01010 
<a name="l01011"></a>01011         <a class="code" href="fttypes_8h.html#a5f5a679cc09f758efdd0d1c5feed3c3d">FT_Fixed</a>*  args     = decoder-&gt;top;
<a name="l01012"></a>01012         <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>     num_args = (<a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>)( args - decoder-&gt;stack );
<a name="l01013"></a>01013         <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>     req_args;
<a name="l01014"></a>01014 
<a name="l01015"></a>01015 
<a name="l01016"></a>01016         <span class="comment">/* find operator */</span>
<a name="l01017"></a>01017         op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8af32c40b75ea268aaae1c240542eb738c">cff_op_unknown</a>;
<a name="l01018"></a>01018 
<a name="l01019"></a>01019         <span class="keywordflow">switch</span> ( v )
<a name="l01020"></a>01020         {
<a name="l01021"></a>01021         <span class="keywordflow">case</span> 1:
<a name="l01022"></a>01022           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a28d40d72404136482286c1660a5ade06">cff_op_hstem</a>;
<a name="l01023"></a>01023           <span class="keywordflow">break</span>;
<a name="l01024"></a>01024         <span class="keywordflow">case</span> 3:
<a name="l01025"></a>01025           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1f0969967e245931fec7d6f369cb0e6d">cff_op_vstem</a>;
<a name="l01026"></a>01026           <span class="keywordflow">break</span>;
<a name="l01027"></a>01027         <span class="keywordflow">case</span> 4:
<a name="l01028"></a>01028           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a713506a98409ebfdf759152baff23722">cff_op_vmoveto</a>;
<a name="l01029"></a>01029           <span class="keywordflow">break</span>;
<a name="l01030"></a>01030         <span class="keywordflow">case</span> 5:
<a name="l01031"></a>01031           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ab1193e6aec53b22a0189defd98d99c37">cff_op_rlineto</a>;
<a name="l01032"></a>01032           <span class="keywordflow">break</span>;
<a name="l01033"></a>01033         <span class="keywordflow">case</span> 6:
<a name="l01034"></a>01034           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ac6ccfab49de5ae2b4d9c41d7c33d2bb0">cff_op_hlineto</a>;
<a name="l01035"></a>01035           <span class="keywordflow">break</span>;
<a name="l01036"></a>01036         <span class="keywordflow">case</span> 7:
<a name="l01037"></a>01037           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a290b968a40248b5cb4070b89ccb85005">cff_op_vlineto</a>;
<a name="l01038"></a>01038           <span class="keywordflow">break</span>;
<a name="l01039"></a>01039         <span class="keywordflow">case</span> 8:
<a name="l01040"></a>01040           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8add4fe42409b24680e84c6f0b541448aa">cff_op_rrcurveto</a>;
<a name="l01041"></a>01041           <span class="keywordflow">break</span>;
<a name="l01042"></a>01042         <span class="keywordflow">case</span> 9:
<a name="l01043"></a>01043           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ae5d8351117021456094b6adec66e9730">cff_op_closepath</a>;
<a name="l01044"></a>01044           <span class="keywordflow">break</span>;
<a name="l01045"></a>01045         <span class="keywordflow">case</span> 10:
<a name="l01046"></a>01046           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a96b69ad3ec477d065eb9aea0289ca594">cff_op_callsubr</a>;
<a name="l01047"></a>01047           <span class="keywordflow">break</span>;
<a name="l01048"></a>01048         <span class="keywordflow">case</span> 11:
<a name="l01049"></a>01049           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8aef3f2f049d5593f2fd6db5c34a3d3937">cff_op_return</a>;
<a name="l01050"></a>01050           <span class="keywordflow">break</span>;
<a name="l01051"></a>01051         <span class="keywordflow">case</span> 12:
<a name="l01052"></a>01052           {
<a name="l01053"></a>01053             <span class="keywordflow">if</span> ( ip &gt;= limit )
<a name="l01054"></a>01054               <span class="keywordflow">goto</span> Syntax_Error;
<a name="l01055"></a>01055             v = *ip++;
<a name="l01056"></a>01056 
<a name="l01057"></a>01057             <span class="keywordflow">switch</span> ( v )
<a name="l01058"></a>01058             {
<a name="l01059"></a>01059             <span class="keywordflow">case</span> 0:
<a name="l01060"></a>01060               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a8cfe096ad9274b8435468f9eb4a5f5e1">cff_op_dotsection</a>;
<a name="l01061"></a>01061               <span class="keywordflow">break</span>;
<a name="l01062"></a>01062             <span class="keywordflow">case</span> 1: <span class="comment">/* this is actually the Type1 vstem3 operator */</span>
<a name="l01063"></a>01063               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1f0969967e245931fec7d6f369cb0e6d">cff_op_vstem</a>;
<a name="l01064"></a>01064               <span class="keywordflow">break</span>;
<a name="l01065"></a>01065             <span class="keywordflow">case</span> 2: <span class="comment">/* this is actually the Type1 hstem3 operator */</span>
<a name="l01066"></a>01066               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a28d40d72404136482286c1660a5ade06">cff_op_hstem</a>;
<a name="l01067"></a>01067               <span class="keywordflow">break</span>;
<a name="l01068"></a>01068             <span class="keywordflow">case</span> 3:
<a name="l01069"></a>01069               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a198c30b3f96e38397a4f96e35287dfca">cff_op_and</a>;
<a name="l01070"></a>01070               <span class="keywordflow">break</span>;
<a name="l01071"></a>01071             <span class="keywordflow">case</span> 4:
<a name="l01072"></a>01072               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ab5e02727b9ceab6a991509dde7a68c51">cff_op_or</a>;
<a name="l01073"></a>01073               <span class="keywordflow">break</span>;
<a name="l01074"></a>01074             <span class="keywordflow">case</span> 5:
<a name="l01075"></a>01075               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8aa15f4155a179b07b63371a698fdfb71f">cff_op_not</a>;
<a name="l01076"></a>01076               <span class="keywordflow">break</span>;
<a name="l01077"></a>01077             <span class="keywordflow">case</span> 6:
<a name="l01078"></a>01078               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a6c030c34f2bcbece80975d4ed128de0f">cff_op_seac</a>;
<a name="l01079"></a>01079               <span class="keywordflow">break</span>;
<a name="l01080"></a>01080             <span class="keywordflow">case</span> 7:
<a name="l01081"></a>01081               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a8aab759e46bfd5eb4225e1a17c203224">cff_op_sbw</a>;
<a name="l01082"></a>01082               <span class="keywordflow">break</span>;
<a name="l01083"></a>01083             <span class="keywordflow">case</span> 8:
<a name="l01084"></a>01084               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1e70d07a4d1fd319ed5241e05a0d1172">cff_op_store</a>;
<a name="l01085"></a>01085               <span class="keywordflow">break</span>;
<a name="l01086"></a>01086             <span class="keywordflow">case</span> 9:
<a name="l01087"></a>01087               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a9ff7938b9c372953d0823bf22338871b">cff_op_abs</a>;
<a name="l01088"></a>01088               <span class="keywordflow">break</span>;
<a name="l01089"></a>01089             <span class="keywordflow">case</span> 10:
<a name="l01090"></a>01090               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8aea908e6d598e2d84a5d346241f85ea4a">cff_op_add</a>;
<a name="l01091"></a>01091               <span class="keywordflow">break</span>;
<a name="l01092"></a>01092             <span class="keywordflow">case</span> 11:
<a name="l01093"></a>01093               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a0d3347ca88c65693e926c70458ba4f6a">cff_op_sub</a>;
<a name="l01094"></a>01094               <span class="keywordflow">break</span>;
<a name="l01095"></a>01095             <span class="keywordflow">case</span> 12:
<a name="l01096"></a>01096               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8acfd26a81d025112fb953a199aaefbc9b">cff_op_div</a>;
<a name="l01097"></a>01097               <span class="keywordflow">break</span>;
<a name="l01098"></a>01098             <span class="keywordflow">case</span> 13:
<a name="l01099"></a>01099               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a7630954efe67155c39447c63dc776bc9">cff_op_load</a>;
<a name="l01100"></a>01100               <span class="keywordflow">break</span>;
<a name="l01101"></a>01101             <span class="keywordflow">case</span> 14:
<a name="l01102"></a>01102               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a8b889aa9c9278033059c11c101d71790">cff_op_neg</a>;
<a name="l01103"></a>01103               <span class="keywordflow">break</span>;
<a name="l01104"></a>01104             <span class="keywordflow">case</span> 15:
<a name="l01105"></a>01105               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1f4894f49b12e28c9ee89542194ce287">cff_op_eq</a>;
<a name="l01106"></a>01106               <span class="keywordflow">break</span>;
<a name="l01107"></a>01107             <span class="keywordflow">case</span> 16:
<a name="l01108"></a>01108               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a60ddfb0898b726aae8da343b41ec0e74">cff_op_callothersubr</a>;
<a name="l01109"></a>01109               <span class="keywordflow">break</span>;
<a name="l01110"></a>01110             <span class="keywordflow">case</span> 17:
<a name="l01111"></a>01111               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a5d0b67133e29eef802f38c844539f794">cff_op_pop</a>;
<a name="l01112"></a>01112               <span class="keywordflow">break</span>;
<a name="l01113"></a>01113             <span class="keywordflow">case</span> 18:
<a name="l01114"></a>01114               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a6f5422326afe716744562b30721c254f">cff_op_drop</a>;
<a name="l01115"></a>01115               <span class="keywordflow">break</span>;
<a name="l01116"></a>01116             <span class="keywordflow">case</span> 20:
<a name="l01117"></a>01117               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8aa7bced71bc9799b0bbabe7bc9d2f1159">cff_op_put</a>;
<a name="l01118"></a>01118               <span class="keywordflow">break</span>;
<a name="l01119"></a>01119             <span class="keywordflow">case</span> 21:
<a name="l01120"></a>01120               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a19906f49eeaaed1c61733f87c0d87d5b">cff_op_get</a>;
<a name="l01121"></a>01121               <span class="keywordflow">break</span>;
<a name="l01122"></a>01122             <span class="keywordflow">case</span> 22:
<a name="l01123"></a>01123               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a3dd3b124503056cb7f2dbf6c34e5303a">cff_op_ifelse</a>;
<a name="l01124"></a>01124               <span class="keywordflow">break</span>;
<a name="l01125"></a>01125             <span class="keywordflow">case</span> 23:
<a name="l01126"></a>01126               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ab9fe134cd34c62675ad21aa27165871f">cff_op_random</a>;
<a name="l01127"></a>01127               <span class="keywordflow">break</span>;
<a name="l01128"></a>01128             <span class="keywordflow">case</span> 24:
<a name="l01129"></a>01129               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8afadcf7b43479a14dfdd417327d392fe2">cff_op_mul</a>;
<a name="l01130"></a>01130               <span class="keywordflow">break</span>;
<a name="l01131"></a>01131             <span class="keywordflow">case</span> 26:
<a name="l01132"></a>01132               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ae59f88acc3553d5190e69a9576c47efd">cff_op_sqrt</a>;
<a name="l01133"></a>01133               <span class="keywordflow">break</span>;
<a name="l01134"></a>01134             <span class="keywordflow">case</span> 27:
<a name="l01135"></a>01135               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a434827ffa8cca1ace703ec938cdcf6d6">cff_op_dup</a>;
<a name="l01136"></a>01136               <span class="keywordflow">break</span>;
<a name="l01137"></a>01137             <span class="keywordflow">case</span> 28:
<a name="l01138"></a>01138               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1cab1f5bf47858793709680d3cac44e7">cff_op_exch</a>;
<a name="l01139"></a>01139               <span class="keywordflow">break</span>;
<a name="l01140"></a>01140             <span class="keywordflow">case</span> 29:
<a name="l01141"></a>01141               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a01ebd6f23e1cba4d32c1449731f797d8">cff_op_index</a>;
<a name="l01142"></a>01142               <span class="keywordflow">break</span>;
<a name="l01143"></a>01143             <span class="keywordflow">case</span> 30:
<a name="l01144"></a>01144               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8adfefa3ebc44df5105f18d96c026709f0">cff_op_roll</a>;
<a name="l01145"></a>01145               <span class="keywordflow">break</span>;
<a name="l01146"></a>01146             <span class="keywordflow">case</span> 33:
<a name="l01147"></a>01147               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a50d3d2e8ee9a7906069b92fc3c6882b0">cff_op_setcurrentpoint</a>;
<a name="l01148"></a>01148               <span class="keywordflow">break</span>;
<a name="l01149"></a>01149             <span class="keywordflow">case</span> 34:
<a name="l01150"></a>01150               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a258fdb0f1769f994880a168ea516123f">cff_op_hflex</a>;
<a name="l01151"></a>01151               <span class="keywordflow">break</span>;
<a name="l01152"></a>01152             <span class="keywordflow">case</span> 35:
<a name="l01153"></a>01153               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1de43caa6ef27d55061e0dffe752e9b6">cff_op_flex</a>;
<a name="l01154"></a>01154               <span class="keywordflow">break</span>;
<a name="l01155"></a>01155             <span class="keywordflow">case</span> 36:
<a name="l01156"></a>01156               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ac98a098a167c1f8de65f0599aeb46813">cff_op_hflex1</a>;
<a name="l01157"></a>01157               <span class="keywordflow">break</span>;
<a name="l01158"></a>01158             <span class="keywordflow">case</span> 37:
<a name="l01159"></a>01159               op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8aa23494894eec5922ad45ffcdb1eb4e52">cff_op_flex1</a>;
<a name="l01160"></a>01160               <span class="keywordflow">break</span>;
<a name="l01161"></a>01161             <span class="keywordflow">default</span>:
<a name="l01162"></a>01162               <span class="comment">/* decrement ip for syntax error message */</span>
<a name="l01163"></a>01163               ip--;
<a name="l01164"></a>01164             }
<a name="l01165"></a>01165           }
<a name="l01166"></a>01166           <span class="keywordflow">break</span>;
<a name="l01167"></a>01167         <span class="keywordflow">case</span> 13:
<a name="l01168"></a>01168           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8add265fbc35078d4e9b2fb4ff63561c0f">cff_op_hsbw</a>;
<a name="l01169"></a>01169           <span class="keywordflow">break</span>;
<a name="l01170"></a>01170         <span class="keywordflow">case</span> 14:
<a name="l01171"></a>01171           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a02654a503c7056ffe73f7e89f870e409">cff_op_endchar</a>;
<a name="l01172"></a>01172           <span class="keywordflow">break</span>;
<a name="l01173"></a>01173         <span class="keywordflow">case</span> 16:
<a name="l01174"></a>01174           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a2592dd93e88c38cc0bf897b37ec02488">cff_op_blend</a>;
<a name="l01175"></a>01175           <span class="keywordflow">break</span>;
<a name="l01176"></a>01176         <span class="keywordflow">case</span> 18:
<a name="l01177"></a>01177           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a0246b57f0ee935c12d6dfd5faacc1dec">cff_op_hstemhm</a>;
<a name="l01178"></a>01178           <span class="keywordflow">break</span>;
<a name="l01179"></a>01179         <span class="keywordflow">case</span> 19:
<a name="l01180"></a>01180           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8afeee820728e5a9e914db82085fc7f390">cff_op_hintmask</a>;
<a name="l01181"></a>01181           <span class="keywordflow">break</span>;
<a name="l01182"></a>01182         <span class="keywordflow">case</span> 20:
<a name="l01183"></a>01183           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a4a91ebecfe9b7fa4b216af356c1a4fb3">cff_op_cntrmask</a>;
<a name="l01184"></a>01184           <span class="keywordflow">break</span>;
<a name="l01185"></a>01185         <span class="keywordflow">case</span> 21:
<a name="l01186"></a>01186           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8af371af458c3decd4e1bf20dd6039ca2a">cff_op_rmoveto</a>;
<a name="l01187"></a>01187           <span class="keywordflow">break</span>;
<a name="l01188"></a>01188         <span class="keywordflow">case</span> 22:
<a name="l01189"></a>01189           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a01d4fc07f5d25d67b85546307aa4ff91">cff_op_hmoveto</a>;
<a name="l01190"></a>01190           <span class="keywordflow">break</span>;
<a name="l01191"></a>01191         <span class="keywordflow">case</span> 23:
<a name="l01192"></a>01192           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a58236915cbd4069c5d81971690487d10">cff_op_vstemhm</a>;
<a name="l01193"></a>01193           <span class="keywordflow">break</span>;
<a name="l01194"></a>01194         <span class="keywordflow">case</span> 24:
<a name="l01195"></a>01195           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a8d08fbf34700b975d4f791d2ab0347af">cff_op_rcurveline</a>;
<a name="l01196"></a>01196           <span class="keywordflow">break</span>;
<a name="l01197"></a>01197         <span class="keywordflow">case</span> 25:
<a name="l01198"></a>01198           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a24c60e306d86c0b7c62b76f2c7d6d1d2">cff_op_rlinecurve</a>;
<a name="l01199"></a>01199           <span class="keywordflow">break</span>;
<a name="l01200"></a>01200         <span class="keywordflow">case</span> 26:
<a name="l01201"></a>01201           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ae4c9ad7156108a8ec957167a3c9601b1">cff_op_vvcurveto</a>;
<a name="l01202"></a>01202           <span class="keywordflow">break</span>;
<a name="l01203"></a>01203         <span class="keywordflow">case</span> 27:
<a name="l01204"></a>01204           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a2c6f4e1ef6fe5919bc6b5f72673ddef7">cff_op_hhcurveto</a>;
<a name="l01205"></a>01205           <span class="keywordflow">break</span>;
<a name="l01206"></a>01206         <span class="keywordflow">case</span> 29:
<a name="l01207"></a>01207           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a57546c33757242ac87da1e294caca2cd">cff_op_callgsubr</a>;
<a name="l01208"></a>01208           <span class="keywordflow">break</span>;
<a name="l01209"></a>01209         <span class="keywordflow">case</span> 30:
<a name="l01210"></a>01210           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ae42179f56a27deef7c102db53fef00d3">cff_op_vhcurveto</a>;
<a name="l01211"></a>01211           <span class="keywordflow">break</span>;
<a name="l01212"></a>01212         <span class="keywordflow">case</span> 31:
<a name="l01213"></a>01213           op = <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ad84d1e27d388ead6edfcf1347f7f04f5">cff_op_hvcurveto</a>;
<a name="l01214"></a>01214           <span class="keywordflow">break</span>;
<a name="l01215"></a>01215         <span class="keywordflow">default</span>:
<a name="l01216"></a>01216           <span class="keywordflow">break</span>;
<a name="l01217"></a>01217         }
<a name="l01218"></a>01218 
<a name="l01219"></a>01219         <span class="keywordflow">if</span> ( op == <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8af32c40b75ea268aaae1c240542eb738c">cff_op_unknown</a> )
<a name="l01220"></a>01220           <span class="keywordflow">goto</span> Syntax_Error;
<a name="l01221"></a>01221 
<a name="l01222"></a>01222         <span class="comment">/* check arguments */</span>
<a name="l01223"></a>01223         req_args = cff_argument_counts[op];
<a name="l01224"></a>01224         <span class="keywordflow">if</span> ( req_args &amp; <a class="code" href="cffgload_8c.html#aaea2eb2399ab43c559d5f11586afb00b">CFF_COUNT_CHECK_WIDTH</a> )
<a name="l01225"></a>01225         {
<a name="l01226"></a>01226           <span class="keywordflow">if</span> ( num_args &gt; 0 &amp;&amp; decoder-&gt;read_width )
<a name="l01227"></a>01227           {
<a name="l01228"></a>01228             <span class="comment">/* If `nominal_width&#39; is non-zero, the number is really a      */</span>
<a name="l01229"></a>01229             <span class="comment">/* difference against `nominal_width&#39;.  Else, the number here  */</span>
<a name="l01230"></a>01230             <span class="comment">/* is truly a width, not a difference against `nominal_width&#39;. */</span>
<a name="l01231"></a>01231             <span class="comment">/* If the font does not set `nominal_width&#39;, then              */</span>
<a name="l01232"></a>01232             <span class="comment">/* `nominal_width&#39; defaults to zero, and so we can set         */</span>
<a name="l01233"></a>01233             <span class="comment">/* `glyph_width&#39; to `nominal_width&#39; plus number on the stack   */</span>
<a name="l01234"></a>01234             <span class="comment">/* -- for either case.                                         */</span>
<a name="l01235"></a>01235 
<a name="l01236"></a>01236             <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>  set_width_ok;
<a name="l01237"></a>01237 
<a name="l01238"></a>01238 
<a name="l01239"></a>01239             <span class="keywordflow">switch</span> ( op )
<a name="l01240"></a>01240             {
<a name="l01241"></a>01241             <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a01d4fc07f5d25d67b85546307aa4ff91">cff_op_hmoveto</a>:
<a name="l01242"></a>01242             <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a713506a98409ebfdf759152baff23722">cff_op_vmoveto</a>:
<a name="l01243"></a>01243               set_width_ok = num_args &amp; 2;
<a name="l01244"></a>01244               <span class="keywordflow">break</span>;
<a name="l01245"></a>01245 
<a name="l01246"></a>01246             <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a28d40d72404136482286c1660a5ade06">cff_op_hstem</a>:
<a name="l01247"></a>01247             <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1f0969967e245931fec7d6f369cb0e6d">cff_op_vstem</a>:
<a name="l01248"></a>01248             <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a0246b57f0ee935c12d6dfd5faacc1dec">cff_op_hstemhm</a>:
<a name="l01249"></a>01249             <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a58236915cbd4069c5d81971690487d10">cff_op_vstemhm</a>:
<a name="l01250"></a>01250             <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8af371af458c3decd4e1bf20dd6039ca2a">cff_op_rmoveto</a>:
<a name="l01251"></a>01251             <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8afeee820728e5a9e914db82085fc7f390">cff_op_hintmask</a>:
<a name="l01252"></a>01252             <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a4a91ebecfe9b7fa4b216af356c1a4fb3">cff_op_cntrmask</a>:
<a name="l01253"></a>01253               set_width_ok = num_args &amp; 1;
<a name="l01254"></a>01254               <span class="keywordflow">break</span>;
<a name="l01255"></a>01255 
<a name="l01256"></a>01256             <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a02654a503c7056ffe73f7e89f870e409">cff_op_endchar</a>:
<a name="l01257"></a>01257               <span class="comment">/* If there is a width specified for endchar, we either have */</span>
<a name="l01258"></a>01258               <span class="comment">/* 1 argument or 5 arguments.  We like to argue.             */</span>
<a name="l01259"></a>01259               set_width_ok = ( num_args == 5 ) || ( num_args == 1 );
<a name="l01260"></a>01260               <span class="keywordflow">break</span>;
<a name="l01261"></a>01261 
<a name="l01262"></a>01262             <span class="keywordflow">default</span>:
<a name="l01263"></a>01263               set_width_ok = 0;
<a name="l01264"></a>01264               <span class="keywordflow">break</span>;
<a name="l01265"></a>01265             }
<a name="l01266"></a>01266 
<a name="l01267"></a>01267             <span class="keywordflow">if</span> ( set_width_ok )
<a name="l01268"></a>01268             {
<a name="l01269"></a>01269               decoder-&gt;glyph_width = decoder-&gt;nominal_width +
<a name="l01270"></a>01270                                        ( stack[0] &gt;&gt; 16 );
<a name="l01271"></a>01271 
<a name="l01272"></a>01272               <span class="keywordflow">if</span> ( decoder-&gt;width_only )
<a name="l01273"></a>01273               {
<a name="l01274"></a>01274                 <span class="comment">/* we only want the advance width; stop here */</span>
<a name="l01275"></a>01275                 <span class="keywordflow">break</span>;
<a name="l01276"></a>01276               }
<a name="l01277"></a>01277 
<a name="l01278"></a>01278               <span class="comment">/* Consumed an argument. */</span>
<a name="l01279"></a>01279               num_args--;
<a name="l01280"></a>01280             }
<a name="l01281"></a>01281           }
<a name="l01282"></a>01282 
<a name="l01283"></a>01283           decoder-&gt;read_width = 0;
<a name="l01284"></a>01284           req_args            = 0;
<a name="l01285"></a>01285         }
<a name="l01286"></a>01286 
<a name="l01287"></a>01287         req_args &amp;= 0x000F;
<a name="l01288"></a>01288         <span class="keywordflow">if</span> ( num_args &lt; req_args )
<a name="l01289"></a>01289           <span class="keywordflow">goto</span> Stack_Underflow;
<a name="l01290"></a>01290         args     -= req_args;
<a name="l01291"></a>01291         num_args -= req_args;
<a name="l01292"></a>01292 
<a name="l01293"></a>01293         <span class="comment">/* At this point, `args&#39; points to the first argument of the  */</span>
<a name="l01294"></a>01294         <span class="comment">/* operand in case `req_args&#39; isn&#39;t zero.  Otherwise, we have */</span>
<a name="l01295"></a>01295         <span class="comment">/* to adjust `args&#39; manually.                                 */</span>
<a name="l01296"></a>01296 
<a name="l01297"></a>01297         <span class="comment">/* Note that we only pop arguments from the stack which we    */</span>
<a name="l01298"></a>01298         <span class="comment">/* really need and can digest so that we can continue in case */</span>
<a name="l01299"></a>01299         <span class="comment">/* of superfluous stack elements.                             */</span>
<a name="l01300"></a>01300 
<a name="l01301"></a>01301         <span class="keywordflow">switch</span> ( op )
<a name="l01302"></a>01302         {
<a name="l01303"></a>01303         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a28d40d72404136482286c1660a5ade06">cff_op_hstem</a>:
<a name="l01304"></a>01304         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1f0969967e245931fec7d6f369cb0e6d">cff_op_vstem</a>:
<a name="l01305"></a>01305         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a0246b57f0ee935c12d6dfd5faacc1dec">cff_op_hstemhm</a>:
<a name="l01306"></a>01306         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a58236915cbd4069c5d81971690487d10">cff_op_vstemhm</a>:
<a name="l01307"></a>01307           <span class="comment">/* the number of arguments is always even here */</span>
<a name="l01308"></a>01308           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>((
<a name="l01309"></a>01309               op == <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a28d40d72404136482286c1660a5ade06">cff_op_hstem</a>   ? <span class="stringliteral">&quot; hstem\n&quot;</span>   :
<a name="l01310"></a>01310             ( op == <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1f0969967e245931fec7d6f369cb0e6d">cff_op_vstem</a>   ? <span class="stringliteral">&quot; vstem\n&quot;</span>   :
<a name="l01311"></a>01311             ( op == <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a0246b57f0ee935c12d6dfd5faacc1dec">cff_op_hstemhm</a> ? <span class="stringliteral">&quot; hstemhm\n&quot;</span> : <span class="stringliteral">&quot; vstemhm\n&quot;</span> ) ) ));
<a name="l01312"></a>01312 
<a name="l01313"></a>01313           <span class="keywordflow">if</span> ( hinter )
<a name="l01314"></a>01314             hinter-&gt;<a class="code" href="struct_t2___hints___funcs_rec__.html#a12bfd8bae5d3df8f570fcdfb70c00139">stems</a>( hinter-&gt;<a class="code" href="struct_t2___hints___funcs_rec__.html#af8daab694889bede5a513fbae5f86e25">hints</a>,
<a name="l01315"></a>01315                            ( op == <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a28d40d72404136482286c1660a5ade06">cff_op_hstem</a> || op == <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a0246b57f0ee935c12d6dfd5faacc1dec">cff_op_hstemhm</a> ),
<a name="l01316"></a>01316                            num_args / 2,
<a name="l01317"></a>01317                            args - ( num_args &amp; ~1 ) );
<a name="l01318"></a>01318 
<a name="l01319"></a>01319           decoder-&gt;num_hints += num_args / 2;
<a name="l01320"></a>01320           args = stack;
<a name="l01321"></a>01321           <span class="keywordflow">break</span>;
<a name="l01322"></a>01322 
<a name="l01323"></a>01323         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8afeee820728e5a9e914db82085fc7f390">cff_op_hintmask</a>:
<a name="l01324"></a>01324         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a4a91ebecfe9b7fa4b216af356c1a4fb3">cff_op_cntrmask</a>:
<a name="l01325"></a>01325           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( op == <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8afeee820728e5a9e914db82085fc7f390">cff_op_hintmask</a> ? <span class="stringliteral">&quot; hintmask&quot;</span> : <span class="stringliteral">&quot; cntrmask&quot;</span> ));
<a name="l01326"></a>01326 
<a name="l01327"></a>01327           <span class="comment">/* implement vstem when needed --                        */</span>
<a name="l01328"></a>01328           <span class="comment">/* the specification doesn&#39;t say it, but this also works */</span>
<a name="l01329"></a>01329           <span class="comment">/* with the &#39;cntrmask&#39; operator                          */</span>
<a name="l01330"></a>01330           <span class="comment">/*                                                       */</span>
<a name="l01331"></a>01331           <span class="keywordflow">if</span> ( num_args &gt; 0 )
<a name="l01332"></a>01332           {
<a name="l01333"></a>01333             <span class="keywordflow">if</span> ( hinter )
<a name="l01334"></a>01334               hinter-&gt;<a class="code" href="struct_t2___hints___funcs_rec__.html#a12bfd8bae5d3df8f570fcdfb70c00139">stems</a>( hinter-&gt;<a class="code" href="struct_t2___hints___funcs_rec__.html#af8daab694889bede5a513fbae5f86e25">hints</a>,
<a name="l01335"></a>01335                              0,
<a name="l01336"></a>01336                              num_args / 2,
<a name="l01337"></a>01337                              args - ( num_args &amp; ~1 ) );
<a name="l01338"></a>01338 
<a name="l01339"></a>01339             decoder-&gt;num_hints += num_args / 2;
<a name="l01340"></a>01340           }
<a name="l01341"></a>01341 
<a name="l01342"></a>01342           <span class="comment">/* In a valid charstring there must be at least one byte */</span>
<a name="l01343"></a>01343           <span class="comment">/* after `hintmask&#39; or `cntrmask&#39; (e.g., for a `return&#39;  */</span>
<a name="l01344"></a>01344           <span class="comment">/* instruction).  Additionally, there must be space for  */</span>
<a name="l01345"></a>01345           <span class="comment">/* `num_hints&#39; bits.                                     */</span>
<a name="l01346"></a>01346 
<a name="l01347"></a>01347           <span class="keywordflow">if</span> ( ( ip + ( ( decoder-&gt;num_hints + 7 ) &gt;&gt; 3 ) ) &gt;= limit )
<a name="l01348"></a>01348             <span class="keywordflow">goto</span> Syntax_Error;
<a name="l01349"></a>01349 
<a name="l01350"></a>01350           <span class="keywordflow">if</span> ( hinter )
<a name="l01351"></a>01351           {
<a name="l01352"></a>01352             <span class="keywordflow">if</span> ( op == <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8afeee820728e5a9e914db82085fc7f390">cff_op_hintmask</a> )
<a name="l01353"></a>01353               hinter-&gt;<a class="code" href="struct_t2___hints___funcs_rec__.html#af50d0cadda7033d7dbd27a199ccfcdd4">hintmask</a>( hinter-&gt;<a class="code" href="struct_t2___hints___funcs_rec__.html#af8daab694889bede5a513fbae5f86e25">hints</a>,
<a name="l01354"></a>01354                                 builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#acd27e804cd32054865ef4236e7f9dc93">current</a>-&gt;<a class="code" href="struct_f_t___outline__.html#a7ebcf3c33231af88655534d1ac02b66e">n_points</a>,
<a name="l01355"></a>01355                                 decoder-&gt;num_hints,
<a name="l01356"></a>01356                                 ip );
<a name="l01357"></a>01357             <span class="keywordflow">else</span>
<a name="l01358"></a>01358               hinter-&gt;<a class="code" href="struct_t2___hints___funcs_rec__.html#ad9d856a64b4a8556fc8d74bae1779e11">counter</a>( hinter-&gt;<a class="code" href="struct_t2___hints___funcs_rec__.html#af8daab694889bede5a513fbae5f86e25">hints</a>,
<a name="l01359"></a>01359                                decoder-&gt;num_hints,
<a name="l01360"></a>01360                                ip );
<a name="l01361"></a>01361           }
<a name="l01362"></a>01362 
<a name="l01363"></a>01363 <span class="preprocessor">#ifdef FT_DEBUG_LEVEL_TRACE</span>
<a name="l01364"></a>01364 <span class="preprocessor"></span>          {
<a name="l01365"></a>01365             <a class="code" href="fttypes_8h.html#abcb8db4dbf35d2b55a9e8c7b0926dc52">FT_UInt</a> maskbyte;
<a name="l01366"></a>01366 
<a name="l01367"></a>01367 
<a name="l01368"></a>01368             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; (maskbytes:&quot;</span> ));
<a name="l01369"></a>01369 
<a name="l01370"></a>01370             <span class="keywordflow">for</span> ( maskbyte = 0;
<a name="l01371"></a>01371                   maskbyte &lt; (<a class="code" href="fttypes_8h.html#abcb8db4dbf35d2b55a9e8c7b0926dc52">FT_UInt</a>)( ( decoder-&gt;num_hints + 7 ) &gt;&gt; 3 );
<a name="l01372"></a>01372                   maskbyte++, ip++ )
<a name="l01373"></a>01373               <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; 0x%02X&quot;</span>, *ip ));
<a name="l01374"></a>01374 
<a name="l01375"></a>01375             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot;)\n&quot;</span> ));
<a name="l01376"></a>01376           }
<a name="l01377"></a>01377 <span class="preprocessor">#else</span>
<a name="l01378"></a>01378 <span class="preprocessor"></span>          ip += ( decoder-&gt;num_hints + 7 ) &gt;&gt; 3;
<a name="l01379"></a>01379 <span class="preprocessor">#endif</span>
<a name="l01380"></a>01380 <span class="preprocessor"></span>          args = stack;
<a name="l01381"></a>01381           <span class="keywordflow">break</span>;
<a name="l01382"></a>01382 
<a name="l01383"></a>01383         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8af371af458c3decd4e1bf20dd6039ca2a">cff_op_rmoveto</a>:
<a name="l01384"></a>01384           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; rmoveto\n&quot;</span> ));
<a name="l01385"></a>01385 
<a name="l01386"></a>01386           cff_builder_close_contour( builder );
<a name="l01387"></a>01387           builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#ac8770a979f76c1dc11575dfdf40f1f88">path_begun</a> = 0;
<a name="l01388"></a>01388           x   += args[-2];
<a name="l01389"></a>01389           y   += args[-1];
<a name="l01390"></a>01390           args = stack;
<a name="l01391"></a>01391           <span class="keywordflow">break</span>;
<a name="l01392"></a>01392 
<a name="l01393"></a>01393         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a713506a98409ebfdf759152baff23722">cff_op_vmoveto</a>:
<a name="l01394"></a>01394           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; vmoveto\n&quot;</span> ));
<a name="l01395"></a>01395 
<a name="l01396"></a>01396           cff_builder_close_contour( builder );
<a name="l01397"></a>01397           builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#ac8770a979f76c1dc11575dfdf40f1f88">path_begun</a> = 0;
<a name="l01398"></a>01398           y   += args[-1];
<a name="l01399"></a>01399           args = stack;
<a name="l01400"></a>01400           <span class="keywordflow">break</span>;
<a name="l01401"></a>01401 
<a name="l01402"></a>01402         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a01d4fc07f5d25d67b85546307aa4ff91">cff_op_hmoveto</a>:
<a name="l01403"></a>01403           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; hmoveto\n&quot;</span> ));
<a name="l01404"></a>01404 
<a name="l01405"></a>01405           cff_builder_close_contour( builder );
<a name="l01406"></a>01406           builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#ac8770a979f76c1dc11575dfdf40f1f88">path_begun</a> = 0;
<a name="l01407"></a>01407           x   += args[-1];
<a name="l01408"></a>01408           args = stack;
<a name="l01409"></a>01409           <span class="keywordflow">break</span>;
<a name="l01410"></a>01410 
<a name="l01411"></a>01411         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ab1193e6aec53b22a0189defd98d99c37">cff_op_rlineto</a>:
<a name="l01412"></a>01412           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; rlineto\n&quot;</span> ));
<a name="l01413"></a>01413 
<a name="l01414"></a>01414           <span class="keywordflow">if</span> ( cff_builder_start_point ( builder, x, y ) ||
<a name="l01415"></a>01415                <a class="code" href="t1decode_8c.html#abb2307d7c9ff1cfc3bf71de0f68f3174">check_points</a>( builder, num_args / 2 )     )
<a name="l01416"></a>01416             <span class="keywordflow">goto</span> Fail;
<a name="l01417"></a>01417 
<a name="l01418"></a>01418           <span class="keywordflow">if</span> ( num_args &lt; 2 )
<a name="l01419"></a>01419             <span class="keywordflow">goto</span> Stack_Underflow;
<a name="l01420"></a>01420 
<a name="l01421"></a>01421           args -= num_args &amp; ~1;
<a name="l01422"></a>01422           <span class="keywordflow">while</span> ( args &lt; decoder-&gt;top )
<a name="l01423"></a>01423           {
<a name="l01424"></a>01424             x += args[0];
<a name="l01425"></a>01425             y += args[1];
<a name="l01426"></a>01426             cff_builder_add_point( builder, x, y, 1 );
<a name="l01427"></a>01427             args += 2;
<a name="l01428"></a>01428           }
<a name="l01429"></a>01429           args = stack;
<a name="l01430"></a>01430           <span class="keywordflow">break</span>;
<a name="l01431"></a>01431 
<a name="l01432"></a>01432         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ac6ccfab49de5ae2b4d9c41d7c33d2bb0">cff_op_hlineto</a>:
<a name="l01433"></a>01433         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a290b968a40248b5cb4070b89ccb85005">cff_op_vlineto</a>:
<a name="l01434"></a>01434           {
<a name="l01435"></a>01435             <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>  phase = ( op == <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ac6ccfab49de5ae2b4d9c41d7c33d2bb0">cff_op_hlineto</a> );
<a name="l01436"></a>01436 
<a name="l01437"></a>01437 
<a name="l01438"></a>01438             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( op == <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ac6ccfab49de5ae2b4d9c41d7c33d2bb0">cff_op_hlineto</a> ? <span class="stringliteral">&quot; hlineto\n&quot;</span>
<a name="l01439"></a>01439                                              : <span class="stringliteral">&quot; vlineto\n&quot;</span> ));
<a name="l01440"></a>01440 
<a name="l01441"></a>01441             <span class="keywordflow">if</span> ( num_args &lt; 1 )
<a name="l01442"></a>01442               <span class="keywordflow">goto</span> Stack_Underflow;
<a name="l01443"></a>01443 
<a name="l01444"></a>01444             <span class="keywordflow">if</span> ( cff_builder_start_point ( builder, x, y ) ||
<a name="l01445"></a>01445                  <a class="code" href="t1decode_8c.html#abb2307d7c9ff1cfc3bf71de0f68f3174">check_points</a>( builder, num_args )         )
<a name="l01446"></a>01446               <span class="keywordflow">goto</span> Fail;
<a name="l01447"></a>01447 
<a name="l01448"></a>01448             args = stack;
<a name="l01449"></a>01449             <span class="keywordflow">while</span> ( args &lt; decoder-&gt;top )
<a name="l01450"></a>01450             {
<a name="l01451"></a>01451               <span class="keywordflow">if</span> ( phase )
<a name="l01452"></a>01452                 x += args[0];
<a name="l01453"></a>01453               <span class="keywordflow">else</span>
<a name="l01454"></a>01454                 y += args[0];
<a name="l01455"></a>01455 
<a name="l01456"></a>01456               <span class="keywordflow">if</span> ( cff_builder_add_point1( builder, x, y ) )
<a name="l01457"></a>01457                 <span class="keywordflow">goto</span> Fail;
<a name="l01458"></a>01458 
<a name="l01459"></a>01459               args++;
<a name="l01460"></a>01460               phase ^= 1;
<a name="l01461"></a>01461             }
<a name="l01462"></a>01462             args = stack;
<a name="l01463"></a>01463           }
<a name="l01464"></a>01464           <span class="keywordflow">break</span>;
<a name="l01465"></a>01465 
<a name="l01466"></a>01466         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8add4fe42409b24680e84c6f0b541448aa">cff_op_rrcurveto</a>:
<a name="l01467"></a>01467           {
<a name="l01468"></a>01468             <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>  nargs;
<a name="l01469"></a>01469 
<a name="l01470"></a>01470 
<a name="l01471"></a>01471             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; rrcurveto\n&quot;</span> ));
<a name="l01472"></a>01472 
<a name="l01473"></a>01473             <span class="keywordflow">if</span> ( num_args &lt; 6 )
<a name="l01474"></a>01474               <span class="keywordflow">goto</span> Stack_Underflow;
<a name="l01475"></a>01475 
<a name="l01476"></a>01476             nargs = num_args - num_args % 6;
<a name="l01477"></a>01477 
<a name="l01478"></a>01478             <span class="keywordflow">if</span> ( cff_builder_start_point ( builder, x, y ) ||
<a name="l01479"></a>01479                  <a class="code" href="t1decode_8c.html#abb2307d7c9ff1cfc3bf71de0f68f3174">check_points</a>( builder, nargs / 2 )     )
<a name="l01480"></a>01480               <span class="keywordflow">goto</span> Fail;
<a name="l01481"></a>01481 
<a name="l01482"></a>01482             args -= nargs;
<a name="l01483"></a>01483             <span class="keywordflow">while</span> ( args &lt; decoder-&gt;top )
<a name="l01484"></a>01484             {
<a name="l01485"></a>01485               x += args[0];
<a name="l01486"></a>01486               y += args[1];
<a name="l01487"></a>01487               cff_builder_add_point( builder, x, y, 0 );
<a name="l01488"></a>01488               x += args[2];
<a name="l01489"></a>01489               y += args[3];
<a name="l01490"></a>01490               cff_builder_add_point( builder, x, y, 0 );
<a name="l01491"></a>01491               x += args[4];
<a name="l01492"></a>01492               y += args[5];
<a name="l01493"></a>01493               cff_builder_add_point( builder, x, y, 1 );
<a name="l01494"></a>01494               args += 6;
<a name="l01495"></a>01495             }
<a name="l01496"></a>01496             args = stack;
<a name="l01497"></a>01497           }
<a name="l01498"></a>01498           <span class="keywordflow">break</span>;
<a name="l01499"></a>01499 
<a name="l01500"></a>01500         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ae4c9ad7156108a8ec957167a3c9601b1">cff_op_vvcurveto</a>:
<a name="l01501"></a>01501           {
<a name="l01502"></a>01502             <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>  nargs;
<a name="l01503"></a>01503 
<a name="l01504"></a>01504 
<a name="l01505"></a>01505             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; vvcurveto\n&quot;</span> ));
<a name="l01506"></a>01506 
<a name="l01507"></a>01507             <span class="keywordflow">if</span> ( num_args &lt; 4 )
<a name="l01508"></a>01508               <span class="keywordflow">goto</span> Stack_Underflow;
<a name="l01509"></a>01509 
<a name="l01510"></a>01510             <span class="comment">/* if num_args isn&#39;t of the form 4n or 4n+1, */</span>
<a name="l01511"></a>01511             <span class="comment">/* we reduce it to 4n+1                      */</span>
<a name="l01512"></a>01512 
<a name="l01513"></a>01513             nargs = num_args - num_args % 4;
<a name="l01514"></a>01514             <span class="keywordflow">if</span> ( num_args - nargs &gt; 0 )
<a name="l01515"></a>01515               nargs += 1;
<a name="l01516"></a>01516 
<a name="l01517"></a>01517             <span class="keywordflow">if</span> ( cff_builder_start_point( builder, x, y ) )
<a name="l01518"></a>01518               <span class="keywordflow">goto</span> Fail;
<a name="l01519"></a>01519 
<a name="l01520"></a>01520             args -= nargs;
<a name="l01521"></a>01521 
<a name="l01522"></a>01522             <span class="keywordflow">if</span> ( nargs &amp; 1 )
<a name="l01523"></a>01523             {
<a name="l01524"></a>01524               x += args[0];
<a name="l01525"></a>01525               args++;
<a name="l01526"></a>01526               nargs--;
<a name="l01527"></a>01527             }
<a name="l01528"></a>01528 
<a name="l01529"></a>01529             <span class="keywordflow">if</span> ( <a class="code" href="t1decode_8c.html#abb2307d7c9ff1cfc3bf71de0f68f3174">check_points</a>( builder, 3 * ( nargs / 4 ) ) )
<a name="l01530"></a>01530               <span class="keywordflow">goto</span> Fail;
<a name="l01531"></a>01531 
<a name="l01532"></a>01532             <span class="keywordflow">while</span> ( args &lt; decoder-&gt;top )
<a name="l01533"></a>01533             {
<a name="l01534"></a>01534               y += args[0];
<a name="l01535"></a>01535               cff_builder_add_point( builder, x, y, 0 );
<a name="l01536"></a>01536               x += args[1];
<a name="l01537"></a>01537               y += args[2];
<a name="l01538"></a>01538               cff_builder_add_point( builder, x, y, 0 );
<a name="l01539"></a>01539               y += args[3];
<a name="l01540"></a>01540               cff_builder_add_point( builder, x, y, 1 );
<a name="l01541"></a>01541               args += 4;
<a name="l01542"></a>01542             }
<a name="l01543"></a>01543             args = stack;
<a name="l01544"></a>01544           }
<a name="l01545"></a>01545           <span class="keywordflow">break</span>;
<a name="l01546"></a>01546 
<a name="l01547"></a>01547         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a2c6f4e1ef6fe5919bc6b5f72673ddef7">cff_op_hhcurveto</a>:
<a name="l01548"></a>01548           {
<a name="l01549"></a>01549             <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>  nargs;
<a name="l01550"></a>01550 
<a name="l01551"></a>01551 
<a name="l01552"></a>01552             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; hhcurveto\n&quot;</span> ));
<a name="l01553"></a>01553 
<a name="l01554"></a>01554             <span class="keywordflow">if</span> ( num_args &lt; 4 )
<a name="l01555"></a>01555               <span class="keywordflow">goto</span> Stack_Underflow;
<a name="l01556"></a>01556 
<a name="l01557"></a>01557             <span class="comment">/* if num_args isn&#39;t of the form 4n or 4n+1, */</span>
<a name="l01558"></a>01558             <span class="comment">/* we reduce it to 4n+1                      */</span>
<a name="l01559"></a>01559 
<a name="l01560"></a>01560             nargs = num_args - num_args % 4;
<a name="l01561"></a>01561             <span class="keywordflow">if</span> ( num_args - nargs &gt; 0 )
<a name="l01562"></a>01562               nargs += 1;
<a name="l01563"></a>01563 
<a name="l01564"></a>01564             <span class="keywordflow">if</span> ( cff_builder_start_point( builder, x, y ) )
<a name="l01565"></a>01565               <span class="keywordflow">goto</span> Fail;
<a name="l01566"></a>01566 
<a name="l01567"></a>01567             args -= nargs;
<a name="l01568"></a>01568             <span class="keywordflow">if</span> ( nargs &amp; 1 )
<a name="l01569"></a>01569             {
<a name="l01570"></a>01570               y += args[0];
<a name="l01571"></a>01571               args++;
<a name="l01572"></a>01572               nargs--;
<a name="l01573"></a>01573             }
<a name="l01574"></a>01574 
<a name="l01575"></a>01575             <span class="keywordflow">if</span> ( <a class="code" href="t1decode_8c.html#abb2307d7c9ff1cfc3bf71de0f68f3174">check_points</a>( builder, 3 * ( nargs / 4 ) ) )
<a name="l01576"></a>01576               <span class="keywordflow">goto</span> Fail;
<a name="l01577"></a>01577 
<a name="l01578"></a>01578             <span class="keywordflow">while</span> ( args &lt; decoder-&gt;top )
<a name="l01579"></a>01579             {
<a name="l01580"></a>01580               x += args[0];
<a name="l01581"></a>01581               cff_builder_add_point( builder, x, y, 0 );
<a name="l01582"></a>01582               x += args[1];
<a name="l01583"></a>01583               y += args[2];
<a name="l01584"></a>01584               cff_builder_add_point( builder, x, y, 0 );
<a name="l01585"></a>01585               x += args[3];
<a name="l01586"></a>01586               cff_builder_add_point( builder, x, y, 1 );
<a name="l01587"></a>01587               args += 4;
<a name="l01588"></a>01588             }
<a name="l01589"></a>01589             args = stack;
<a name="l01590"></a>01590           }
<a name="l01591"></a>01591           <span class="keywordflow">break</span>;
<a name="l01592"></a>01592 
<a name="l01593"></a>01593         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ae42179f56a27deef7c102db53fef00d3">cff_op_vhcurveto</a>:
<a name="l01594"></a>01594         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ad84d1e27d388ead6edfcf1347f7f04f5">cff_op_hvcurveto</a>:
<a name="l01595"></a>01595           {
<a name="l01596"></a>01596             <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>  phase;
<a name="l01597"></a>01597             <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>  nargs;
<a name="l01598"></a>01598 
<a name="l01599"></a>01599 
<a name="l01600"></a>01600             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( op == <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ae42179f56a27deef7c102db53fef00d3">cff_op_vhcurveto</a> ? <span class="stringliteral">&quot; vhcurveto\n&quot;</span>
<a name="l01601"></a>01601                                                : <span class="stringliteral">&quot; hvcurveto\n&quot;</span> ));
<a name="l01602"></a>01602 
<a name="l01603"></a>01603             <span class="keywordflow">if</span> ( cff_builder_start_point( builder, x, y ) )
<a name="l01604"></a>01604               <span class="keywordflow">goto</span> Fail;
<a name="l01605"></a>01605 
<a name="l01606"></a>01606             <span class="keywordflow">if</span> ( num_args &lt; 4 )
<a name="l01607"></a>01607               <span class="keywordflow">goto</span> Stack_Underflow;
<a name="l01608"></a>01608 
<a name="l01609"></a>01609             <span class="comment">/* if num_args isn&#39;t of the form 8n, 8n+1, 8n+4, or 8n+5, */</span>
<a name="l01610"></a>01610             <span class="comment">/* we reduce it to the largest one which fits             */</span>
<a name="l01611"></a>01611 
<a name="l01612"></a>01612             nargs = num_args - num_args % 4;
<a name="l01613"></a>01613             <span class="keywordflow">if</span> ( num_args - nargs &gt; 0 )
<a name="l01614"></a>01614               nargs += 1;
<a name="l01615"></a>01615 
<a name="l01616"></a>01616             args -= nargs;
<a name="l01617"></a>01617             <span class="keywordflow">if</span> ( <a class="code" href="t1decode_8c.html#abb2307d7c9ff1cfc3bf71de0f68f3174">check_points</a>( builder, ( nargs / 4 ) * 3 ) )
<a name="l01618"></a>01618               <span class="keywordflow">goto</span> Stack_Underflow;
<a name="l01619"></a>01619 
<a name="l01620"></a>01620             phase = ( op == <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ad84d1e27d388ead6edfcf1347f7f04f5">cff_op_hvcurveto</a> );
<a name="l01621"></a>01621 
<a name="l01622"></a>01622             <span class="keywordflow">while</span> ( nargs &gt;= 4 )
<a name="l01623"></a>01623             {
<a name="l01624"></a>01624               nargs -= 4;
<a name="l01625"></a>01625               <span class="keywordflow">if</span> ( phase )
<a name="l01626"></a>01626               {
<a name="l01627"></a>01627                 x += args[0];
<a name="l01628"></a>01628                 cff_builder_add_point( builder, x, y, 0 );
<a name="l01629"></a>01629                 x += args[1];
<a name="l01630"></a>01630                 y += args[2];
<a name="l01631"></a>01631                 cff_builder_add_point( builder, x, y, 0 );
<a name="l01632"></a>01632                 y += args[3];
<a name="l01633"></a>01633                 <span class="keywordflow">if</span> ( nargs == 1 )
<a name="l01634"></a>01634                   x += args[4];
<a name="l01635"></a>01635                 cff_builder_add_point( builder, x, y, 1 );
<a name="l01636"></a>01636               }
<a name="l01637"></a>01637               <span class="keywordflow">else</span>
<a name="l01638"></a>01638               {
<a name="l01639"></a>01639                 y += args[0];
<a name="l01640"></a>01640                 cff_builder_add_point( builder, x, y, 0 );
<a name="l01641"></a>01641                 x += args[1];
<a name="l01642"></a>01642                 y += args[2];
<a name="l01643"></a>01643                 cff_builder_add_point( builder, x, y, 0 );
<a name="l01644"></a>01644                 x += args[3];
<a name="l01645"></a>01645                 <span class="keywordflow">if</span> ( nargs == 1 )
<a name="l01646"></a>01646                   y += args[4];
<a name="l01647"></a>01647                 cff_builder_add_point( builder, x, y, 1 );
<a name="l01648"></a>01648               }
<a name="l01649"></a>01649               args  += 4;
<a name="l01650"></a>01650               phase ^= 1;
<a name="l01651"></a>01651             }
<a name="l01652"></a>01652             args = stack;
<a name="l01653"></a>01653           }
<a name="l01654"></a>01654           <span class="keywordflow">break</span>;
<a name="l01655"></a>01655 
<a name="l01656"></a>01656         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a24c60e306d86c0b7c62b76f2c7d6d1d2">cff_op_rlinecurve</a>:
<a name="l01657"></a>01657           {
<a name="l01658"></a>01658             <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>  num_lines;
<a name="l01659"></a>01659             <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>  nargs;
<a name="l01660"></a>01660 
<a name="l01661"></a>01661 
<a name="l01662"></a>01662             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; rlinecurve\n&quot;</span> ));
<a name="l01663"></a>01663 
<a name="l01664"></a>01664             <span class="keywordflow">if</span> ( num_args &lt; 8 )
<a name="l01665"></a>01665               <span class="keywordflow">goto</span> Stack_Underflow;
<a name="l01666"></a>01666 
<a name="l01667"></a>01667             nargs     = num_args &amp; ~1;
<a name="l01668"></a>01668             num_lines = ( nargs - 6 ) / 2;
<a name="l01669"></a>01669 
<a name="l01670"></a>01670             <span class="keywordflow">if</span> ( cff_builder_start_point( builder, x, y ) ||
<a name="l01671"></a>01671                  <a class="code" href="t1decode_8c.html#abb2307d7c9ff1cfc3bf71de0f68f3174">check_points</a>( builder, num_lines + 3 )   )
<a name="l01672"></a>01672               <span class="keywordflow">goto</span> Fail;
<a name="l01673"></a>01673 
<a name="l01674"></a>01674             args -= nargs;
<a name="l01675"></a>01675 
<a name="l01676"></a>01676             <span class="comment">/* first, add the line segments */</span>
<a name="l01677"></a>01677             <span class="keywordflow">while</span> ( num_lines &gt; 0 )
<a name="l01678"></a>01678             {
<a name="l01679"></a>01679               x += args[0];
<a name="l01680"></a>01680               y += args[1];
<a name="l01681"></a>01681               cff_builder_add_point( builder, x, y, 1 );
<a name="l01682"></a>01682               args += 2;
<a name="l01683"></a>01683               num_lines--;
<a name="l01684"></a>01684             }
<a name="l01685"></a>01685 
<a name="l01686"></a>01686             <span class="comment">/* then the curve */</span>
<a name="l01687"></a>01687             x += args[0];
<a name="l01688"></a>01688             y += args[1];
<a name="l01689"></a>01689             cff_builder_add_point( builder, x, y, 0 );
<a name="l01690"></a>01690             x += args[2];
<a name="l01691"></a>01691             y += args[3];
<a name="l01692"></a>01692             cff_builder_add_point( builder, x, y, 0 );
<a name="l01693"></a>01693             x += args[4];
<a name="l01694"></a>01694             y += args[5];
<a name="l01695"></a>01695             cff_builder_add_point( builder, x, y, 1 );
<a name="l01696"></a>01696             args = stack;
<a name="l01697"></a>01697           }
<a name="l01698"></a>01698           <span class="keywordflow">break</span>;
<a name="l01699"></a>01699 
<a name="l01700"></a>01700         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a8d08fbf34700b975d4f791d2ab0347af">cff_op_rcurveline</a>:
<a name="l01701"></a>01701           {
<a name="l01702"></a>01702             <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>  num_curves;
<a name="l01703"></a>01703             <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>  nargs;
<a name="l01704"></a>01704 
<a name="l01705"></a>01705 
<a name="l01706"></a>01706             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; rcurveline\n&quot;</span> ));
<a name="l01707"></a>01707 
<a name="l01708"></a>01708             <span class="keywordflow">if</span> ( num_args &lt; 8 )
<a name="l01709"></a>01709               <span class="keywordflow">goto</span> Stack_Underflow;
<a name="l01710"></a>01710 
<a name="l01711"></a>01711             nargs      = num_args - 2;
<a name="l01712"></a>01712             nargs      = nargs - nargs % 6 + 2;
<a name="l01713"></a>01713             num_curves = ( nargs - 2 ) / 6;
<a name="l01714"></a>01714 
<a name="l01715"></a>01715             <span class="keywordflow">if</span> ( cff_builder_start_point ( builder, x, y ) ||
<a name="l01716"></a>01716                  <a class="code" href="t1decode_8c.html#abb2307d7c9ff1cfc3bf71de0f68f3174">check_points</a>( builder, num_curves * 3 + 2 ) )
<a name="l01717"></a>01717               <span class="keywordflow">goto</span> Fail;
<a name="l01718"></a>01718 
<a name="l01719"></a>01719             args -= nargs;
<a name="l01720"></a>01720 
<a name="l01721"></a>01721             <span class="comment">/* first, add the curves */</span>
<a name="l01722"></a>01722             <span class="keywordflow">while</span> ( num_curves &gt; 0 )
<a name="l01723"></a>01723             {
<a name="l01724"></a>01724               x += args[0];
<a name="l01725"></a>01725               y += args[1];
<a name="l01726"></a>01726               cff_builder_add_point( builder, x, y, 0 );
<a name="l01727"></a>01727               x += args[2];
<a name="l01728"></a>01728               y += args[3];
<a name="l01729"></a>01729               cff_builder_add_point( builder, x, y, 0 );
<a name="l01730"></a>01730               x += args[4];
<a name="l01731"></a>01731               y += args[5];
<a name="l01732"></a>01732               cff_builder_add_point( builder, x, y, 1 );
<a name="l01733"></a>01733               args += 6;
<a name="l01734"></a>01734               num_curves--;
<a name="l01735"></a>01735             }
<a name="l01736"></a>01736 
<a name="l01737"></a>01737             <span class="comment">/* then the final line */</span>
<a name="l01738"></a>01738             x += args[0];
<a name="l01739"></a>01739             y += args[1];
<a name="l01740"></a>01740             cff_builder_add_point( builder, x, y, 1 );
<a name="l01741"></a>01741             args = stack;
<a name="l01742"></a>01742           }
<a name="l01743"></a>01743           <span class="keywordflow">break</span>;
<a name="l01744"></a>01744 
<a name="l01745"></a>01745         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ac98a098a167c1f8de65f0599aeb46813">cff_op_hflex1</a>:
<a name="l01746"></a>01746           {
<a name="l01747"></a>01747             <a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a> start_y;
<a name="l01748"></a>01748 
<a name="l01749"></a>01749 
<a name="l01750"></a>01750             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; hflex1\n&quot;</span> ));
<a name="l01751"></a>01751 
<a name="l01752"></a>01752             <span class="comment">/* adding five more points: 4 control points, 1 on-curve point */</span>
<a name="l01753"></a>01753             <span class="comment">/* -- make sure we have enough space for the start point if it */</span>
<a name="l01754"></a>01754             <span class="comment">/* needs to be added                                           */</span>
<a name="l01755"></a>01755             <span class="keywordflow">if</span> ( cff_builder_start_point( builder, x, y ) ||
<a name="l01756"></a>01756                  <a class="code" href="t1decode_8c.html#abb2307d7c9ff1cfc3bf71de0f68f3174">check_points</a>( builder, 6 )               )
<a name="l01757"></a>01757               <span class="keywordflow">goto</span> Fail;
<a name="l01758"></a>01758 
<a name="l01759"></a>01759             <span class="comment">/* record the starting point&#39;s y position for later use */</span>
<a name="l01760"></a>01760             start_y = y;
<a name="l01761"></a>01761 
<a name="l01762"></a>01762             <span class="comment">/* first control point */</span>
<a name="l01763"></a>01763             x += args[0];
<a name="l01764"></a>01764             y += args[1];
<a name="l01765"></a>01765             cff_builder_add_point( builder, x, y, 0 );
<a name="l01766"></a>01766 
<a name="l01767"></a>01767             <span class="comment">/* second control point */</span>
<a name="l01768"></a>01768             x += args[2];
<a name="l01769"></a>01769             y += args[3];
<a name="l01770"></a>01770             cff_builder_add_point( builder, x, y, 0 );
<a name="l01771"></a>01771 
<a name="l01772"></a>01772             <span class="comment">/* join point; on curve, with y-value the same as the last */</span>
<a name="l01773"></a>01773             <span class="comment">/* control point&#39;s y-value                                 */</span>
<a name="l01774"></a>01774             x += args[4];
<a name="l01775"></a>01775             cff_builder_add_point( builder, x, y, 1 );
<a name="l01776"></a>01776 
<a name="l01777"></a>01777             <span class="comment">/* third control point, with y-value the same as the join */</span>
<a name="l01778"></a>01778             <span class="comment">/* point&#39;s y-value                                        */</span>
<a name="l01779"></a>01779             x += args[5];
<a name="l01780"></a>01780             cff_builder_add_point( builder, x, y, 0 );
<a name="l01781"></a>01781 
<a name="l01782"></a>01782             <span class="comment">/* fourth control point */</span>
<a name="l01783"></a>01783             x += args[6];
<a name="l01784"></a>01784             y += args[7];
<a name="l01785"></a>01785             cff_builder_add_point( builder, x, y, 0 );
<a name="l01786"></a>01786 
<a name="l01787"></a>01787             <span class="comment">/* ending point, with y-value the same as the start   */</span>
<a name="l01788"></a>01788             x += args[8];
<a name="l01789"></a>01789             y  = start_y;
<a name="l01790"></a>01790             cff_builder_add_point( builder, x, y, 1 );
<a name="l01791"></a>01791 
<a name="l01792"></a>01792             args = stack;
<a name="l01793"></a>01793             <span class="keywordflow">break</span>;
<a name="l01794"></a>01794           }
<a name="l01795"></a>01795 
<a name="l01796"></a>01796         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a258fdb0f1769f994880a168ea516123f">cff_op_hflex</a>:
<a name="l01797"></a>01797           {
<a name="l01798"></a>01798             <a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a> start_y;
<a name="l01799"></a>01799 
<a name="l01800"></a>01800 
<a name="l01801"></a>01801             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; hflex\n&quot;</span> ));
<a name="l01802"></a>01802 
<a name="l01803"></a>01803             <span class="comment">/* adding six more points; 4 control points, 2 on-curve points */</span>
<a name="l01804"></a>01804             <span class="keywordflow">if</span> ( cff_builder_start_point( builder, x, y ) ||
<a name="l01805"></a>01805                  <a class="code" href="t1decode_8c.html#abb2307d7c9ff1cfc3bf71de0f68f3174">check_points</a>( builder, 6 )               )
<a name="l01806"></a>01806               <span class="keywordflow">goto</span> Fail;
<a name="l01807"></a>01807 
<a name="l01808"></a>01808             <span class="comment">/* record the starting point&#39;s y-position for later use */</span>
<a name="l01809"></a>01809             start_y = y;
<a name="l01810"></a>01810 
<a name="l01811"></a>01811             <span class="comment">/* first control point */</span>
<a name="l01812"></a>01812             x += args[0];
<a name="l01813"></a>01813             cff_builder_add_point( builder, x, y, 0 );
<a name="l01814"></a>01814 
<a name="l01815"></a>01815             <span class="comment">/* second control point */</span>
<a name="l01816"></a>01816             x += args[1];
<a name="l01817"></a>01817             y += args[2];
<a name="l01818"></a>01818             cff_builder_add_point( builder, x, y, 0 );
<a name="l01819"></a>01819 
<a name="l01820"></a>01820             <span class="comment">/* join point; on curve, with y-value the same as the last */</span>
<a name="l01821"></a>01821             <span class="comment">/* control point&#39;s y-value                                 */</span>
<a name="l01822"></a>01822             x += args[3];
<a name="l01823"></a>01823             cff_builder_add_point( builder, x, y, 1 );
<a name="l01824"></a>01824 
<a name="l01825"></a>01825             <span class="comment">/* third control point, with y-value the same as the join */</span>
<a name="l01826"></a>01826             <span class="comment">/* point&#39;s y-value                                        */</span>
<a name="l01827"></a>01827             x += args[4];
<a name="l01828"></a>01828             cff_builder_add_point( builder, x, y, 0 );
<a name="l01829"></a>01829 
<a name="l01830"></a>01830             <span class="comment">/* fourth control point */</span>
<a name="l01831"></a>01831             x += args[5];
<a name="l01832"></a>01832             y  = start_y;
<a name="l01833"></a>01833             cff_builder_add_point( builder, x, y, 0 );
<a name="l01834"></a>01834 
<a name="l01835"></a>01835             <span class="comment">/* ending point, with y-value the same as the start point&#39;s */</span>
<a name="l01836"></a>01836             <span class="comment">/* y-value -- we don&#39;t add this point, though               */</span>
<a name="l01837"></a>01837             x += args[6];
<a name="l01838"></a>01838             cff_builder_add_point( builder, x, y, 1 );
<a name="l01839"></a>01839 
<a name="l01840"></a>01840             args = stack;
<a name="l01841"></a>01841             <span class="keywordflow">break</span>;
<a name="l01842"></a>01842           }
<a name="l01843"></a>01843 
<a name="l01844"></a>01844         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8aa23494894eec5922ad45ffcdb1eb4e52">cff_op_flex1</a>:
<a name="l01845"></a>01845           {
<a name="l01846"></a>01846             <a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>     start_x, start_y; <span class="comment">/* record start x, y values for */</span>
<a name="l01847"></a>01847                                          <span class="comment">/* alter use                    */</span>
<a name="l01848"></a>01848             <a class="code" href="fttypes_8h.html#a5f5a679cc09f758efdd0d1c5feed3c3d">FT_Fixed</a>   dx = 0, dy = 0;   <span class="comment">/* used in horizontal/vertical  */</span>
<a name="l01849"></a>01849                                          <span class="comment">/* algorithm below              */</span>
<a name="l01850"></a>01850             <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>     horizontal, count;
<a name="l01851"></a>01851             <a class="code" href="fttypes_8h.html#a5f5a679cc09f758efdd0d1c5feed3c3d">FT_Fixed</a>*  temp;
<a name="l01852"></a>01852 
<a name="l01853"></a>01853 
<a name="l01854"></a>01854             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; flex1\n&quot;</span> ));
<a name="l01855"></a>01855 
<a name="l01856"></a>01856             <span class="comment">/* adding six more points; 4 control points, 2 on-curve points */</span>
<a name="l01857"></a>01857             <span class="keywordflow">if</span> ( cff_builder_start_point( builder, x, y ) ||
<a name="l01858"></a>01858                  <a class="code" href="t1decode_8c.html#abb2307d7c9ff1cfc3bf71de0f68f3174">check_points</a>( builder, 6 )               )
<a name="l01859"></a>01859               <span class="keywordflow">goto</span> Fail;
<a name="l01860"></a>01860 
<a name="l01861"></a>01861             <span class="comment">/* record the starting point&#39;s x, y position for later use */</span>
<a name="l01862"></a>01862             start_x = x;
<a name="l01863"></a>01863             start_y = y;
<a name="l01864"></a>01864 
<a name="l01865"></a>01865             <span class="comment">/* XXX: figure out whether this is supposed to be a horizontal */</span>
<a name="l01866"></a>01866             <span class="comment">/*      or vertical flex; the Type 2 specification is vague... */</span>
<a name="l01867"></a>01867 
<a name="l01868"></a>01868             temp = args;
<a name="l01869"></a>01869 
<a name="l01870"></a>01870             <span class="comment">/* grab up to the last argument */</span>
<a name="l01871"></a>01871             <span class="keywordflow">for</span> ( count = 5; count &gt; 0; count-- )
<a name="l01872"></a>01872             {
<a name="l01873"></a>01873               dx += temp[0];
<a name="l01874"></a>01874               dy += temp[1];
<a name="l01875"></a>01875               temp += 2;
<a name="l01876"></a>01876             }
<a name="l01877"></a>01877 
<a name="l01878"></a>01878             <span class="keywordflow">if</span> ( dx &lt; 0 )
<a name="l01879"></a>01879               dx = -dx;
<a name="l01880"></a>01880             <span class="keywordflow">if</span> ( dy &lt; 0 )
<a name="l01881"></a>01881               dy = -dy;
<a name="l01882"></a>01882 
<a name="l01883"></a>01883             <span class="comment">/* strange test, but here it is... */</span>
<a name="l01884"></a>01884             horizontal = ( dx &gt; dy );
<a name="l01885"></a>01885 
<a name="l01886"></a>01886             <span class="keywordflow">for</span> ( count = 5; count &gt; 0; count-- )
<a name="l01887"></a>01887             {
<a name="l01888"></a>01888               x += args[0];
<a name="l01889"></a>01889               y += args[1];
<a name="l01890"></a>01890               cff_builder_add_point( builder, x, y,
<a name="l01891"></a>01891                                      (<a class="code" href="fttypes_8h.html#a1a832a256bb5a7e6e884afaa1a07f3ae">FT_Bool</a>)( count == 3 ) );
<a name="l01892"></a>01892               args += 2;
<a name="l01893"></a>01893             }
<a name="l01894"></a>01894 
<a name="l01895"></a>01895             <span class="comment">/* is last operand an x- or y-delta? */</span>
<a name="l01896"></a>01896             <span class="keywordflow">if</span> ( horizontal )
<a name="l01897"></a>01897             {
<a name="l01898"></a>01898               x += args[0];
<a name="l01899"></a>01899               y  = start_y;
<a name="l01900"></a>01900             }
<a name="l01901"></a>01901             <span class="keywordflow">else</span>
<a name="l01902"></a>01902             {
<a name="l01903"></a>01903               x  = start_x;
<a name="l01904"></a>01904               y += args[0];
<a name="l01905"></a>01905             }
<a name="l01906"></a>01906 
<a name="l01907"></a>01907             cff_builder_add_point( builder, x, y, 1 );
<a name="l01908"></a>01908 
<a name="l01909"></a>01909             args = stack;
<a name="l01910"></a>01910             <span class="keywordflow">break</span>;
<a name="l01911"></a>01911            }
<a name="l01912"></a>01912 
<a name="l01913"></a>01913         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1de43caa6ef27d55061e0dffe752e9b6">cff_op_flex</a>:
<a name="l01914"></a>01914           {
<a name="l01915"></a>01915             <a class="code" href="fttypes_8h.html#abcb8db4dbf35d2b55a9e8c7b0926dc52">FT_UInt</a>  count;
<a name="l01916"></a>01916 
<a name="l01917"></a>01917 
<a name="l01918"></a>01918             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; flex\n&quot;</span> ));
<a name="l01919"></a>01919 
<a name="l01920"></a>01920             <span class="keywordflow">if</span> ( cff_builder_start_point( builder, x, y ) ||
<a name="l01921"></a>01921                  <a class="code" href="t1decode_8c.html#abb2307d7c9ff1cfc3bf71de0f68f3174">check_points</a>( builder, 6 )               )
<a name="l01922"></a>01922               <span class="keywordflow">goto</span> Fail;
<a name="l01923"></a>01923 
<a name="l01924"></a>01924             <span class="keywordflow">for</span> ( count = 6; count &gt; 0; count-- )
<a name="l01925"></a>01925             {
<a name="l01926"></a>01926               x += args[0];
<a name="l01927"></a>01927               y += args[1];
<a name="l01928"></a>01928               cff_builder_add_point( builder, x, y,
<a name="l01929"></a>01929                                      (<a class="code" href="fttypes_8h.html#a1a832a256bb5a7e6e884afaa1a07f3ae">FT_Bool</a>)( count == 4 || count == 1 ) );
<a name="l01930"></a>01930               args += 2;
<a name="l01931"></a>01931             }
<a name="l01932"></a>01932 
<a name="l01933"></a>01933             args = stack;
<a name="l01934"></a>01934           }
<a name="l01935"></a>01935           <span class="keywordflow">break</span>;
<a name="l01936"></a>01936 
<a name="l01937"></a>01937         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a6c030c34f2bcbece80975d4ed128de0f">cff_op_seac</a>:
<a name="l01938"></a>01938             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; seac\n&quot;</span> ));
<a name="l01939"></a>01939 
<a name="l01940"></a>01940             error = cff_operator_seac( decoder,
<a name="l01941"></a>01941                                        args[0], args[1], args[2],
<a name="l01942"></a>01942                                        (<a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>)( args[3] &gt;&gt; 16 ),
<a name="l01943"></a>01943                                        (<a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>)( args[4] &gt;&gt; 16 ) );
<a name="l01944"></a>01944 
<a name="l01945"></a>01945             <span class="comment">/* add current outline to the glyph slot */</span>
<a name="l01946"></a>01946             <a class="code" href="ftgloadr_8h.html#a05e75ff8be73536b15ebbc02f432e246">FT_GlyphLoader_Add</a>( builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a358be6966e4199e54d5551f81f496a5b">loader</a> );
<a name="l01947"></a>01947 
<a name="l01948"></a>01948             <span class="comment">/* return now! */</span>
<a name="l01949"></a>01949             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot;\n&quot;</span> ));
<a name="l01950"></a>01950             <span class="keywordflow">return</span> error;
<a name="l01951"></a>01951 
<a name="l01952"></a>01952         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a02654a503c7056ffe73f7e89f870e409">cff_op_endchar</a>:
<a name="l01953"></a>01953           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; endchar\n&quot;</span> ));
<a name="l01954"></a>01954 
<a name="l01955"></a>01955           <span class="comment">/* We are going to emulate the seac operator. */</span>
<a name="l01956"></a>01956           <span class="keywordflow">if</span> ( num_args &gt;= 4 )
<a name="l01957"></a>01957           {
<a name="l01958"></a>01958             <span class="comment">/* Save glyph width so that the subglyphs don&#39;t overwrite it. */</span>
<a name="l01959"></a>01959             <a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>  glyph_width = decoder-&gt;glyph_width;
<a name="l01960"></a>01960 
<a name="l01961"></a>01961             error = cff_operator_seac( decoder,
<a name="l01962"></a>01962                                        0L, args[-4], args[-3],
<a name="l01963"></a>01963                                        (<a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>)( args[-2] &gt;&gt; 16 ),
<a name="l01964"></a>01964                                        (<a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>)( args[-1] &gt;&gt; 16 ) );
<a name="l01965"></a>01965 
<a name="l01966"></a>01966             decoder-&gt;glyph_width = glyph_width;
<a name="l01967"></a>01967           }
<a name="l01968"></a>01968           <span class="keywordflow">else</span>
<a name="l01969"></a>01969           {
<a name="l01970"></a>01970             <span class="keywordflow">if</span> ( !error )
<a name="l01971"></a>01971               error = CFF_Err_Ok;
<a name="l01972"></a>01972 
<a name="l01973"></a>01973             cff_builder_close_contour( builder );
<a name="l01974"></a>01974 
<a name="l01975"></a>01975             <span class="comment">/* close hints recording session */</span>
<a name="l01976"></a>01976             <span class="keywordflow">if</span> ( hinter )
<a name="l01977"></a>01977             {
<a name="l01978"></a>01978               <span class="keywordflow">if</span> ( hinter-&gt;<a class="code" href="struct_t2___hints___funcs_rec__.html#a7e50e26fd55254044bc9f2ba62574352">close</a>( hinter-&gt;<a class="code" href="struct_t2___hints___funcs_rec__.html#af8daab694889bede5a513fbae5f86e25">hints</a>,
<a name="l01979"></a>01979                                   builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#acd27e804cd32054865ef4236e7f9dc93">current</a>-&gt;<a class="code" href="struct_f_t___outline__.html#a7ebcf3c33231af88655534d1ac02b66e">n_points</a> ) )
<a name="l01980"></a>01980                 <span class="keywordflow">goto</span> Syntax_Error;
<a name="l01981"></a>01981 
<a name="l01982"></a>01982               <span class="comment">/* apply hints to the loaded glyph outline now */</span>
<a name="l01983"></a>01983               hinter-&gt;<a class="code" href="struct_t2___hints___funcs_rec__.html#abaf12efb416bd79cf4ce72b13e6fc68f">apply</a>( hinter-&gt;<a class="code" href="struct_t2___hints___funcs_rec__.html#af8daab694889bede5a513fbae5f86e25">hints</a>,
<a name="l01984"></a>01984                              builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#acd27e804cd32054865ef4236e7f9dc93">current</a>,
<a name="l01985"></a>01985                              (<a class="code" href="pshints_8h.html#aed4220b62b12a76456f9f47bafa5fe52">PSH_Globals</a>)builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a65eb4c3939cd9dc8a176d0f42db20137">hints_globals</a>,
<a name="l01986"></a>01986                              decoder-&gt;hint_mode );
<a name="l01987"></a>01987             }
<a name="l01988"></a>01988 
<a name="l01989"></a>01989             <span class="comment">/* add current outline to the glyph slot */</span>
<a name="l01990"></a>01990             <a class="code" href="ftgloadr_8h.html#a05e75ff8be73536b15ebbc02f432e246">FT_GlyphLoader_Add</a>( builder-&gt;<a class="code" href="struct_c_f_f___builder__.html#a358be6966e4199e54d5551f81f496a5b">loader</a> );
<a name="l01991"></a>01991           }
<a name="l01992"></a>01992 
<a name="l01993"></a>01993           <span class="comment">/* return now! */</span>
<a name="l01994"></a>01994           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot;\n&quot;</span> ));
<a name="l01995"></a>01995           <span class="keywordflow">return</span> error;
<a name="l01996"></a>01996 
<a name="l01997"></a>01997         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a9ff7938b9c372953d0823bf22338871b">cff_op_abs</a>:
<a name="l01998"></a>01998           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; abs\n&quot;</span> ));
<a name="l01999"></a>01999 
<a name="l02000"></a>02000           <span class="keywordflow">if</span> ( args[0] &lt; 0 )
<a name="l02001"></a>02001             args[0] = -args[0];
<a name="l02002"></a>02002           args++;
<a name="l02003"></a>02003           <span class="keywordflow">break</span>;
<a name="l02004"></a>02004 
<a name="l02005"></a>02005         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8aea908e6d598e2d84a5d346241f85ea4a">cff_op_add</a>:
<a name="l02006"></a>02006           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; add\n&quot;</span> ));
<a name="l02007"></a>02007 
<a name="l02008"></a>02008           args[0] += args[1];
<a name="l02009"></a>02009           args++;
<a name="l02010"></a>02010           <span class="keywordflow">break</span>;
<a name="l02011"></a>02011 
<a name="l02012"></a>02012         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a0d3347ca88c65693e926c70458ba4f6a">cff_op_sub</a>:
<a name="l02013"></a>02013           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; sub\n&quot;</span> ));
<a name="l02014"></a>02014 
<a name="l02015"></a>02015           args[0] -= args[1];
<a name="l02016"></a>02016           args++;
<a name="l02017"></a>02017           <span class="keywordflow">break</span>;
<a name="l02018"></a>02018 
<a name="l02019"></a>02019         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8acfd26a81d025112fb953a199aaefbc9b">cff_op_div</a>:
<a name="l02020"></a>02020           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; div\n&quot;</span> ));
<a name="l02021"></a>02021 
<a name="l02022"></a>02022           args[0] = <a class="code" href="freetype_8h.html#a5248df90a0d076e6543b09284face353">FT_DivFix</a>( args[0], args[1] );
<a name="l02023"></a>02023           args++;
<a name="l02024"></a>02024           <span class="keywordflow">break</span>;
<a name="l02025"></a>02025 
<a name="l02026"></a>02026         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a8b889aa9c9278033059c11c101d71790">cff_op_neg</a>:
<a name="l02027"></a>02027           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; neg\n&quot;</span> ));
<a name="l02028"></a>02028 
<a name="l02029"></a>02029           args[0] = -args[0];
<a name="l02030"></a>02030           args++;
<a name="l02031"></a>02031           <span class="keywordflow">break</span>;
<a name="l02032"></a>02032 
<a name="l02033"></a>02033         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ab9fe134cd34c62675ad21aa27165871f">cff_op_random</a>:
<a name="l02034"></a>02034           {
<a name="l02035"></a>02035             <a class="code" href="fttypes_8h.html#a5f5a679cc09f758efdd0d1c5feed3c3d">FT_Fixed</a>  Rand;
<a name="l02036"></a>02036 
<a name="l02037"></a>02037 
<a name="l02038"></a>02038             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; rand\n&quot;</span> ));
<a name="l02039"></a>02039 
<a name="l02040"></a>02040             Rand = seed;
<a name="l02041"></a>02041             <span class="keywordflow">if</span> ( Rand &gt;= 0x8000L )
<a name="l02042"></a>02042               Rand++;
<a name="l02043"></a>02043 
<a name="l02044"></a>02044             args[0] = Rand;
<a name="l02045"></a>02045             seed    = <a class="code" href="freetype_8h.html#aeb37c2858e2851e15465580de1d1d218">FT_MulFix</a>( seed, 0x10000L - seed );
<a name="l02046"></a>02046             <span class="keywordflow">if</span> ( seed == 0 )
<a name="l02047"></a>02047               seed += 0x2873;
<a name="l02048"></a>02048             args++;
<a name="l02049"></a>02049           }
<a name="l02050"></a>02050           <span class="keywordflow">break</span>;
<a name="l02051"></a>02051 
<a name="l02052"></a>02052         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8afadcf7b43479a14dfdd417327d392fe2">cff_op_mul</a>:
<a name="l02053"></a>02053           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; mul\n&quot;</span> ));
<a name="l02054"></a>02054 
<a name="l02055"></a>02055           args[0] = <a class="code" href="freetype_8h.html#aeb37c2858e2851e15465580de1d1d218">FT_MulFix</a>( args[0], args[1] );
<a name="l02056"></a>02056           args++;
<a name="l02057"></a>02057           <span class="keywordflow">break</span>;
<a name="l02058"></a>02058 
<a name="l02059"></a>02059         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ae59f88acc3553d5190e69a9576c47efd">cff_op_sqrt</a>:
<a name="l02060"></a>02060           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; sqrt\n&quot;</span> ));
<a name="l02061"></a>02061 
<a name="l02062"></a>02062           <span class="keywordflow">if</span> ( args[0] &gt; 0 )
<a name="l02063"></a>02063           {
<a name="l02064"></a>02064             <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>    count = 9;
<a name="l02065"></a>02065             <a class="code" href="fttypes_8h.html#a5f5a679cc09f758efdd0d1c5feed3c3d">FT_Fixed</a>  root  = args[0];
<a name="l02066"></a>02066             <a class="code" href="fttypes_8h.html#a5f5a679cc09f758efdd0d1c5feed3c3d">FT_Fixed</a>  new_root;
<a name="l02067"></a>02067 
<a name="l02068"></a>02068 
<a name="l02069"></a>02069             <span class="keywordflow">for</span> (;;)
<a name="l02070"></a>02070             {
<a name="l02071"></a>02071               new_root = ( root + <a class="code" href="freetype_8h.html#a5248df90a0d076e6543b09284face353">FT_DivFix</a>( args[0], root ) + 1 ) &gt;&gt; 1;
<a name="l02072"></a>02072               <span class="keywordflow">if</span> ( new_root == root || count &lt;= 0 )
<a name="l02073"></a>02073                 <span class="keywordflow">break</span>;
<a name="l02074"></a>02074               root = new_root;
<a name="l02075"></a>02075             }
<a name="l02076"></a>02076             args[0] = new_root;
<a name="l02077"></a>02077           }
<a name="l02078"></a>02078           <span class="keywordflow">else</span>
<a name="l02079"></a>02079             args[0] = 0;
<a name="l02080"></a>02080           args++;
<a name="l02081"></a>02081           <span class="keywordflow">break</span>;
<a name="l02082"></a>02082 
<a name="l02083"></a>02083         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a6f5422326afe716744562b30721c254f">cff_op_drop</a>:
<a name="l02084"></a>02084           <span class="comment">/* nothing */</span>
<a name="l02085"></a>02085           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; drop\n&quot;</span> ));
<a name="l02086"></a>02086 
<a name="l02087"></a>02087           <span class="keywordflow">break</span>;
<a name="l02088"></a>02088 
<a name="l02089"></a>02089         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1cab1f5bf47858793709680d3cac44e7">cff_op_exch</a>:
<a name="l02090"></a>02090           {
<a name="l02091"></a>02091             <a class="code" href="fttypes_8h.html#a5f5a679cc09f758efdd0d1c5feed3c3d">FT_Fixed</a>  tmp;
<a name="l02092"></a>02092 
<a name="l02093"></a>02093 
<a name="l02094"></a>02094             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; exch\n&quot;</span> ));
<a name="l02095"></a>02095 
<a name="l02096"></a>02096             tmp     = args[0];
<a name="l02097"></a>02097             args[0] = args[1];
<a name="l02098"></a>02098             args[1] = tmp;
<a name="l02099"></a>02099             args   += 2;
<a name="l02100"></a>02100           }
<a name="l02101"></a>02101           <span class="keywordflow">break</span>;
<a name="l02102"></a>02102 
<a name="l02103"></a>02103         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a01ebd6f23e1cba4d32c1449731f797d8">cff_op_index</a>:
<a name="l02104"></a>02104           {
<a name="l02105"></a>02105             <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>  idx = (<a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>)( args[0] &gt;&gt; 16 );
<a name="l02106"></a>02106 
<a name="l02107"></a>02107 
<a name="l02108"></a>02108             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; index\n&quot;</span> ));
<a name="l02109"></a>02109 
<a name="l02110"></a>02110             <span class="keywordflow">if</span> ( idx &lt; 0 )
<a name="l02111"></a>02111               idx = 0;
<a name="l02112"></a>02112             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( idx &gt; num_args - 2 )
<a name="l02113"></a>02113               idx = num_args - 2;
<a name="l02114"></a>02114             args[0] = args[-( idx + 1 )];
<a name="l02115"></a>02115             args++;
<a name="l02116"></a>02116           }
<a name="l02117"></a>02117           <span class="keywordflow">break</span>;
<a name="l02118"></a>02118 
<a name="l02119"></a>02119         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8adfefa3ebc44df5105f18d96c026709f0">cff_op_roll</a>:
<a name="l02120"></a>02120           {
<a name="l02121"></a>02121             <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>  count = (<a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>)( args[0] &gt;&gt; 16 );
<a name="l02122"></a>02122             <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>  idx   = (<a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>)( args[1] &gt;&gt; 16 );
<a name="l02123"></a>02123 
<a name="l02124"></a>02124 
<a name="l02125"></a>02125             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; roll\n&quot;</span> ));
<a name="l02126"></a>02126 
<a name="l02127"></a>02127             <span class="keywordflow">if</span> ( count &lt;= 0 )
<a name="l02128"></a>02128               count = 1;
<a name="l02129"></a>02129 
<a name="l02130"></a>02130             args -= count;
<a name="l02131"></a>02131             <span class="keywordflow">if</span> ( args &lt; stack )
<a name="l02132"></a>02132               <span class="keywordflow">goto</span> Stack_Underflow;
<a name="l02133"></a>02133 
<a name="l02134"></a>02134             <span class="keywordflow">if</span> ( idx &gt;= 0 )
<a name="l02135"></a>02135             {
<a name="l02136"></a>02136               <span class="keywordflow">while</span> ( idx &gt; 0 )
<a name="l02137"></a>02137               {
<a name="l02138"></a>02138                 <a class="code" href="fttypes_8h.html#a5f5a679cc09f758efdd0d1c5feed3c3d">FT_Fixed</a>  tmp = args[count - 1];
<a name="l02139"></a>02139                 <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>    i;
<a name="l02140"></a>02140 
<a name="l02141"></a>02141 
<a name="l02142"></a>02142                 <span class="keywordflow">for</span> ( i = count - 2; i &gt;= 0; i-- )
<a name="l02143"></a>02143                   args[i + 1] = args[i];
<a name="l02144"></a>02144                 args[0] = tmp;
<a name="l02145"></a>02145                 idx--;
<a name="l02146"></a>02146               }
<a name="l02147"></a>02147             }
<a name="l02148"></a>02148             <span class="keywordflow">else</span>
<a name="l02149"></a>02149             {
<a name="l02150"></a>02150               <span class="keywordflow">while</span> ( idx &lt; 0 )
<a name="l02151"></a>02151               {
<a name="l02152"></a>02152                 <a class="code" href="fttypes_8h.html#a5f5a679cc09f758efdd0d1c5feed3c3d">FT_Fixed</a>  tmp = args[0];
<a name="l02153"></a>02153                 <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>    i;
<a name="l02154"></a>02154 
<a name="l02155"></a>02155 
<a name="l02156"></a>02156                 <span class="keywordflow">for</span> ( i = 0; i &lt; count - 1; i++ )
<a name="l02157"></a>02157                   args[i] = args[i + 1];
<a name="l02158"></a>02158                 args[count - 1] = tmp;
<a name="l02159"></a>02159                 idx++;
<a name="l02160"></a>02160               }
<a name="l02161"></a>02161             }
<a name="l02162"></a>02162             args += count;
<a name="l02163"></a>02163           }
<a name="l02164"></a>02164           <span class="keywordflow">break</span>;
<a name="l02165"></a>02165 
<a name="l02166"></a>02166         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a434827ffa8cca1ace703ec938cdcf6d6">cff_op_dup</a>:
<a name="l02167"></a>02167           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; dup\n&quot;</span> ));
<a name="l02168"></a>02168 
<a name="l02169"></a>02169           args[1] = args[0];
<a name="l02170"></a>02170           args += 2;
<a name="l02171"></a>02171           <span class="keywordflow">break</span>;
<a name="l02172"></a>02172 
<a name="l02173"></a>02173         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8aa7bced71bc9799b0bbabe7bc9d2f1159">cff_op_put</a>:
<a name="l02174"></a>02174           {
<a name="l02175"></a>02175             <a class="code" href="fttypes_8h.html#a5f5a679cc09f758efdd0d1c5feed3c3d">FT_Fixed</a>  val = args[0];
<a name="l02176"></a>02176             <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>    idx = (<a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>)( args[1] &gt;&gt; 16 );
<a name="l02177"></a>02177 
<a name="l02178"></a>02178 
<a name="l02179"></a>02179             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; put\n&quot;</span> ));
<a name="l02180"></a>02180 
<a name="l02181"></a>02181             <span class="keywordflow">if</span> ( idx &gt;= 0 &amp;&amp; idx &lt; <a class="code" href="cffgload_8h.html#ab9cf22434ef8ea67fb31e8093fecb6e6">CFF_MAX_TRANS_ELEMENTS</a> )
<a name="l02182"></a>02182               decoder-&gt;buildchar[idx] = val;
<a name="l02183"></a>02183           }
<a name="l02184"></a>02184           <span class="keywordflow">break</span>;
<a name="l02185"></a>02185 
<a name="l02186"></a>02186         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a19906f49eeaaed1c61733f87c0d87d5b">cff_op_get</a>:
<a name="l02187"></a>02187           {
<a name="l02188"></a>02188             <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>    idx = (<a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>)( args[0] &gt;&gt; 16 );
<a name="l02189"></a>02189             <a class="code" href="fttypes_8h.html#a5f5a679cc09f758efdd0d1c5feed3c3d">FT_Fixed</a>  val = 0;
<a name="l02190"></a>02190 
<a name="l02191"></a>02191 
<a name="l02192"></a>02192             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; get\n&quot;</span> ));
<a name="l02193"></a>02193 
<a name="l02194"></a>02194             <span class="keywordflow">if</span> ( idx &gt;= 0 &amp;&amp; idx &lt; <a class="code" href="cffgload_8h.html#ab9cf22434ef8ea67fb31e8093fecb6e6">CFF_MAX_TRANS_ELEMENTS</a> )
<a name="l02195"></a>02195               val = decoder-&gt;buildchar[idx];
<a name="l02196"></a>02196 
<a name="l02197"></a>02197             args[0] = val;
<a name="l02198"></a>02198             args++;
<a name="l02199"></a>02199           }
<a name="l02200"></a>02200           <span class="keywordflow">break</span>;
<a name="l02201"></a>02201 
<a name="l02202"></a>02202         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1e70d07a4d1fd319ed5241e05a0d1172">cff_op_store</a>:
<a name="l02203"></a>02203           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; store\n&quot;</span>));
<a name="l02204"></a>02204 
<a name="l02205"></a>02205           <span class="keywordflow">goto</span> Unimplemented;
<a name="l02206"></a>02206 
<a name="l02207"></a>02207         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a7630954efe67155c39447c63dc776bc9">cff_op_load</a>:
<a name="l02208"></a>02208           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; load\n&quot;</span> ));
<a name="l02209"></a>02209 
<a name="l02210"></a>02210           <span class="keywordflow">goto</span> Unimplemented;
<a name="l02211"></a>02211 
<a name="l02212"></a>02212         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a8cfe096ad9274b8435468f9eb4a5f5e1">cff_op_dotsection</a>:
<a name="l02213"></a>02213           <span class="comment">/* this operator is deprecated and ignored by the parser */</span>
<a name="l02214"></a>02214           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; dotsection\n&quot;</span> ));
<a name="l02215"></a>02215           <span class="keywordflow">break</span>;
<a name="l02216"></a>02216 
<a name="l02217"></a>02217         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ae5d8351117021456094b6adec66e9730">cff_op_closepath</a>:
<a name="l02218"></a>02218           <span class="comment">/* this is an invalid Type 2 operator; however, there        */</span>
<a name="l02219"></a>02219           <span class="comment">/* exist fonts which are incorrectly converted from probably */</span>
<a name="l02220"></a>02220           <span class="comment">/* Type 1 to CFF, and some parsers seem to accept it         */</span>
<a name="l02221"></a>02221 
<a name="l02222"></a>02222           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; closepath (invalid op)\n&quot;</span> ));
<a name="l02223"></a>02223 
<a name="l02224"></a>02224           args = stack;
<a name="l02225"></a>02225           <span class="keywordflow">break</span>;
<a name="l02226"></a>02226 
<a name="l02227"></a>02227         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8add265fbc35078d4e9b2fb4ff63561c0f">cff_op_hsbw</a>:
<a name="l02228"></a>02228           <span class="comment">/* this is an invalid Type 2 operator; however, there        */</span>
<a name="l02229"></a>02229           <span class="comment">/* exist fonts which are incorrectly converted from probably */</span>
<a name="l02230"></a>02230           <span class="comment">/* Type 1 to CFF, and some parsers seem to accept it         */</span>
<a name="l02231"></a>02231 
<a name="l02232"></a>02232           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; hsbw (invalid op)\n&quot;</span> ));
<a name="l02233"></a>02233 
<a name="l02234"></a>02234           decoder-&gt;glyph_width = decoder-&gt;nominal_width + ( args[1] &gt;&gt; 16 );
<a name="l02235"></a>02235 
<a name="l02236"></a>02236           decoder-&gt;builder.left_bearing.x = args[0];
<a name="l02237"></a>02237           decoder-&gt;builder.left_bearing.y = 0;
<a name="l02238"></a>02238 
<a name="l02239"></a>02239           x    = decoder-&gt;builder.pos_x + args[0];
<a name="l02240"></a>02240           y    = decoder-&gt;builder.pos_y;
<a name="l02241"></a>02241           args = stack;
<a name="l02242"></a>02242           <span class="keywordflow">break</span>;
<a name="l02243"></a>02243 
<a name="l02244"></a>02244         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a8aab759e46bfd5eb4225e1a17c203224">cff_op_sbw</a>:
<a name="l02245"></a>02245           <span class="comment">/* this is an invalid Type 2 operator; however, there        */</span>
<a name="l02246"></a>02246           <span class="comment">/* exist fonts which are incorrectly converted from probably */</span>
<a name="l02247"></a>02247           <span class="comment">/* Type 1 to CFF, and some parsers seem to accept it         */</span>
<a name="l02248"></a>02248 
<a name="l02249"></a>02249           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; sbw (invalid op)\n&quot;</span> ));
<a name="l02250"></a>02250 
<a name="l02251"></a>02251           decoder-&gt;glyph_width = decoder-&gt;nominal_width + ( args[2] &gt;&gt; 16 );
<a name="l02252"></a>02252 
<a name="l02253"></a>02253           decoder-&gt;builder.left_bearing.x = args[0];
<a name="l02254"></a>02254           decoder-&gt;builder.left_bearing.y = args[1];
<a name="l02255"></a>02255 
<a name="l02256"></a>02256           x    = decoder-&gt;builder.pos_x + args[0];
<a name="l02257"></a>02257           y    = decoder-&gt;builder.pos_y + args[1];
<a name="l02258"></a>02258           args = stack;
<a name="l02259"></a>02259           <span class="keywordflow">break</span>;
<a name="l02260"></a>02260 
<a name="l02261"></a>02261         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a50d3d2e8ee9a7906069b92fc3c6882b0">cff_op_setcurrentpoint</a>:
<a name="l02262"></a>02262           <span class="comment">/* this is an invalid Type 2 operator; however, there        */</span>
<a name="l02263"></a>02263           <span class="comment">/* exist fonts which are incorrectly converted from probably */</span>
<a name="l02264"></a>02264           <span class="comment">/* Type 1 to CFF, and some parsers seem to accept it         */</span>
<a name="l02265"></a>02265 
<a name="l02266"></a>02266           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; setcurrentpoint (invalid op)\n&quot;</span> ));
<a name="l02267"></a>02267 
<a name="l02268"></a>02268           x    = decoder-&gt;builder.pos_x + args[0];
<a name="l02269"></a>02269           y    = decoder-&gt;builder.pos_y + args[1];
<a name="l02270"></a>02270           args = stack;
<a name="l02271"></a>02271           <span class="keywordflow">break</span>;
<a name="l02272"></a>02272 
<a name="l02273"></a>02273         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a60ddfb0898b726aae8da343b41ec0e74">cff_op_callothersubr</a>:
<a name="l02274"></a>02274           <span class="comment">/* this is an invalid Type 2 operator; however, there        */</span>
<a name="l02275"></a>02275           <span class="comment">/* exist fonts which are incorrectly converted from probably */</span>
<a name="l02276"></a>02276           <span class="comment">/* Type 1 to CFF, and some parsers seem to accept it         */</span>
<a name="l02277"></a>02277 
<a name="l02278"></a>02278           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; callothersubr (invalid op)\n&quot;</span> ));
<a name="l02279"></a>02279 
<a name="l02280"></a>02280           <span class="comment">/* subsequent `pop&#39; operands should add the arguments,       */</span>
<a name="l02281"></a>02281           <span class="comment">/* this is the implementation described for `unknown&#39; other  */</span>
<a name="l02282"></a>02282           <span class="comment">/* subroutines in the Type1 spec.                            */</span>
<a name="l02283"></a>02283           <span class="comment">/*                                                           */</span>
<a name="l02284"></a>02284           <span class="comment">/* XXX Fix return arguments (see discussion below).          */</span>
<a name="l02285"></a>02285           args -= 2 + ( args[-2] &gt;&gt; 16 );
<a name="l02286"></a>02286           <span class="keywordflow">if</span> ( args &lt; stack )
<a name="l02287"></a>02287             <span class="keywordflow">goto</span> Stack_Underflow;
<a name="l02288"></a>02288           <span class="keywordflow">break</span>;
<a name="l02289"></a>02289 
<a name="l02290"></a>02290         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a5d0b67133e29eef802f38c844539f794">cff_op_pop</a>:
<a name="l02291"></a>02291           <span class="comment">/* this is an invalid Type 2 operator; however, there        */</span>
<a name="l02292"></a>02292           <span class="comment">/* exist fonts which are incorrectly converted from probably */</span>
<a name="l02293"></a>02293           <span class="comment">/* Type 1 to CFF, and some parsers seem to accept it         */</span>
<a name="l02294"></a>02294 
<a name="l02295"></a>02295           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; pop (invalid op)\n&quot;</span> ));
<a name="l02296"></a>02296 
<a name="l02297"></a>02297           <span class="comment">/* XXX Increasing `args&#39; is wrong: After a certain number of */</span>
<a name="l02298"></a>02298           <span class="comment">/* `pop&#39;s we get a stack overflow.  Reason for doing it is   */</span>
<a name="l02299"></a>02299           <span class="comment">/* code like this (actually found in a CFF font):            */</span>
<a name="l02300"></a>02300           <span class="comment">/*                                                           */</span>
<a name="l02301"></a>02301           <span class="comment">/*   17 1 3 callothersubr                                    */</span>
<a name="l02302"></a>02302           <span class="comment">/*   pop                                                     */</span>
<a name="l02303"></a>02303           <span class="comment">/*   callsubr                                                */</span>
<a name="l02304"></a>02304           <span class="comment">/*                                                           */</span>
<a name="l02305"></a>02305           <span class="comment">/* Since we handle `callothersubr&#39; as a no-op, and           */</span>
<a name="l02306"></a>02306           <span class="comment">/* `callsubr&#39; needs at least one argument, `pop&#39; can&#39;t be a  */</span>
<a name="l02307"></a>02307           <span class="comment">/* no-op too as it basically should be.                      */</span>
<a name="l02308"></a>02308           <span class="comment">/*                                                           */</span>
<a name="l02309"></a>02309           <span class="comment">/* The right solution would be to provide real support for   */</span>
<a name="l02310"></a>02310           <span class="comment">/* `callothersubr&#39; as done in `t1decode.c&#39;, however, given   */</span>
<a name="l02311"></a>02311           <span class="comment">/* the fact that CFF fonts with `pop&#39; are invalid, it is     */</span>
<a name="l02312"></a>02312           <span class="comment">/* questionable whether it is worth the time.                */</span>
<a name="l02313"></a>02313           args++;
<a name="l02314"></a>02314           <span class="keywordflow">break</span>;
<a name="l02315"></a>02315 
<a name="l02316"></a>02316         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a198c30b3f96e38397a4f96e35287dfca">cff_op_and</a>:
<a name="l02317"></a>02317           {
<a name="l02318"></a>02318             <a class="code" href="fttypes_8h.html#a5f5a679cc09f758efdd0d1c5feed3c3d">FT_Fixed</a>  cond = args[0] &amp;&amp; args[1];
<a name="l02319"></a>02319 
<a name="l02320"></a>02320 
<a name="l02321"></a>02321             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; and\n&quot;</span> ));
<a name="l02322"></a>02322 
<a name="l02323"></a>02323             args[0] = cond ? 0x10000L : 0;
<a name="l02324"></a>02324             args++;
<a name="l02325"></a>02325           }
<a name="l02326"></a>02326           <span class="keywordflow">break</span>;
<a name="l02327"></a>02327 
<a name="l02328"></a>02328         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8ab5e02727b9ceab6a991509dde7a68c51">cff_op_or</a>:
<a name="l02329"></a>02329           {
<a name="l02330"></a>02330             <a class="code" href="fttypes_8h.html#a5f5a679cc09f758efdd0d1c5feed3c3d">FT_Fixed</a>  cond = args[0] || args[1];
<a name="l02331"></a>02331 
<a name="l02332"></a>02332 
<a name="l02333"></a>02333             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; or\n&quot;</span> ));
<a name="l02334"></a>02334 
<a name="l02335"></a>02335             args[0] = cond ? 0x10000L : 0;
<a name="l02336"></a>02336             args++;
<a name="l02337"></a>02337           }
<a name="l02338"></a>02338           <span class="keywordflow">break</span>;
<a name="l02339"></a>02339 
<a name="l02340"></a>02340         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a1f4894f49b12e28c9ee89542194ce287">cff_op_eq</a>:
<a name="l02341"></a>02341           {
<a name="l02342"></a>02342             <a class="code" href="fttypes_8h.html#a5f5a679cc09f758efdd0d1c5feed3c3d">FT_Fixed</a>  cond = !args[0];
<a name="l02343"></a>02343 
<a name="l02344"></a>02344 
<a name="l02345"></a>02345             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; eq\n&quot;</span> ));
<a name="l02346"></a>02346 
<a name="l02347"></a>02347             args[0] = cond ? 0x10000L : 0;
<a name="l02348"></a>02348             args++;
<a name="l02349"></a>02349           }
<a name="l02350"></a>02350           <span class="keywordflow">break</span>;
<a name="l02351"></a>02351 
<a name="l02352"></a>02352         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a3dd3b124503056cb7f2dbf6c34e5303a">cff_op_ifelse</a>:
<a name="l02353"></a>02353           {
<a name="l02354"></a>02354             <a class="code" href="fttypes_8h.html#a5f5a679cc09f758efdd0d1c5feed3c3d">FT_Fixed</a>  cond = ( args[2] &lt;= args[3] );
<a name="l02355"></a>02355 
<a name="l02356"></a>02356 
<a name="l02357"></a>02357             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; ifelse\n&quot;</span> ));
<a name="l02358"></a>02358 
<a name="l02359"></a>02359             <span class="keywordflow">if</span> ( !cond )
<a name="l02360"></a>02360               args[0] = args[1];
<a name="l02361"></a>02361             args++;
<a name="l02362"></a>02362           }
<a name="l02363"></a>02363           <span class="keywordflow">break</span>;
<a name="l02364"></a>02364 
<a name="l02365"></a>02365         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a96b69ad3ec477d065eb9aea0289ca594">cff_op_callsubr</a>:
<a name="l02366"></a>02366           {
<a name="l02367"></a>02367             <a class="code" href="fttypes_8h.html#abcb8db4dbf35d2b55a9e8c7b0926dc52">FT_UInt</a>  idx = (<a class="code" href="fttypes_8h.html#abcb8db4dbf35d2b55a9e8c7b0926dc52">FT_UInt</a>)( ( args[0] &gt;&gt; 16 ) +
<a name="l02368"></a>02368                                       decoder-&gt;locals_bias );
<a name="l02369"></a>02369 
<a name="l02370"></a>02370 
<a name="l02371"></a>02371             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; callsubr(%d)\n&quot;</span>, idx ));
<a name="l02372"></a>02372 
<a name="l02373"></a>02373             <span class="keywordflow">if</span> ( idx &gt;= decoder-&gt;num_locals )
<a name="l02374"></a>02374             {
<a name="l02375"></a>02375               <a class="code" href="ftdebug_8h.html#a311092b5a8fece0a17cfb5b2d874e25d">FT_ERROR</a>(( <span class="stringliteral">&quot;cff_decoder_parse_charstrings:&quot;</span>
<a name="l02376"></a>02376                          <span class="stringliteral">&quot; invalid local subr index\n&quot;</span> ));
<a name="l02377"></a>02377               <span class="keywordflow">goto</span> Syntax_Error;
<a name="l02378"></a>02378             }
<a name="l02379"></a>02379 
<a name="l02380"></a>02380             <span class="keywordflow">if</span> ( zone - decoder-&gt;zones &gt;= <a class="code" href="cffgload_8h.html#a5e4d826e5f8e59a46314f87baa0b396a">CFF_MAX_SUBRS_CALLS</a> )
<a name="l02381"></a>02381             {
<a name="l02382"></a>02382               <a class="code" href="ftdebug_8h.html#a311092b5a8fece0a17cfb5b2d874e25d">FT_ERROR</a>(( <span class="stringliteral">&quot;cff_decoder_parse_charstrings:&quot;</span>
<a name="l02383"></a>02383                          <span class="stringliteral">&quot; too many nested subrs\n&quot;</span> ));
<a name="l02384"></a>02384               <span class="keywordflow">goto</span> Syntax_Error;
<a name="l02385"></a>02385             }
<a name="l02386"></a>02386 
<a name="l02387"></a>02387             zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#a5ac12c9c151964cee76b5b11e5c22453">cursor</a> = ip;  <span class="comment">/* save current instruction pointer */</span>
<a name="l02388"></a>02388 
<a name="l02389"></a>02389             zone++;
<a name="l02390"></a>02390             zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#adffd8270fea17f125a1615d7a6cc09c2">base</a>   = decoder-&gt;locals[idx];
<a name="l02391"></a>02391             zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#ad3e3efa2e2b7dd69292757fbf7e63e53">limit</a>  = decoder-&gt;locals[idx + 1];
<a name="l02392"></a>02392             zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#a5ac12c9c151964cee76b5b11e5c22453">cursor</a> = zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#adffd8270fea17f125a1615d7a6cc09c2">base</a>;
<a name="l02393"></a>02393 
<a name="l02394"></a>02394             <span class="keywordflow">if</span> ( !zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#adffd8270fea17f125a1615d7a6cc09c2">base</a> || zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#ad3e3efa2e2b7dd69292757fbf7e63e53">limit</a> == zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#adffd8270fea17f125a1615d7a6cc09c2">base</a> )
<a name="l02395"></a>02395             {
<a name="l02396"></a>02396               <a class="code" href="ftdebug_8h.html#a311092b5a8fece0a17cfb5b2d874e25d">FT_ERROR</a>(( <span class="stringliteral">&quot;cff_decoder_parse_charstrings:&quot;</span>
<a name="l02397"></a>02397                          <span class="stringliteral">&quot; invoking empty subrs\n&quot;</span> ));
<a name="l02398"></a>02398               <span class="keywordflow">goto</span> Syntax_Error;
<a name="l02399"></a>02399             }
<a name="l02400"></a>02400 
<a name="l02401"></a>02401             decoder-&gt;zone = zone;
<a name="l02402"></a>02402             ip            = zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#adffd8270fea17f125a1615d7a6cc09c2">base</a>;
<a name="l02403"></a>02403             limit         = zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#ad3e3efa2e2b7dd69292757fbf7e63e53">limit</a>;
<a name="l02404"></a>02404           }
<a name="l02405"></a>02405           <span class="keywordflow">break</span>;
<a name="l02406"></a>02406 
<a name="l02407"></a>02407         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8a57546c33757242ac87da1e294caca2cd">cff_op_callgsubr</a>:
<a name="l02408"></a>02408           {
<a name="l02409"></a>02409             <a class="code" href="fttypes_8h.html#abcb8db4dbf35d2b55a9e8c7b0926dc52">FT_UInt</a>  idx = (<a class="code" href="fttypes_8h.html#abcb8db4dbf35d2b55a9e8c7b0926dc52">FT_UInt</a>)( ( args[0] &gt;&gt; 16 ) +
<a name="l02410"></a>02410                                       decoder-&gt;globals_bias );
<a name="l02411"></a>02411 
<a name="l02412"></a>02412 
<a name="l02413"></a>02413             <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; callgsubr(%d)\n&quot;</span>, idx ));
<a name="l02414"></a>02414 
<a name="l02415"></a>02415             <span class="keywordflow">if</span> ( idx &gt;= decoder-&gt;num_globals )
<a name="l02416"></a>02416             {
<a name="l02417"></a>02417               <a class="code" href="ftdebug_8h.html#a311092b5a8fece0a17cfb5b2d874e25d">FT_ERROR</a>(( <span class="stringliteral">&quot;cff_decoder_parse_charstrings:&quot;</span>
<a name="l02418"></a>02418                          <span class="stringliteral">&quot; invalid global subr index\n&quot;</span> ));
<a name="l02419"></a>02419               <span class="keywordflow">goto</span> Syntax_Error;
<a name="l02420"></a>02420             }
<a name="l02421"></a>02421 
<a name="l02422"></a>02422             <span class="keywordflow">if</span> ( zone - decoder-&gt;zones &gt;= <a class="code" href="cffgload_8h.html#a5e4d826e5f8e59a46314f87baa0b396a">CFF_MAX_SUBRS_CALLS</a> )
<a name="l02423"></a>02423             {
<a name="l02424"></a>02424               <a class="code" href="ftdebug_8h.html#a311092b5a8fece0a17cfb5b2d874e25d">FT_ERROR</a>(( <span class="stringliteral">&quot;cff_decoder_parse_charstrings:&quot;</span>
<a name="l02425"></a>02425                          <span class="stringliteral">&quot; too many nested subrs\n&quot;</span> ));
<a name="l02426"></a>02426               <span class="keywordflow">goto</span> Syntax_Error;
<a name="l02427"></a>02427             }
<a name="l02428"></a>02428 
<a name="l02429"></a>02429             zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#a5ac12c9c151964cee76b5b11e5c22453">cursor</a> = ip;  <span class="comment">/* save current instruction pointer */</span>
<a name="l02430"></a>02430 
<a name="l02431"></a>02431             zone++;
<a name="l02432"></a>02432             zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#adffd8270fea17f125a1615d7a6cc09c2">base</a>   = decoder-&gt;globals[idx];
<a name="l02433"></a>02433             zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#ad3e3efa2e2b7dd69292757fbf7e63e53">limit</a>  = decoder-&gt;globals[idx + 1];
<a name="l02434"></a>02434             zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#a5ac12c9c151964cee76b5b11e5c22453">cursor</a> = zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#adffd8270fea17f125a1615d7a6cc09c2">base</a>;
<a name="l02435"></a>02435 
<a name="l02436"></a>02436             <span class="keywordflow">if</span> ( !zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#adffd8270fea17f125a1615d7a6cc09c2">base</a> || zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#ad3e3efa2e2b7dd69292757fbf7e63e53">limit</a> == zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#adffd8270fea17f125a1615d7a6cc09c2">base</a> )
<a name="l02437"></a>02437             {
<a name="l02438"></a>02438               <a class="code" href="ftdebug_8h.html#a311092b5a8fece0a17cfb5b2d874e25d">FT_ERROR</a>(( <span class="stringliteral">&quot;cff_decoder_parse_charstrings:&quot;</span>
<a name="l02439"></a>02439                          <span class="stringliteral">&quot; invoking empty subrs\n&quot;</span> ));
<a name="l02440"></a>02440               <span class="keywordflow">goto</span> Syntax_Error;
<a name="l02441"></a>02441             }
<a name="l02442"></a>02442 
<a name="l02443"></a>02443             decoder-&gt;zone = zone;
<a name="l02444"></a>02444             ip            = zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#adffd8270fea17f125a1615d7a6cc09c2">base</a>;
<a name="l02445"></a>02445             limit         = zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#ad3e3efa2e2b7dd69292757fbf7e63e53">limit</a>;
<a name="l02446"></a>02446           }
<a name="l02447"></a>02447           <span class="keywordflow">break</span>;
<a name="l02448"></a>02448 
<a name="l02449"></a>02449         <span class="keywordflow">case</span> <a class="code" href="cffgload_8c.html#a067cb784f09b7b8fbeea25bed36cd0b8aef3f2f049d5593f2fd6db5c34a3d3937">cff_op_return</a>:
<a name="l02450"></a>02450           <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot; return\n&quot;</span> ));
<a name="l02451"></a>02451 
<a name="l02452"></a>02452           <span class="keywordflow">if</span> ( decoder-&gt;zone &lt;= decoder-&gt;zones )
<a name="l02453"></a>02453           {
<a name="l02454"></a>02454             <a class="code" href="ftdebug_8h.html#a311092b5a8fece0a17cfb5b2d874e25d">FT_ERROR</a>(( <span class="stringliteral">&quot;cff_decoder_parse_charstrings:&quot;</span>
<a name="l02455"></a>02455                        <span class="stringliteral">&quot; unexpected return\n&quot;</span> ));
<a name="l02456"></a>02456             <span class="keywordflow">goto</span> Syntax_Error;
<a name="l02457"></a>02457           }
<a name="l02458"></a>02458 
<a name="l02459"></a>02459           decoder-&gt;zone--;
<a name="l02460"></a>02460           zone  = decoder-&gt;zone;
<a name="l02461"></a>02461           ip    = zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#a5ac12c9c151964cee76b5b11e5c22453">cursor</a>;
<a name="l02462"></a>02462           limit = zone-&gt;<a class="code" href="struct_c_f_f___decoder___zone__.html#ad3e3efa2e2b7dd69292757fbf7e63e53">limit</a>;
<a name="l02463"></a>02463           <span class="keywordflow">break</span>;
<a name="l02464"></a>02464 
<a name="l02465"></a>02465         <span class="keywordflow">default</span>:
<a name="l02466"></a>02466         Unimplemented:
<a name="l02467"></a>02467           <a class="code" href="ftdebug_8h.html#a311092b5a8fece0a17cfb5b2d874e25d">FT_ERROR</a>(( <span class="stringliteral">&quot;Unimplemented opcode: %d&quot;</span>, ip[-1] ));
<a name="l02468"></a>02468 
<a name="l02469"></a>02469           <span class="keywordflow">if</span> ( ip[-1] == 12 )
<a name="l02470"></a>02470             <a class="code" href="ftdebug_8h.html#a311092b5a8fece0a17cfb5b2d874e25d">FT_ERROR</a>(( <span class="stringliteral">&quot; %d&quot;</span>, ip[0] ));
<a name="l02471"></a>02471           <a class="code" href="ftdebug_8h.html#a311092b5a8fece0a17cfb5b2d874e25d">FT_ERROR</a>(( <span class="stringliteral">&quot;\n&quot;</span> ));
<a name="l02472"></a>02472 
<a name="l02473"></a>02473           <span class="keywordflow">return</span> CFF_Err_Unimplemented_Feature;
<a name="l02474"></a>02474         }
<a name="l02475"></a>02475 
<a name="l02476"></a>02476         decoder-&gt;top = args;
<a name="l02477"></a>02477 
<a name="l02478"></a>02478         <span class="keywordflow">if</span> ( decoder-&gt;top - stack &gt;= <a class="code" href="cffgload_8h.html#a367507992a6ffd2188b3e6b257884855">CFF_MAX_OPERANDS</a> )
<a name="l02479"></a>02479           <span class="keywordflow">goto</span> Stack_Overflow;
<a name="l02480"></a>02480 
<a name="l02481"></a>02481       } <span class="comment">/* general operator processing */</span>
<a name="l02482"></a>02482 
<a name="l02483"></a>02483     } <span class="comment">/* while ip &lt; limit */</span>
<a name="l02484"></a>02484 
<a name="l02485"></a>02485     <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot;..end..\n\n&quot;</span> ));
<a name="l02486"></a>02486 
<a name="l02487"></a>02487   Fail:
<a name="l02488"></a>02488     <span class="keywordflow">return</span> error;
<a name="l02489"></a>02489 
<a name="l02490"></a>02490   Syntax_Error:
<a name="l02491"></a>02491     <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot;cff_decoder_parse_charstrings: syntax error\n&quot;</span> ));
<a name="l02492"></a>02492     <span class="keywordflow">return</span> CFF_Err_Invalid_File_Format;
<a name="l02493"></a>02493 
<a name="l02494"></a>02494   Stack_Underflow:
<a name="l02495"></a>02495     <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot;cff_decoder_parse_charstrings: stack underflow\n&quot;</span> ));
<a name="l02496"></a>02496     <span class="keywordflow">return</span> CFF_Err_Too_Few_Arguments;
<a name="l02497"></a>02497 
<a name="l02498"></a>02498   Stack_Overflow:
<a name="l02499"></a>02499     <a class="code" href="ftdebug_8h.html#ad7e98818b876c5493b441d7516bf34a0">FT_TRACE4</a>(( <span class="stringliteral">&quot;cff_decoder_parse_charstrings: stack overflow\n&quot;</span> ));
<a name="l02500"></a>02500     <span class="keywordflow">return</span> CFF_Err_Stack_Overflow;
<a name="l02501"></a>02501   }
<a name="l02502"></a>02502 
<a name="l02503"></a>02503 
<a name="l02504"></a>02504   <span class="comment">/*************************************************************************/</span>
<a name="l02505"></a>02505   <span class="comment">/*************************************************************************/</span>
<a name="l02506"></a>02506   <span class="comment">/*************************************************************************/</span>
<a name="l02507"></a>02507   <span class="comment">/**********                                                      *********/</span>
<a name="l02508"></a>02508   <span class="comment">/**********                                                      *********/</span>
<a name="l02509"></a>02509   <span class="comment">/**********            COMPUTE THE MAXIMUM ADVANCE WIDTH         *********/</span>
<a name="l02510"></a>02510   <span class="comment">/**********                                                      *********/</span>
<a name="l02511"></a>02511   <span class="comment">/**********    The following code is in charge of computing      *********/</span>
<a name="l02512"></a>02512   <span class="comment">/**********    the maximum advance width of the font.  It        *********/</span>
<a name="l02513"></a>02513   <span class="comment">/**********    quickly processes each glyph charstring to        *********/</span>
<a name="l02514"></a>02514   <span class="comment">/**********    extract the value from either a `sbw&#39; or `seac&#39;   *********/</span>
<a name="l02515"></a>02515   <span class="comment">/**********    operator.                                         *********/</span>
<a name="l02516"></a>02516   <span class="comment">/**********                                                      *********/</span>
<a name="l02517"></a>02517   <span class="comment">/*************************************************************************/</span>
<a name="l02518"></a>02518   <span class="comment">/*************************************************************************/</span>
<a name="l02519"></a>02519   <span class="comment">/*************************************************************************/</span>
<a name="l02520"></a>02520 
<a name="l02521"></a>02521 
<a name="l02522"></a>02522 <span class="preprocessor">#if 0 </span><span class="comment">/* unused until we support pure CFF fonts */</span>
<a name="l02523"></a>02523 
<a name="l02524"></a>02524 
<a name="l02525"></a>02525   <a class="code" href="ftconfig_8h.html#a065cda933183dff5dc368794eefa7c93">FT_LOCAL_DEF</a>( <a class="code" href="fttypes_8h.html#a64c8060bdb3d6eec844a1bf670e06bdd">FT_Error</a> )
<a name="l02526"></a>02526   cff_compute_max_advance( <a class="code" href="struct_t_t___face_rec__.html">TT_Face</a>  face,
<a name="l02527"></a>02527                            <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>*  max_advance )
<a name="l02528"></a>02528   {
<a name="l02529"></a>02529     <a class="code" href="fttypes_8h.html#a64c8060bdb3d6eec844a1bf670e06bdd">FT_Error</a>     error = CFF_Err_Ok;
<a name="l02530"></a>02530     <a class="code" href="struct_c_f_f___decoder__.html">CFF_Decoder</a>  decoder;
<a name="l02531"></a>02531     <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>       glyph_index;
<a name="l02532"></a>02532     <a class="code" href="struct_c_f_f___font_rec__.html">CFF_Font</a>     cff = (<a class="code" href="cfftypes_8h.html#a5e0f673b92ece4958ef2cc9b54ca4f44">CFF_Font</a>)face-&gt;other;
<a name="l02533"></a>02533 
<a name="l02534"></a>02534 
<a name="l02535"></a>02535     *max_advance = 0;
<a name="l02536"></a>02536 
<a name="l02537"></a>02537     <span class="comment">/* Initialize load decoder */</span>
<a name="l02538"></a>02538     <a class="code" href="cffgload_8c.html#a8bbc0e91ca59bd98aa5f749ac2dc1f9e">cff_decoder_init</a>( &amp;decoder, face, 0, 0, 0, 0 );
<a name="l02539"></a>02539 
<a name="l02540"></a>02540     decoder.<a class="code" href="struct_c_f_f___decoder__.html#a1974266e7e164100b88c75fc05a15303">builder</a>.<a class="code" href="struct_c_f_f___builder__.html#a649801f2012fc5927cc2647fbb71609d">metrics_only</a> = 1;
<a name="l02541"></a>02541     decoder.<a class="code" href="struct_c_f_f___decoder__.html#a1974266e7e164100b88c75fc05a15303">builder</a>.<a class="code" href="struct_c_f_f___builder__.html#abcce85e0ee7ffe37e1cbd3d6cea110c2">load_points</a>  = 0;
<a name="l02542"></a>02542 
<a name="l02543"></a>02543     <span class="comment">/* For each glyph, parse the glyph charstring and extract */</span>
<a name="l02544"></a>02544     <span class="comment">/* the advance width.                                     */</span>
<a name="l02545"></a>02545     <span class="keywordflow">for</span> ( glyph_index = 0; glyph_index &lt; face-&gt;root.num_glyphs;
<a name="l02546"></a>02546           glyph_index++ )
<a name="l02547"></a>02547     {
<a name="l02548"></a>02548       <a class="code" href="fttypes_8h.html#a51f26183ca0c9f4af958939648caeccd">FT_Byte</a>*  charstring;
<a name="l02549"></a>02549       <a class="code" href="fttypes_8h.html#a4fac88bdba78eb76b505efa6e4fbf3f5">FT_ULong</a>  charstring_len;
<a name="l02550"></a>02550 
<a name="l02551"></a>02551 
<a name="l02552"></a>02552       <span class="comment">/* now get load the unscaled outline */</span>
<a name="l02553"></a>02553       error = cff_get_glyph_data( face, glyph_index,
<a name="l02554"></a>02554                                   &amp;charstring, &amp;charstring_len );
<a name="l02555"></a>02555       <span class="keywordflow">if</span> ( !error )
<a name="l02556"></a>02556       {
<a name="l02557"></a>02557         error = <a class="code" href="cffgload_8c.html#a560ec3f07b5b59462a7d3199cd1df656">cff_decoder_prepare</a>( &amp;decoder, size, glyph_index );
<a name="l02558"></a>02558         <span class="keywordflow">if</span> ( !error )
<a name="l02559"></a>02559           error = <a class="code" href="cffgload_8c.html#a04ab294b7e8ed9309f8ac19a1485148b">cff_decoder_parse_charstrings</a>( &amp;decoder,
<a name="l02560"></a>02560                                                  charstring,
<a name="l02561"></a>02561                                                  charstring_len );
<a name="l02562"></a>02562 
<a name="l02563"></a>02563         cff_free_glyph_data( face, &amp;charstring, &amp;charstring_len );
<a name="l02564"></a>02564       }
<a name="l02565"></a>02565 
<a name="l02566"></a>02566       <span class="comment">/* ignore the error if one has occurred -- skip to next glyph */</span>
<a name="l02567"></a>02567       error = CFF_Err_Ok;
<a name="l02568"></a>02568     }
<a name="l02569"></a>02569 
<a name="l02570"></a>02570     *max_advance = decoder.<a class="code" href="struct_c_f_f___decoder__.html#a1974266e7e164100b88c75fc05a15303">builder</a>.<a class="code" href="struct_c_f_f___builder__.html#a943906425298bbbdc85e7a6d626224b5">advance</a>.<a class="code" href="struct_f_t___vector__.html#a941e818e6dfca06409cddff4f325f74c">x</a>;
<a name="l02571"></a>02571 
<a name="l02572"></a>02572     <span class="keywordflow">return</span> CFF_Err_Ok;
<a name="l02573"></a>02573   }
<a name="l02574"></a>02574 
<a name="l02575"></a>02575 
<a name="l02576"></a>02576 <span class="preprocessor">#endif </span><span class="comment">/* 0 */</span>
<a name="l02577"></a>02577 
<a name="l02578"></a>02578 
<a name="l02579"></a>02579   <a class="code" href="ftconfig_8h.html#a065cda933183dff5dc368794eefa7c93">FT_LOCAL_DEF</a>( <a class="code" href="fttypes_8h.html#a64c8060bdb3d6eec844a1bf670e06bdd">FT_Error</a> )
<a name="l02580"></a><a class="code" href="cffgload_8h.html#a419a19342ade0454d7ca77044d5ad127">02580</a>   <a class="code" href="cffgload_8c.html#a419a19342ade0454d7ca77044d5ad127">cff_slot_load</a>( <a class="code" href="struct_c_f_f___glyph_slot_rec__.html">CFF_GlyphSlot</a>  glyph,
<a name="l02581"></a>02581                  <a class="code" href="struct_c_f_f___size_rec__.html">CFF_Size</a>       size,
<a name="l02582"></a>02582                  <a class="code" href="fttypes_8h.html#abcb8db4dbf35d2b55a9e8c7b0926dc52">FT_UInt</a>        glyph_index,
<a name="l02583"></a>02583                  FT_Int32       load_flags )
<a name="l02584"></a>02584   {
<a name="l02585"></a>02585     <a class="code" href="fttypes_8h.html#a64c8060bdb3d6eec844a1bf670e06bdd">FT_Error</a>     error;
<a name="l02586"></a>02586     <a class="code" href="struct_c_f_f___decoder__.html">CFF_Decoder</a>  decoder;
<a name="l02587"></a>02587     <a class="code" href="struct_t_t___face_rec__.html">TT_Face</a>      face = (<a class="code" href="tttypes_8h.html#a4579aa38b4b171acee676ce82638952c">TT_Face</a>)glyph-&gt;<a class="code" href="struct_t_t___face_rec__.html#ab07a1f6ce2cffe73a5501fb33164ae74">root</a>.face;
<a name="l02588"></a>02588     <a class="code" href="fttypes_8h.html#a1a832a256bb5a7e6e884afaa1a07f3ae">FT_Bool</a>      hinting, force_scaling;
<a name="l02589"></a>02589     <a class="code" href="struct_c_f_f___font_rec__.html">CFF_Font</a>     cff  = (<a class="code" href="struct_c_f_f___font_rec__.html">CFF_Font</a>)face-&gt;<a class="code" href="struct_t_t___face_rec__.html#ab1ffe97c9ad4f20c71069b6b9bf005ee">extra</a>.<a class="code" href="struct_f_t___generic__.html#af0bf8b983254b662f293e9a20505e27e">data</a>;
<a name="l02590"></a>02590 
<a name="l02591"></a>02591     <a class="code" href="struct_f_t___matrix__.html">FT_Matrix</a>    font_matrix;
<a name="l02592"></a>02592     <a class="code" href="struct_f_t___vector__.html">FT_Vector</a>    font_offset;
<a name="l02593"></a>02593 
<a name="l02594"></a>02594 
<a name="l02595"></a>02595     force_scaling = <a class="code" href="ftobjs_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l02596"></a>02596 
<a name="l02597"></a>02597     <span class="comment">/* in a CID-keyed font, consider `glyph_index&#39; as a CID and map */</span>
<a name="l02598"></a>02598     <span class="comment">/* it immediately to the real glyph_index -- if it isn&#39;t a      */</span>
<a name="l02599"></a>02599     <span class="comment">/* subsetted font, glyph_indices and CIDs are identical, though */</span>
<a name="l02600"></a>02600     <span class="keywordflow">if</span> ( cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a62120839c2d743718806b72799e3af67">top_font</a>.<a class="code" href="struct_c_f_f___sub_font_rec__.html#af23b698ce981c661db031c834475ddb2">font_dict</a>.<a class="code" href="struct_c_f_f___font_rec_dict_rec__.html#a5e206c34867f164841fe2134d47b3cc0">cid_registry</a> != 0xFFFFU &amp;&amp;
<a name="l02601"></a>02601          cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a47a0be8fcc4abce3751656a4f08c3f77">charset</a>.<a class="code" href="struct_c_f_f___charset_rec__.html#a54f2abbf89cfe39f8f52593e99936033">cids</a>                               )
<a name="l02602"></a>02602     {
<a name="l02603"></a>02603       <span class="comment">/* don&#39;t handle CID 0 (.notdef) which is directly mapped to GID 0 */</span>
<a name="l02604"></a>02604       <span class="keywordflow">if</span> ( glyph_index != 0 )
<a name="l02605"></a>02605       {
<a name="l02606"></a>02606         glyph_index = <a class="code" href="cffload_8c.html#a2f21bc706804b95a3ab1264dc66d3865">cff_charset_cid_to_gindex</a>( &amp;cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a47a0be8fcc4abce3751656a4f08c3f77">charset</a>,
<a name="l02607"></a>02607                                                  glyph_index );
<a name="l02608"></a>02608         <span class="keywordflow">if</span> ( glyph_index == 0 )
<a name="l02609"></a>02609           <span class="keywordflow">return</span> CFF_Err_Invalid_Argument;
<a name="l02610"></a>02610       }
<a name="l02611"></a>02611     }
<a name="l02612"></a>02612     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( glyph_index &gt;= cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#af938965b67a100d7e1a487059321c3d6">num_glyphs</a> )
<a name="l02613"></a>02613       <span class="keywordflow">return</span> CFF_Err_Invalid_Argument;
<a name="l02614"></a>02614 
<a name="l02615"></a>02615     <span class="keywordflow">if</span> ( load_flags &amp; <a class="code" href="freetype_8h.html#a2a12be302a988f3412a5191db419c5e2">FT_LOAD_NO_RECURSE</a> )
<a name="l02616"></a>02616       load_flags |= <a class="code" href="freetype_8h.html#a1ae5e2e14c90bb98bde52e5412a8f23f">FT_LOAD_NO_SCALE</a> | <a class="code" href="freetype_8h.html#a4d3657db8d87688e93601201d0524e38">FT_LOAD_NO_HINTING</a>;
<a name="l02617"></a>02617 
<a name="l02618"></a>02618     glyph-&gt;x_scale = 0x10000L;
<a name="l02619"></a>02619     glyph-&gt;y_scale = 0x10000L;
<a name="l02620"></a>02620     <span class="keywordflow">if</span> ( size )
<a name="l02621"></a>02621     {
<a name="l02622"></a>02622       glyph-&gt;x_scale = size-&gt;root.metrics.x_scale;
<a name="l02623"></a>02623       glyph-&gt;y_scale = size-&gt;root.metrics.y_scale;
<a name="l02624"></a>02624     }
<a name="l02625"></a>02625 
<a name="l02626"></a>02626 <span class="preprocessor">#ifdef TT_CONFIG_OPTION_EMBEDDED_BITMAPS</span>
<a name="l02627"></a>02627 <span class="preprocessor"></span>
<a name="l02628"></a>02628     <span class="comment">/* try to load embedded bitmap if any              */</span>
<a name="l02629"></a>02629     <span class="comment">/*                                                 */</span>
<a name="l02630"></a>02630     <span class="comment">/* XXX: The convention should be emphasized in     */</span>
<a name="l02631"></a>02631     <span class="comment">/*      the documents because it can be confusing. */</span>
<a name="l02632"></a>02632     <span class="keywordflow">if</span> ( size )
<a name="l02633"></a>02633     {
<a name="l02634"></a>02634       <a class="code" href="struct_t_t___face_rec__.html">CFF_Face</a>      cff_face = (<a class="code" href="cffobjs_8h.html#aa18411ddfe99fb47e21cf26dbf4bb0c7">CFF_Face</a>)size-&gt;<a class="code" href="struct_t_t___face_rec__.html#ab07a1f6ce2cffe73a5501fb33164ae74">root</a>.face;
<a name="l02635"></a>02635       <a class="code" href="struct_s_f_n_t___interface__.html">SFNT_Service</a>  sfnt     = (<a class="code" href="struct_s_f_n_t___interface__.html">SFNT_Service</a>)cff_face-&gt;<a class="code" href="struct_t_t___face_rec__.html#a4c198db893da1900ee0384969d10f9f6">sfnt</a>;
<a name="l02636"></a>02636       <a class="code" href="struct_f_t___stream_rec__.html">FT_Stream</a>     stream   = cff_face-&gt;<a class="code" href="struct_t_t___face_rec__.html#ab07a1f6ce2cffe73a5501fb33164ae74">root</a>.<a class="code" href="struct_f_t___face_rec__.html#a831d5da25cd0fe2a783d2a73f467de55">stream</a>;
<a name="l02637"></a>02637 
<a name="l02638"></a>02638 
<a name="l02639"></a>02639       <span class="keywordflow">if</span> ( size-&gt;strike_index != 0xFFFFFFFFUL      &amp;&amp;
<a name="l02640"></a>02640            sfnt-&gt;load_eblc                         &amp;&amp;
<a name="l02641"></a>02641            ( load_flags &amp; <a class="code" href="freetype_8h.html#a0b68fe1c2c21b9ca3be6853ad44460df">FT_LOAD_NO_BITMAP</a> ) == 0 )
<a name="l02642"></a>02642       {
<a name="l02643"></a>02643         <a class="code" href="struct_t_t___s_bit___metrics_rec__.html">TT_SBit_MetricsRec</a>  <a class="code" href="fterrdef_8h.html#a5b089f80b4f1f749dfb33220373bde32">metrics</a>;
<a name="l02644"></a>02644 
<a name="l02645"></a>02645 
<a name="l02646"></a>02646         error = sfnt-&gt;load_sbit_image( face,
<a name="l02647"></a>02647                                        size-&gt;strike_index,
<a name="l02648"></a>02648                                        glyph_index,
<a name="l02649"></a>02649                                        (<a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>)load_flags,
<a name="l02650"></a>02650                                        stream,
<a name="l02651"></a>02651                                        &amp;glyph-&gt;root.bitmap,
<a name="l02652"></a>02652                                        &amp;metrics );
<a name="l02653"></a>02653 
<a name="l02654"></a>02654         <span class="keywordflow">if</span> ( !error )
<a name="l02655"></a>02655         {
<a name="l02656"></a>02656           glyph-&gt;root.outline.n_points   = 0;
<a name="l02657"></a>02657           glyph-&gt;root.outline.n_contours = 0;
<a name="l02658"></a>02658 
<a name="l02659"></a>02659           glyph-&gt;root.metrics.width  = (<a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>)metrics.<a class="code" href="struct_t_t___s_bit___metrics_rec__.html#a3444618e2c2a612a662a5e0d2c3f25ef">width</a>  &lt;&lt; 6;
<a name="l02660"></a>02660           glyph-&gt;root.metrics.height = (<a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>)metrics.<a class="code" href="struct_t_t___s_bit___metrics_rec__.html#a79b25794122888101aae80c7b74fc1fc">height</a> &lt;&lt; 6;
<a name="l02661"></a>02661 
<a name="l02662"></a>02662           glyph-&gt;root.metrics.horiBearingX = (<a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>)metrics.<a class="code" href="struct_t_t___s_bit___metrics_rec__.html#a786ba1081993e18d514ddf37c2662c7b">horiBearingX</a> &lt;&lt; 6;
<a name="l02663"></a>02663           glyph-&gt;root.metrics.horiBearingY = (<a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>)metrics.<a class="code" href="struct_t_t___s_bit___metrics_rec__.html#aaed1567b444a1bee4b3478b2cdb9259f">horiBearingY</a> &lt;&lt; 6;
<a name="l02664"></a>02664           glyph-&gt;root.metrics.horiAdvance  = (<a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>)metrics.<a class="code" href="struct_t_t___s_bit___metrics_rec__.html#a8b0c5271aaf220f7a8cbf4838854e220">horiAdvance</a>  &lt;&lt; 6;
<a name="l02665"></a>02665 
<a name="l02666"></a>02666           glyph-&gt;root.metrics.vertBearingX = (<a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>)metrics.<a class="code" href="struct_t_t___s_bit___metrics_rec__.html#a626e67e02494faab653a7543bb0b7c79">vertBearingX</a> &lt;&lt; 6;
<a name="l02667"></a>02667           glyph-&gt;root.metrics.vertBearingY = (<a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>)metrics.<a class="code" href="struct_t_t___s_bit___metrics_rec__.html#aef4755ed22ba72e5fa304920bae03146">vertBearingY</a> &lt;&lt; 6;
<a name="l02668"></a>02668           glyph-&gt;root.metrics.vertAdvance  = (<a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>)metrics.<a class="code" href="struct_t_t___s_bit___metrics_rec__.html#a947468e42759089d0b5c5fa10a0defdf">vertAdvance</a>  &lt;&lt; 6;
<a name="l02669"></a>02669 
<a name="l02670"></a>02670           glyph-&gt;root.format = FT_GLYPH_FORMAT_BITMAP;
<a name="l02671"></a>02671 
<a name="l02672"></a>02672           <span class="keywordflow">if</span> ( load_flags &amp; <a class="code" href="freetype_8h.html#a01ce88a8e449ed2ef6ecf6f83c59b5c1">FT_LOAD_VERTICAL_LAYOUT</a> )
<a name="l02673"></a>02673           {
<a name="l02674"></a>02674             glyph-&gt;root.bitmap_left = metrics.<a class="code" href="struct_t_t___s_bit___metrics_rec__.html#a626e67e02494faab653a7543bb0b7c79">vertBearingX</a>;
<a name="l02675"></a>02675             glyph-&gt;root.bitmap_top  = metrics.<a class="code" href="struct_t_t___s_bit___metrics_rec__.html#aef4755ed22ba72e5fa304920bae03146">vertBearingY</a>;
<a name="l02676"></a>02676           }
<a name="l02677"></a>02677           <span class="keywordflow">else</span>
<a name="l02678"></a>02678           {
<a name="l02679"></a>02679             glyph-&gt;root.bitmap_left = metrics.<a class="code" href="struct_t_t___s_bit___metrics_rec__.html#a786ba1081993e18d514ddf37c2662c7b">horiBearingX</a>;
<a name="l02680"></a>02680             glyph-&gt;root.bitmap_top  = metrics.<a class="code" href="struct_t_t___s_bit___metrics_rec__.html#aaed1567b444a1bee4b3478b2cdb9259f">horiBearingY</a>;
<a name="l02681"></a>02681           }
<a name="l02682"></a>02682           <span class="keywordflow">return</span> error;
<a name="l02683"></a>02683         }
<a name="l02684"></a>02684       }
<a name="l02685"></a>02685     }
<a name="l02686"></a>02686 
<a name="l02687"></a>02687 <span class="preprocessor">#endif </span><span class="comment">/* TT_CONFIG_OPTION_EMBEDDED_BITMAPS */</span>
<a name="l02688"></a>02688 
<a name="l02689"></a>02689     <span class="comment">/* return immediately if we only want the embedded bitmaps */</span>
<a name="l02690"></a>02690     <span class="keywordflow">if</span> ( load_flags &amp; <a class="code" href="freetype_8h.html#a08089e78fe58c63141461da290f369aa">FT_LOAD_SBITS_ONLY</a> )
<a name="l02691"></a>02691       <span class="keywordflow">return</span> CFF_Err_Invalid_Argument;
<a name="l02692"></a>02692 
<a name="l02693"></a>02693     <span class="comment">/* if we have a CID subfont, use its matrix (which has already */</span>
<a name="l02694"></a>02694     <span class="comment">/* been multiplied with the root matrix)                       */</span>
<a name="l02695"></a>02695 
<a name="l02696"></a>02696     <span class="comment">/* this scaling is only relevant if the PS hinter isn&#39;t active */</span>
<a name="l02697"></a>02697     <span class="keywordflow">if</span> ( cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a325d7331c2f2608ffc47860c2414424a">num_subfonts</a> )
<a name="l02698"></a>02698     {
<a name="l02699"></a>02699       <a class="code" href="fttypes_8h.html#a4fac88bdba78eb76b505efa6e4fbf3f5">FT_ULong</a>  top_upm, sub_upm;
<a name="l02700"></a>02700       <a class="code" href="fttypes_8h.html#a51f26183ca0c9f4af958939648caeccd">FT_Byte</a>   fd_index = <a class="code" href="cffload_8c.html#a72d672c11e4ec62796e13b931c6dc061">cff_fd_select_get</a>( &amp;cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a91a0f13516ff978c498355205c639342">fd_select</a>,
<a name="l02701"></a>02701                                               glyph_index );
<a name="l02702"></a>02702 
<a name="l02703"></a>02703       <span class="keywordflow">if</span> ( fd_index &gt;= cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a325d7331c2f2608ffc47860c2414424a">num_subfonts</a> ) 
<a name="l02704"></a>02704         fd_index = cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a325d7331c2f2608ffc47860c2414424a">num_subfonts</a> - 1;
<a name="l02705"></a>02705 
<a name="l02706"></a>02706       top_upm = cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a62120839c2d743718806b72799e3af67">top_font</a>.<a class="code" href="struct_c_f_f___sub_font_rec__.html#af23b698ce981c661db031c834475ddb2">font_dict</a>.<a class="code" href="struct_c_f_f___font_rec_dict_rec__.html#ac844c7ec0e7c1ea3466c1240aa2ed29c">units_per_em</a>;
<a name="l02707"></a>02707       sub_upm = cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a3e915487d0ab4eeeed395e8f1da25935">subfonts</a>[fd_index]-&gt;<a class="code" href="struct_c_f_f___sub_font_rec__.html#af23b698ce981c661db031c834475ddb2">font_dict</a>.<a class="code" href="struct_c_f_f___font_rec_dict_rec__.html#ac844c7ec0e7c1ea3466c1240aa2ed29c">units_per_em</a>;
<a name="l02708"></a>02708 
<a name="l02709"></a>02709 
<a name="l02710"></a>02710       font_matrix = cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a3e915487d0ab4eeeed395e8f1da25935">subfonts</a>[fd_index]-&gt;<a class="code" href="struct_c_f_f___sub_font_rec__.html#af23b698ce981c661db031c834475ddb2">font_dict</a>.<a class="code" href="struct_c_f_f___font_rec_dict_rec__.html#ae8f89feee4ec468c78e2610735e9d6f6">font_matrix</a>;
<a name="l02711"></a>02711       font_offset = cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a3e915487d0ab4eeeed395e8f1da25935">subfonts</a>[fd_index]-&gt;<a class="code" href="struct_c_f_f___sub_font_rec__.html#af23b698ce981c661db031c834475ddb2">font_dict</a>.<a class="code" href="struct_c_f_f___font_rec_dict_rec__.html#a8ad4e8ec0f39a5c9f0d7855929f0be0b">font_offset</a>;
<a name="l02712"></a>02712 
<a name="l02713"></a>02713       <span class="keywordflow">if</span> ( top_upm != sub_upm )
<a name="l02714"></a>02714       {
<a name="l02715"></a>02715         glyph-&gt;x_scale = <a class="code" href="freetype_8h.html#ae31c0f444ce1bba445af776b86beaa60">FT_MulDiv</a>( glyph-&gt;x_scale, top_upm, sub_upm );
<a name="l02716"></a>02716         glyph-&gt;y_scale = <a class="code" href="freetype_8h.html#ae31c0f444ce1bba445af776b86beaa60">FT_MulDiv</a>( glyph-&gt;y_scale, top_upm, sub_upm );
<a name="l02717"></a>02717 
<a name="l02718"></a>02718         force_scaling = <a class="code" href="ftobjs_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l02719"></a>02719       }
<a name="l02720"></a>02720     }
<a name="l02721"></a>02721     <span class="keywordflow">else</span>
<a name="l02722"></a>02722     {
<a name="l02723"></a>02723       font_matrix = cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a62120839c2d743718806b72799e3af67">top_font</a>.<a class="code" href="struct_c_f_f___sub_font_rec__.html#af23b698ce981c661db031c834475ddb2">font_dict</a>.<a class="code" href="struct_c_f_f___font_rec_dict_rec__.html#ae8f89feee4ec468c78e2610735e9d6f6">font_matrix</a>;
<a name="l02724"></a>02724       font_offset = cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a62120839c2d743718806b72799e3af67">top_font</a>.<a class="code" href="struct_c_f_f___sub_font_rec__.html#af23b698ce981c661db031c834475ddb2">font_dict</a>.<a class="code" href="struct_c_f_f___font_rec_dict_rec__.html#a8ad4e8ec0f39a5c9f0d7855929f0be0b">font_offset</a>;
<a name="l02725"></a>02725     }
<a name="l02726"></a>02726 
<a name="l02727"></a>02727     glyph-&gt;root.outline.n_points   = 0;
<a name="l02728"></a>02728     glyph-&gt;root.outline.n_contours = 0;
<a name="l02729"></a>02729 
<a name="l02730"></a>02730     hinting = <a class="code" href="fttypes_8h.html#adf712510036d534403cbddf4f18c2083">FT_BOOL</a>( ( load_flags &amp; <a class="code" href="freetype_8h.html#a1ae5e2e14c90bb98bde52e5412a8f23f">FT_LOAD_NO_SCALE</a>   ) == 0 &amp;&amp;
<a name="l02731"></a>02731                        ( load_flags &amp; <a class="code" href="freetype_8h.html#a4d3657db8d87688e93601201d0524e38">FT_LOAD_NO_HINTING</a> ) == 0 );
<a name="l02732"></a>02732 
<a name="l02733"></a>02733     glyph-&gt;root.format = <a class="code" href="ftrend1_8c.html#acd452025c8ee5551f3623ffb06c208e7">FT_GLYPH_FORMAT_OUTLINE</a>;  <span class="comment">/* by default */</span>
<a name="l02734"></a>02734 
<a name="l02735"></a>02735     {
<a name="l02736"></a>02736       <a class="code" href="fttypes_8h.html#a51f26183ca0c9f4af958939648caeccd">FT_Byte</a>*  charstring;
<a name="l02737"></a>02737       <a class="code" href="fttypes_8h.html#a4fac88bdba78eb76b505efa6e4fbf3f5">FT_ULong</a>  charstring_len;
<a name="l02738"></a>02738 
<a name="l02739"></a>02739 
<a name="l02740"></a>02740       <a class="code" href="cffgload_8c.html#a8bbc0e91ca59bd98aa5f749ac2dc1f9e">cff_decoder_init</a>( &amp;decoder, face, size, glyph, hinting,
<a name="l02741"></a>02741                         <a class="code" href="freetype_8h.html#a05f580caefdad5475992b61231f3b357">FT_LOAD_TARGET_MODE</a>( load_flags ) );
<a name="l02742"></a>02742 
<a name="l02743"></a>02743       <span class="keywordflow">if</span> ( load_flags &amp; <a class="code" href="freetype_8h.html#a2b2c58cdeb87bc06ccb16e52ecd4bcba">FT_LOAD_ADVANCE_ONLY</a> )
<a name="l02744"></a>02744         decoder.<a class="code" href="struct_c_f_f___decoder__.html#a0e2c2a7bb6a7c56e6e883058e7f03119">width_only</a> = <a class="code" href="ftobjs_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l02745"></a>02745 
<a name="l02746"></a>02746       decoder.<a class="code" href="struct_c_f_f___decoder__.html#a1974266e7e164100b88c75fc05a15303">builder</a>.<a class="code" href="struct_c_f_f___builder__.html#af2637a092e49c57e69a414a79f777743">no_recurse</a> =
<a name="l02747"></a>02747         (<a class="code" href="fttypes_8h.html#a1a832a256bb5a7e6e884afaa1a07f3ae">FT_Bool</a>)( load_flags &amp; FT_LOAD_NO_RECURSE );
<a name="l02748"></a>02748 
<a name="l02749"></a>02749       <span class="comment">/* now load the unscaled outline */</span>
<a name="l02750"></a>02750       error = cff_get_glyph_data( face, glyph_index,
<a name="l02751"></a>02751                                   &amp;charstring, &amp;charstring_len );
<a name="l02752"></a>02752       <span class="keywordflow">if</span> ( error )
<a name="l02753"></a>02753         <span class="keywordflow">goto</span> Glyph_Build_Finished;
<a name="l02754"></a>02754 
<a name="l02755"></a>02755       error = <a class="code" href="cffgload_8c.html#a560ec3f07b5b59462a7d3199cd1df656">cff_decoder_prepare</a>( &amp;decoder, size, glyph_index );
<a name="l02756"></a>02756       <span class="keywordflow">if</span> ( error )
<a name="l02757"></a>02757         <span class="keywordflow">goto</span> Glyph_Build_Finished;
<a name="l02758"></a>02758 
<a name="l02759"></a>02759       error = <a class="code" href="cffgload_8c.html#a04ab294b7e8ed9309f8ac19a1485148b">cff_decoder_parse_charstrings</a>( &amp;decoder,
<a name="l02760"></a>02760                                              charstring,
<a name="l02761"></a>02761                                              charstring_len );
<a name="l02762"></a>02762 
<a name="l02763"></a>02763       cff_free_glyph_data( face, &amp;charstring, charstring_len );
<a name="l02764"></a>02764 
<a name="l02765"></a>02765       <span class="keywordflow">if</span> ( error )
<a name="l02766"></a>02766         <span class="keywordflow">goto</span> Glyph_Build_Finished;
<a name="l02767"></a>02767 
<a name="l02768"></a>02768 <span class="preprocessor">#ifdef FT_CONFIG_OPTION_INCREMENTAL</span>
<a name="l02769"></a>02769 <span class="preprocessor"></span>      <span class="comment">/* Control data and length may not be available for incremental */</span>
<a name="l02770"></a>02770       <span class="comment">/* fonts.                                                       */</span>
<a name="l02771"></a>02771       <span class="keywordflow">if</span> ( face-&gt;<a class="code" href="struct_t_t___face_rec__.html#ab07a1f6ce2cffe73a5501fb33164ae74">root</a>.<a class="code" href="struct_f_t___face_rec__.html#aed9a1267cddcbe790f0591471c886537">internal</a>-&gt;incremental_interface )
<a name="l02772"></a>02772       {
<a name="l02773"></a>02773         glyph-&gt;root.control_data = 0;
<a name="l02774"></a>02774         glyph-&gt;root.control_len = 0;
<a name="l02775"></a>02775       }
<a name="l02776"></a>02776       <span class="keywordflow">else</span>
<a name="l02777"></a>02777 <span class="preprocessor">#endif </span><span class="comment">/* FT_CONFIG_OPTION_INCREMENTAL */</span>
<a name="l02778"></a>02778 
<a name="l02779"></a>02779       <span class="comment">/* We set control_data and control_len if charstrings is loaded. */</span>
<a name="l02780"></a>02780       <span class="comment">/* See how charstring loads at cff_index_access_element() in     */</span>
<a name="l02781"></a>02781       <span class="comment">/* cffload.c.                                                    */</span>
<a name="l02782"></a>02782       {
<a name="l02783"></a>02783         <a class="code" href="cfftypes_8h.html#a94c5dac593686a5ea93112cdf5134b83">CFF_Index</a>  csindex = &amp;cff-&gt;<a class="code" href="struct_c_f_f___font_rec__.html#a63da0015d70ca3a797ec7b551fd5476f">charstrings_index</a>;
<a name="l02784"></a>02784 
<a name="l02785"></a>02785 
<a name="l02786"></a>02786         <span class="keywordflow">if</span> ( csindex-&gt;offsets )
<a name="l02787"></a>02787         {
<a name="l02788"></a>02788           glyph-&gt;root.control_data = csindex-&gt;bytes +
<a name="l02789"></a>02789                                      csindex-&gt;offsets[glyph_index] - 1;
<a name="l02790"></a>02790           glyph-&gt;root.control_len  = charstring_len;
<a name="l02791"></a>02791         }
<a name="l02792"></a>02792       }
<a name="l02793"></a>02793 
<a name="l02794"></a>02794   Glyph_Build_Finished:
<a name="l02795"></a>02795       <span class="comment">/* save new glyph tables, if no error */</span>
<a name="l02796"></a>02796       <span class="keywordflow">if</span> ( !error )
<a name="l02797"></a>02797         cff_builder_done( &amp;decoder.<a class="code" href="struct_c_f_f___decoder__.html#a1974266e7e164100b88c75fc05a15303">builder</a> );
<a name="l02798"></a>02798       <span class="comment">/* XXX: anything to do for broken glyph entry? */</span>
<a name="l02799"></a>02799     }
<a name="l02800"></a>02800 
<a name="l02801"></a>02801 <span class="preprocessor">#ifdef FT_CONFIG_OPTION_INCREMENTAL</span>
<a name="l02802"></a>02802 <span class="preprocessor"></span>
<a name="l02803"></a>02803     <span class="comment">/* Incremental fonts can optionally override the metrics. */</span>
<a name="l02804"></a>02804     <span class="keywordflow">if</span> ( !error                                                               &amp;&amp;
<a name="l02805"></a>02805          face-&gt;<a class="code" href="struct_t_t___face_rec__.html#ab07a1f6ce2cffe73a5501fb33164ae74">root</a>.<a class="code" href="struct_f_t___face_rec__.html#aed9a1267cddcbe790f0591471c886537">internal</a>-&gt;incremental_interface                           &amp;&amp;
<a name="l02806"></a>02806          face-&gt;<a class="code" href="struct_t_t___face_rec__.html#ab07a1f6ce2cffe73a5501fb33164ae74">root</a>.<a class="code" href="struct_f_t___face_rec__.html#aed9a1267cddcbe790f0591471c886537">internal</a>-&gt;incremental_interface-&gt;funcs-&gt;get_glyph_metrics )
<a name="l02807"></a>02807     {
<a name="l02808"></a>02808       <a class="code" href="struct_f_t___incremental___metrics_rec__.html">FT_Incremental_MetricsRec</a>  <a class="code" href="fterrdef_8h.html#a5b089f80b4f1f749dfb33220373bde32">metrics</a>;
<a name="l02809"></a>02809 
<a name="l02810"></a>02810 
<a name="l02811"></a>02811       metrics.<a class="code" href="struct_f_t___incremental___metrics_rec__.html#af065d998d0a0f2a57513125038d802a6">bearing_x</a> = decoder.<a class="code" href="struct_c_f_f___decoder__.html#a1974266e7e164100b88c75fc05a15303">builder</a>.<a class="code" href="struct_c_f_f___builder__.html#a1bee78d88325239036b57761fdd0423c">left_bearing</a>.<a class="code" href="struct_f_t___vector__.html#a941e818e6dfca06409cddff4f325f74c">x</a>;
<a name="l02812"></a>02812       metrics.<a class="code" href="struct_f_t___incremental___metrics_rec__.html#af1443aa7c1ca54d3c2a29f1cf6d7848b">bearing_y</a> = 0;
<a name="l02813"></a>02813       metrics.<a class="code" href="struct_f_t___incremental___metrics_rec__.html#a996c99aa0e6b36c2c7776fc1a2b6b614">advance</a>   = decoder.<a class="code" href="struct_c_f_f___decoder__.html#a1974266e7e164100b88c75fc05a15303">builder</a>.<a class="code" href="struct_c_f_f___builder__.html#a943906425298bbbdc85e7a6d626224b5">advance</a>.<a class="code" href="struct_f_t___vector__.html#a941e818e6dfca06409cddff4f325f74c">x</a>;
<a name="l02814"></a>02814       metrics.<a class="code" href="struct_f_t___incremental___metrics_rec__.html#a0ee280662a03ea935dbfe377e56f4d6d">advance_v</a> = decoder.<a class="code" href="struct_c_f_f___decoder__.html#a1974266e7e164100b88c75fc05a15303">builder</a>.<a class="code" href="struct_c_f_f___builder__.html#a943906425298bbbdc85e7a6d626224b5">advance</a>.<a class="code" href="struct_f_t___vector__.html#ac3246ed214e880047ec74eeb15f8b973">y</a>;
<a name="l02815"></a>02815 
<a name="l02816"></a>02816       error = face-&gt;<a class="code" href="struct_t_t___face_rec__.html#ab07a1f6ce2cffe73a5501fb33164ae74">root</a>.<a class="code" href="struct_f_t___face_rec__.html#aed9a1267cddcbe790f0591471c886537">internal</a>-&gt;incremental_interface-&gt;funcs-&gt;get_glyph_metrics(
<a name="l02817"></a>02817                 face-&gt;<a class="code" href="struct_t_t___face_rec__.html#ab07a1f6ce2cffe73a5501fb33164ae74">root</a>.<a class="code" href="struct_f_t___face_rec__.html#aed9a1267cddcbe790f0591471c886537">internal</a>-&gt;incremental_interface-&gt;object,
<a name="l02818"></a>02818                 glyph_index, <a class="code" href="ftobjs_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, &amp;metrics );
<a name="l02819"></a>02819 
<a name="l02820"></a>02820       decoder.<a class="code" href="struct_c_f_f___decoder__.html#a1974266e7e164100b88c75fc05a15303">builder</a>.<a class="code" href="struct_c_f_f___builder__.html#a1bee78d88325239036b57761fdd0423c">left_bearing</a>.<a class="code" href="struct_f_t___vector__.html#a941e818e6dfca06409cddff4f325f74c">x</a> = metrics.<a class="code" href="struct_f_t___incremental___metrics_rec__.html#af065d998d0a0f2a57513125038d802a6">bearing_x</a>;
<a name="l02821"></a>02821       decoder.<a class="code" href="struct_c_f_f___decoder__.html#a1974266e7e164100b88c75fc05a15303">builder</a>.<a class="code" href="struct_c_f_f___builder__.html#a943906425298bbbdc85e7a6d626224b5">advance</a>.<a class="code" href="struct_f_t___vector__.html#a941e818e6dfca06409cddff4f325f74c">x</a>      = metrics.<a class="code" href="struct_f_t___incremental___metrics_rec__.html#a996c99aa0e6b36c2c7776fc1a2b6b614">advance</a>;
<a name="l02822"></a>02822       decoder.<a class="code" href="struct_c_f_f___decoder__.html#a1974266e7e164100b88c75fc05a15303">builder</a>.<a class="code" href="struct_c_f_f___builder__.html#a943906425298bbbdc85e7a6d626224b5">advance</a>.<a class="code" href="struct_f_t___vector__.html#ac3246ed214e880047ec74eeb15f8b973">y</a>      = metrics.<a class="code" href="struct_f_t___incremental___metrics_rec__.html#a0ee280662a03ea935dbfe377e56f4d6d">advance_v</a>;
<a name="l02823"></a>02823     }
<a name="l02824"></a>02824 
<a name="l02825"></a>02825 <span class="preprocessor">#endif </span><span class="comment">/* FT_CONFIG_OPTION_INCREMENTAL */</span>
<a name="l02826"></a>02826 
<a name="l02827"></a>02827     <span class="keywordflow">if</span> ( !error )
<a name="l02828"></a>02828     {
<a name="l02829"></a>02829       <span class="comment">/* Now, set the metrics -- this is rather simple, as   */</span>
<a name="l02830"></a>02830       <span class="comment">/* the left side bearing is the xMin, and the top side */</span>
<a name="l02831"></a>02831       <span class="comment">/* bearing the yMax.                                   */</span>
<a name="l02832"></a>02832 
<a name="l02833"></a>02833       <span class="comment">/* For composite glyphs, return only left side bearing and */</span>
<a name="l02834"></a>02834       <span class="comment">/* advance width.                                          */</span>
<a name="l02835"></a>02835       <span class="keywordflow">if</span> ( load_flags &amp; FT_LOAD_NO_RECURSE )
<a name="l02836"></a>02836       {
<a name="l02837"></a>02837         <a class="code" href="struct_f_t___slot___internal_rec__.html">FT_Slot_Internal</a>  <span class="keyword">internal</span> = glyph-&gt;root.internal;
<a name="l02838"></a>02838 
<a name="l02839"></a>02839 
<a name="l02840"></a>02840         glyph-&gt;root.metrics.horiBearingX = decoder.<a class="code" href="struct_c_f_f___decoder__.html#a1974266e7e164100b88c75fc05a15303">builder</a>.<a class="code" href="struct_c_f_f___builder__.html#a1bee78d88325239036b57761fdd0423c">left_bearing</a>.<a class="code" href="struct_f_t___vector__.html#a941e818e6dfca06409cddff4f325f74c">x</a>;
<a name="l02841"></a>02841         glyph-&gt;root.metrics.horiAdvance  = decoder.<a class="code" href="struct_c_f_f___decoder__.html#a0d3d6ccc7097a1e256543f511d47c7e9">glyph_width</a>;
<a name="l02842"></a>02842         <span class="keyword">internal</span>-&gt;glyph_matrix           = font_matrix;
<a name="l02843"></a>02843         <span class="keyword">internal</span>-&gt;glyph_delta            = font_offset;
<a name="l02844"></a>02844         <span class="keyword">internal</span>-&gt;glyph_transformed      = 1;
<a name="l02845"></a>02845       }
<a name="l02846"></a>02846       <span class="keywordflow">else</span>
<a name="l02847"></a>02847       {
<a name="l02848"></a>02848         <a class="code" href="struct_f_t___b_box__.html">FT_BBox</a>            cbox;
<a name="l02849"></a>02849         <a class="code" href="freetype_8h.html#aba844698c24c1c12727c60a6fc0a9b3d">FT_Glyph_Metrics</a>*  <a class="code" href="fterrdef_8h.html#a5b089f80b4f1f749dfb33220373bde32">metrics</a> = &amp;glyph-&gt;root.metrics;
<a name="l02850"></a>02850         <a class="code" href="struct_f_t___vector__.html">FT_Vector</a>          advance;
<a name="l02851"></a>02851         <a class="code" href="fttypes_8h.html#a1a832a256bb5a7e6e884afaa1a07f3ae">FT_Bool</a>            has_vertical_info;
<a name="l02852"></a>02852 
<a name="l02853"></a>02853 
<a name="l02854"></a>02854         <span class="comment">/* copy the _unscaled_ advance width */</span>
<a name="l02855"></a>02855         metrics-&gt;horiAdvance                    = decoder.<a class="code" href="struct_c_f_f___decoder__.html#a0d3d6ccc7097a1e256543f511d47c7e9">glyph_width</a>;
<a name="l02856"></a>02856         glyph-&gt;root.linearHoriAdvance           = decoder.<a class="code" href="struct_c_f_f___decoder__.html#a0d3d6ccc7097a1e256543f511d47c7e9">glyph_width</a>;
<a name="l02857"></a>02857         glyph-&gt;root.internal-&gt;glyph_transformed = 0;
<a name="l02858"></a>02858 
<a name="l02859"></a>02859 <span class="preprocessor">#ifdef FT_CONFIG_OPTION_OLD_INTERNALS</span>
<a name="l02860"></a>02860 <span class="preprocessor"></span>        has_vertical_info = <a class="code" href="fttypes_8h.html#adf712510036d534403cbddf4f18c2083">FT_BOOL</a>( face-&gt;<a class="code" href="struct_t_t___face_rec__.html#a43e1c7d3fd3f43ddd7b1bba243bf10bc">vertical_info</a>                   &amp;&amp;
<a name="l02861"></a>02861                                      face-&gt;<a class="code" href="struct_t_t___face_rec__.html#a04fc41d3860163177a7e0a9bcf71ccf4">vertical</a>.<a class="code" href="struct_t_t___vert_header__.html#a4ca6fe9cdd12fbc9a1129c4fbf6bddd1">number_Of_VMetrics</a> &gt; 0 &amp;&amp;
<a name="l02862"></a>02862                                      face-&gt;<a class="code" href="struct_t_t___face_rec__.html#a04fc41d3860163177a7e0a9bcf71ccf4">vertical</a>.<a class="code" href="struct_t_t___vert_header__.html#ac789245d0d6243bc965ad43702bdc671">long_metrics</a>           );
<a name="l02863"></a>02863 <span class="preprocessor">#else</span>
<a name="l02864"></a>02864 <span class="preprocessor"></span>        has_vertical_info = <a class="code" href="fttypes_8h.html#adf712510036d534403cbddf4f18c2083">FT_BOOL</a>( face-&gt;<a class="code" href="struct_t_t___face_rec__.html#a43e1c7d3fd3f43ddd7b1bba243bf10bc">vertical_info</a>                   &amp;&amp;
<a name="l02865"></a>02865                                      face-&gt;<a class="code" href="struct_t_t___face_rec__.html#a04fc41d3860163177a7e0a9bcf71ccf4">vertical</a>.<a class="code" href="struct_t_t___vert_header__.html#a4ca6fe9cdd12fbc9a1129c4fbf6bddd1">number_Of_VMetrics</a> &gt; 0 );
<a name="l02866"></a>02866 <span class="preprocessor">#endif</span>
<a name="l02867"></a>02867 <span class="preprocessor"></span>
<a name="l02868"></a>02868         <span class="comment">/* get the vertical metrics from the vtmx table if we have one */</span>
<a name="l02869"></a>02869         <span class="keywordflow">if</span> ( has_vertical_info )
<a name="l02870"></a>02870         {
<a name="l02871"></a>02871           <a class="code" href="fttypes_8h.html#aa7279be89046a2563cd3d4d6651fbdcf">FT_Short</a>   vertBearingY = 0;
<a name="l02872"></a>02872           <a class="code" href="fttypes_8h.html#a937f6c17cf5ffd09086d8610c37b9f58">FT_UShort</a>  vertAdvance  = 0;
<a name="l02873"></a>02873 
<a name="l02874"></a>02874 
<a name="l02875"></a>02875           ( (<a class="code" href="sfnt_8h.html#a3fc0c419268a93de27f855f267c2fc38">SFNT_Service</a>)face-&gt;<a class="code" href="struct_t_t___face_rec__.html#a4c198db893da1900ee0384969d10f9f6">sfnt</a> )-&gt;get_metrics( face, 1,
<a name="l02876"></a>02876                                                      glyph_index,
<a name="l02877"></a>02877                                                      &amp;vertBearingY,
<a name="l02878"></a>02878                                                      &amp;vertAdvance );
<a name="l02879"></a>02879           metrics-&gt;vertBearingY = vertBearingY;
<a name="l02880"></a>02880           metrics-&gt;vertAdvance  = vertAdvance;
<a name="l02881"></a>02881         }
<a name="l02882"></a>02882         <span class="keywordflow">else</span>
<a name="l02883"></a>02883         {
<a name="l02884"></a>02884           <span class="comment">/* make up vertical ones */</span>
<a name="l02885"></a>02885           <span class="keywordflow">if</span> ( face-&gt;<a class="code" href="struct_t_t___face_rec__.html#a5371adcbd62ade9b74e5f24a03ef09f2">os2</a>.<a class="code" href="struct_t_t___o_s2__.html#a012ff79224cd25ae51837ca8937605c4">version</a> != 0xFFFFU )
<a name="l02886"></a>02886             metrics-&gt;vertAdvance = (<a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>)( face-&gt;<a class="code" href="struct_t_t___face_rec__.html#a5371adcbd62ade9b74e5f24a03ef09f2">os2</a>.<a class="code" href="struct_t_t___o_s2__.html#a81af7a8b51ee2cf89973355831d8041d">sTypoAscender</a> -
<a name="l02887"></a>02887                                              face-&gt;<a class="code" href="struct_t_t___face_rec__.html#a5371adcbd62ade9b74e5f24a03ef09f2">os2</a>.<a class="code" href="struct_t_t___o_s2__.html#a0028fad42d58d8bdfcd0d39506ade8c7">sTypoDescender</a> );
<a name="l02888"></a>02888           <span class="keywordflow">else</span>
<a name="l02889"></a>02889             metrics-&gt;vertAdvance = (<a class="code" href="ftimage_8h.html#af5f230f4b253d4c7715fd2e595614c90">FT_Pos</a>)( face-&gt;<a class="code" href="struct_t_t___face_rec__.html#a784d2ca39e9717da0661f5fd59dffc58">horizontal</a>.<a class="code" href="struct_t_t___hori_header__.html#a6f987c89428c93854dab06e506134249">Ascender</a> -
<a name="l02890"></a>02890                                              face-&gt;<a class="code" href="struct_t_t___face_rec__.html#a784d2ca39e9717da0661f5fd59dffc58">horizontal</a>.<a class="code" href="struct_t_t___hori_header__.html#ad5be55a98dfaa079a2aaa462034a1512">Descender</a> );
<a name="l02891"></a>02891         }
<a name="l02892"></a>02892 
<a name="l02893"></a>02893         glyph-&gt;root.linearVertAdvance = metrics-&gt;vertAdvance;
<a name="l02894"></a>02894 
<a name="l02895"></a>02895         glyph-&gt;root.format = <a class="code" href="ftrend1_8c.html#acd452025c8ee5551f3623ffb06c208e7">FT_GLYPH_FORMAT_OUTLINE</a>;
<a name="l02896"></a>02896 
<a name="l02897"></a>02897         glyph-&gt;root.outline.flags = 0;
<a name="l02898"></a>02898         <span class="keywordflow">if</span> ( size &amp;&amp; size-&gt;root.metrics.y_ppem &lt; 24 )
<a name="l02899"></a>02899           glyph-&gt;root.outline.flags |= <a class="code" href="ftimage_8h.html#aa52794bb013ef86fc3da0eb8502024b1">FT_OUTLINE_HIGH_PRECISION</a>;
<a name="l02900"></a>02900 
<a name="l02901"></a>02901         glyph-&gt;root.outline.flags |= <a class="code" href="ftimage_8h.html#ae6eb93e2e13c7e67da3b399f1dd57045">FT_OUTLINE_REVERSE_FILL</a>;
<a name="l02902"></a>02902 
<a name="l02903"></a>02903         <span class="keywordflow">if</span> ( !( font_matrix.<a class="code" href="struct_f_t___matrix__.html#a27d51c2958634abe7bf377610e095f74">xx</a> == 0x10000L &amp;&amp;
<a name="l02904"></a>02904                 font_matrix.<a class="code" href="struct_f_t___matrix__.html#a689a6fd20a88238788b90c3597ee0c2a">yy</a> == 0x10000L &amp;&amp;
<a name="l02905"></a>02905                 font_matrix.<a class="code" href="struct_f_t___matrix__.html#a7e9f439d37c00ba1a11919bcaa8937a2">xy</a> == 0        &amp;&amp;
<a name="l02906"></a>02906                 font_matrix.<a class="code" href="struct_f_t___matrix__.html#a55792583a843a1611b43c40534a02a17">yx</a> == 0        ) )
<a name="l02907"></a>02907           <a class="code" href="ftoutln_8h.html#ad68e1aa2ec264b97eb1b13f24049e132">FT_Outline_Transform</a>( &amp;glyph-&gt;root.outline, &amp;font_matrix );
<a name="l02908"></a>02908 
<a name="l02909"></a>02909         <span class="keywordflow">if</span> ( !( font_offset.<a class="code" href="struct_f_t___vector__.html#a941e818e6dfca06409cddff4f325f74c">x</a> == 0 &amp;&amp;
<a name="l02910"></a>02910                 font_offset.<a class="code" href="struct_f_t___vector__.html#ac3246ed214e880047ec74eeb15f8b973">y</a> == 0 ) )
<a name="l02911"></a>02911           <a class="code" href="ftoutln_8h.html#a4f1241539872e9237b7d5c6dcf9183e7">FT_Outline_Translate</a>( &amp;glyph-&gt;root.outline,
<a name="l02912"></a>02912                                 font_offset.<a class="code" href="struct_f_t___vector__.html#a941e818e6dfca06409cddff4f325f74c">x</a>, font_offset.<a class="code" href="struct_f_t___vector__.html#ac3246ed214e880047ec74eeb15f8b973">y</a> );
<a name="l02913"></a>02913 
<a name="l02914"></a>02914         advance.<a class="code" href="struct_f_t___vector__.html#a941e818e6dfca06409cddff4f325f74c">x</a> = metrics-&gt;horiAdvance;
<a name="l02915"></a>02915         advance.<a class="code" href="struct_f_t___vector__.html#ac3246ed214e880047ec74eeb15f8b973">y</a> = 0;
<a name="l02916"></a>02916         <a class="code" href="freetype_8h.html#a0cc0411657caad5063e918205d7194db">FT_Vector_Transform</a>( &amp;advance, &amp;font_matrix );
<a name="l02917"></a>02917         metrics-&gt;horiAdvance = advance.<a class="code" href="struct_f_t___vector__.html#a941e818e6dfca06409cddff4f325f74c">x</a> + font_offset.<a class="code" href="struct_f_t___vector__.html#a941e818e6dfca06409cddff4f325f74c">x</a>;
<a name="l02918"></a>02918 
<a name="l02919"></a>02919         advance.<a class="code" href="struct_f_t___vector__.html#a941e818e6dfca06409cddff4f325f74c">x</a> = 0;
<a name="l02920"></a>02920         advance.<a class="code" href="struct_f_t___vector__.html#ac3246ed214e880047ec74eeb15f8b973">y</a> = metrics-&gt;vertAdvance;
<a name="l02921"></a>02921         <a class="code" href="freetype_8h.html#a0cc0411657caad5063e918205d7194db">FT_Vector_Transform</a>( &amp;advance, &amp;font_matrix );
<a name="l02922"></a>02922         metrics-&gt;vertAdvance = advance.<a class="code" href="struct_f_t___vector__.html#ac3246ed214e880047ec74eeb15f8b973">y</a> + font_offset.<a class="code" href="struct_f_t___vector__.html#ac3246ed214e880047ec74eeb15f8b973">y</a>;
<a name="l02923"></a>02923 
<a name="l02924"></a>02924         <span class="keywordflow">if</span> ( ( load_flags &amp; FT_LOAD_NO_SCALE ) == 0 || force_scaling )
<a name="l02925"></a>02925         {
<a name="l02926"></a>02926           <span class="comment">/* scale the outline and the metrics */</span>
<a name="l02927"></a>02927           <a class="code" href="fttypes_8h.html#af90e5fb0d07e21be9fe6faa33f02484c">FT_Int</a>       <a class="code" href="jsonmain_8cpp.html#a4eacae1d9e7c39f8236bb36d4ececa77">n</a>;
<a name="l02928"></a>02928           <a class="code" href="struct_f_t___outline__.html">FT_Outline</a>*  cur     = &amp;glyph-&gt;root.outline;
<a name="l02929"></a>02929           <a class="code" href="struct_f_t___vector__.html">FT_Vector</a>*   vec     = cur-&gt;<a class="code" href="struct_f_t___outline__.html#a4871896a2f38bdab947e30a7cf6bca04">points</a>;
<a name="l02930"></a>02930           <a class="code" href="fttypes_8h.html#a5f5a679cc09f758efdd0d1c5feed3c3d">FT_Fixed</a>     x_scale = glyph-&gt;x_scale;
<a name="l02931"></a>02931           <a class="code" href="fttypes_8h.html#a5f5a679cc09f758efdd0d1c5feed3c3d">FT_Fixed</a>     y_scale = glyph-&gt;y_scale;
<a name="l02932"></a>02932 
<a name="l02933"></a>02933 
<a name="l02934"></a>02934           <span class="comment">/* First of all, scale the points */</span>
<a name="l02935"></a>02935           <span class="keywordflow">if</span> ( !hinting || !decoder.<a class="code" href="struct_c_f_f___decoder__.html#a1974266e7e164100b88c75fc05a15303">builder</a>.<a class="code" href="struct_c_f_f___builder__.html#a7eb0d9144e82e76d6fe4fbd03b678c69">hints_funcs</a> )
<a name="l02936"></a>02936             <span class="keywordflow">for</span> ( n = cur-&gt;<a class="code" href="struct_f_t___outline__.html#a7ebcf3c33231af88655534d1ac02b66e">n_points</a>; n &gt; 0; n--, vec++ )
<a name="l02937"></a>02937             {
<a name="l02938"></a>02938               vec-&gt;<a class="code" href="struct_f_t___vector__.html#a941e818e6dfca06409cddff4f325f74c">x</a> = <a class="code" href="freetype_8h.html#aeb37c2858e2851e15465580de1d1d218">FT_MulFix</a>( vec-&gt;<a class="code" href="struct_f_t___vector__.html#a941e818e6dfca06409cddff4f325f74c">x</a>, x_scale );
<a name="l02939"></a>02939               vec-&gt;<a class="code" href="struct_f_t___vector__.html#ac3246ed214e880047ec74eeb15f8b973">y</a> = <a class="code" href="freetype_8h.html#aeb37c2858e2851e15465580de1d1d218">FT_MulFix</a>( vec-&gt;<a class="code" href="struct_f_t___vector__.html#ac3246ed214e880047ec74eeb15f8b973">y</a>, y_scale );
<a name="l02940"></a>02940             }
<a name="l02941"></a>02941 
<a name="l02942"></a>02942           <span class="comment">/* Then scale the metrics */</span>
<a name="l02943"></a>02943           metrics-&gt;horiAdvance = <a class="code" href="freetype_8h.html#aeb37c2858e2851e15465580de1d1d218">FT_MulFix</a>( metrics-&gt;horiAdvance, x_scale );
<a name="l02944"></a>02944           metrics-&gt;vertAdvance = <a class="code" href="freetype_8h.html#aeb37c2858e2851e15465580de1d1d218">FT_MulFix</a>( metrics-&gt;vertAdvance, y_scale );
<a name="l02945"></a>02945         }
<a name="l02946"></a>02946 
<a name="l02947"></a>02947         <span class="comment">/* compute the other metrics */</span>
<a name="l02948"></a>02948         <a class="code" href="ftoutln_8h.html#aee6c38fab9f6f3ec522caaba9e608af7">FT_Outline_Get_CBox</a>( &amp;glyph-&gt;root.outline, &amp;cbox );
<a name="l02949"></a>02949 
<a name="l02950"></a>02950         metrics-&gt;width  = cbox.<a class="code" href="struct_f_t___b_box__.html#ac6da5c44f4cb7b97eef1f438eb69c0ec">xMax</a> - cbox.<a class="code" href="struct_f_t___b_box__.html#a1f2a5d0565d496c1d41e43d018f45add">xMin</a>;
<a name="l02951"></a>02951         metrics-&gt;height = cbox.<a class="code" href="struct_f_t___b_box__.html#a77084921589f386a8a593ae1f25b1569">yMax</a> - cbox.<a class="code" href="struct_f_t___b_box__.html#a959ca1d5bc1c5338da0d85c8e7135f4e">yMin</a>;
<a name="l02952"></a>02952 
<a name="l02953"></a>02953         metrics-&gt;horiBearingX = cbox.<a class="code" href="struct_f_t___b_box__.html#a1f2a5d0565d496c1d41e43d018f45add">xMin</a>;
<a name="l02954"></a>02954         metrics-&gt;horiBearingY = cbox.<a class="code" href="struct_f_t___b_box__.html#a77084921589f386a8a593ae1f25b1569">yMax</a>;
<a name="l02955"></a>02955 
<a name="l02956"></a>02956         <span class="keywordflow">if</span> ( has_vertical_info )
<a name="l02957"></a>02957           metrics-&gt;vertBearingX = metrics-&gt;horiBearingX -
<a name="l02958"></a>02958                                     metrics-&gt;horiAdvance / 2;
<a name="l02959"></a>02959         <span class="keywordflow">else</span> 
<a name="l02960"></a>02960         {
<a name="l02961"></a>02961           <span class="keywordflow">if</span> ( load_flags &amp; <a class="code" href="freetype_8h.html#a01ce88a8e449ed2ef6ecf6f83c59b5c1">FT_LOAD_VERTICAL_LAYOUT</a> )
<a name="l02962"></a>02962             <a class="code" href="ftobjs_8h.html#a2b68ffda2b76d009e20d9bcaaff0421d">ft_synthesize_vertical_metrics</a>( metrics,
<a name="l02963"></a>02963                                             metrics-&gt;vertAdvance );
<a name="l02964"></a>02964         }
<a name="l02965"></a>02965       }
<a name="l02966"></a>02966     }
<a name="l02967"></a>02967 
<a name="l02968"></a>02968     <span class="keywordflow">return</span> error;
<a name="l02969"></a>02969   }
<a name="l02970"></a>02970 
<a name="l02971"></a>02971 
<a name="l02972"></a>02972 <span class="comment">/* END */</span>
</pre></div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="cffgload_8c.html">cffgload.c</a>      </li>

    <li class="footer">Generated on Tue Mar 13 2012 11:44:03 for ARK2D by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.0 </li>
   </ul>
 </div>


</body>
</html>
